{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Test","title":"Test"},{"location":"#test","text":"","title":"Test"},{"location":"VERSIONING/","text":"Versioning Guide for GitHub Actions This document explains the versioning strategy used in this repository for publishing and maintaining GitHub Actions. Table of Contents Overview Semantic Versioning Tag Strategy Release Process Moving Major Version Tags Usage for Consumers Breaking Changes Examples Overview This repository contains reusable GitHub Actions (composite actions). Unlike traditional software packages, GitHub Actions use a tag-based versioning system where users reference specific versions directly in their workflows. Key Principles: - \u2705 Use semantic versioning (e.g., v1.0.0 , v1.1.0 , v2.0.0 ) - \u2705 Maintain moving major version tags (e.g., v1 , v2 ) for convenience - \u2705 Keep specific version tags immutable (e.g., v1.0.0 never changes) - \u2705 Use v prefix for all version tags Semantic Versioning We follow Semantic Versioning 2.0.0 with the format: vMAJOR.MINOR.PATCH Version Components v1.2.3 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500 PATCH: Bug fixes, documentation updates (backward compatible) \u2502 \u2514\u2500\u2500\u2500\u2500 MINOR: New features, improvements (backward compatible) \u2514\u2500\u2500\u2500\u2500\u2500\u2500 MAJOR: Breaking changes (NOT backward compatible) When to Increment Version Increment When Examples PATCH Bug fixes, docs, internal refactoring v1.0.0 \u2192 v1.0.1 MINOR New features, new inputs (optional), deprecations v1.0.1 \u2192 v1.1.0 MAJOR Breaking changes, removed features, required inputs changed v1.1.0 \u2192 v2.0.0 Examples of Changes PATCH Version (v1.0.0 \u2192 v1.0.1) \ud83d\udc1b Fix a bug in cache key generation \ud83d\udcdd Update documentation \ud83d\udd27 Internal code refactoring \u26a1 Performance improvements (no behavior change) MINOR Version (v1.0.1 \u2192 v1.1.0) \u2728 Add new optional input parameter \ud83c\udf89 Add new feature that doesn't affect existing usage \ud83d\udcca Add new logging/output \u26a0\ufe0f Deprecate a feature (but still works) MAJOR Version (v1.1.0 \u2192 v2.0.0) \ud83d\udca5 Remove or rename an input parameter \ud83d\udca5 Change default behavior significantly \ud83d\udca5 Remove deprecated features \ud83d\udca5 Change required inputs or validation rules \ud83d\udca5 Update to incompatible dependency versions Tag Strategy Two Types of Tags We maintain two types of Git tags: 1. Specific Version Tags (Immutable) Format: v1.0.0 , v1.1.0 , v1.2.0 , v2.0.0 Characteristics: - \u2705 Never moved or changed - \u2705 Point to a specific commit forever - \u2705 Used for reproducibility and security - \u2705 Ideal for production workflows Example: # Pin to exact version - never changes - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1.0.0 2. Major Version Tags (Moving) Format: v1 , v2 , v3 Characteristics: - \ud83d\udd04 Updated with each new release within the major version - \ud83d\udd04 Points to the latest compatible version - \ud83d\udd04 Used for automatic updates - \u26a0\ufe0f May change behavior (but stays backward compatible) Example: # Use major version - gets updates automatically - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 Visual Representation Timeline of commits and tags: A ---- B ---- C ---- D ---- E ---- F \u2191 \u2191 \u2191 \u2191 \u2502 \u2502 \u2502 \u2502 v1.0.0 v1.1.0 v1.2.0 v2.0.0 \u2191 \u2191 \u2191 v1 (initially) \u2502 v2 \u2502 v1 (moved) After release flow: - v1.0.0: Created v1 and v1.0.0 pointing to commit B - v1.1.0: Created v1.1.0 at commit C, kept v1.0.0 at B - v1.2.0: Created v1.2.0 at commit E, moved v1 from B to E - v2.0.0: Created v2 and v2.0.0 pointing to commit F Release Process Step-by-Step Guide 1. Prepare the Release Make and commit your changes: # Make your changes git add . git commit -m \"feat: add caching support to pixi action\" git push origin main 2. Create Specific Version Tag # Create an annotated tag git tag -a v1.1.0 -m \"Release v1.1.0 - Add caching support for faster CI runs - Improve error messages for missing lock files - Update documentation with caching examples\" # Push the tag git push origin v1.1.0 3. Create or Move Major Version Tag # Move the major version tag to the new release git tag -fa v1 -m \"Update v1 to v1.1.0\" # Force push (required because we're overwriting an existing tag) git push origin v1 --force 4. Create GitHub Release Option A: Using GitHub CLI gh release create v1.1.0 \\ --title \"v1.1.0 - Caching Support\" \\ --notes \"## \ud83c\udf89 New Features - **Caching**: Enable environment caching with \\`cache: 'true'\\` - **Improved Errors**: Better error messages for common issues ## \ud83d\udcdd Documentation - Updated pixi.md with caching examples - Added troubleshooting section ## \ud83d\udd27 Internal - Refactored validation logic - Added integration tests for caching ## \ud83d\udce6 Upgrade Notes This is a backward-compatible release. Simply update your action reference from \\`@v1.0.0\\` to \\`@v1.1.0\\` or use \\`@v1\\` for automatic updates.\" Option B: Using GitHub Web UI Go to your repository on GitHub Click \"Releases\" \u2192 \"Draft a new release\" Click \"Choose a tag\" \u2192 Select v1.1.0 Set \"Release title\" : v1.1.0 - Caching Support Write release notes (see format above) Click \"Publish release\" Automated Release Workflow Create .github/workflows/release.yml to automate releases: name: Create Release on: push: tags: - 'v*.*.*' permissions: contents: write jobs: release: name: Create Release runs-on: ubuntu-latest steps: - name: Checkout code uses: actions/checkout@v4 with: fetch-depth: 0 - name: Get version info id: version run: | TAG=${GITHUB_REF#refs/tags/} MAJOR_VERSION=$(echo $TAG | cut -d. -f1) echo \"tag=$TAG\" >> $GITHUB_OUTPUT echo \"major=$MAJOR_VERSION\" >> $GITHUB_OUTPUT - name: Create GitHub Release uses: softprops/action-gh-release@v2 with: generate_release_notes: true draft: false prerelease: false - name: Update major version tag run: | git config user.name \"github-actions[bot]\" git config user.email \"github-actions[bot]@users.noreply.github.com\" git tag -fa ${{ steps.version.outputs.major }} -m \"Update ${{ steps.version.outputs.major }} to ${{ steps.version.outputs.tag }}\" git push origin ${{ steps.version.outputs.major }} --force How it works: 1. Push a version tag: git push origin v1.1.0 2. Workflow automatically: - Creates a GitHub release - Generates release notes from commits - Moves the major version tag ( v1 ) Moving Major Version Tags What Does \"Moving\" Mean? Moving a tag means updating a Git tag to point to a different commit. This is done by: 1. Deleting the old tag (with -f flag) 2. Creating a new tag with the same name at a different commit 3. Force-pushing to overwrite the remote tag Why Move Major Version Tags? This allows users to: - \u2705 Get automatic bug fixes and features - \u2705 Stay within a major version (no breaking changes) - \u2705 Avoid updating workflow files for every patch/minor release Commands Explained # -f = force (allows overwriting existing tag) # -a = annotated (creates tag with metadata) git tag -fa v1 -m \"Update v1 to v1.1.0\" # --force = required to overwrite remote tag git push origin v1 --force Example Flow Initial Release (v1.0.0): git tag -a v1.0.0 -m \"Release v1.0.0\" git push origin v1.0.0 git tag -a v1 -m \"Major version v1 -> v1.0.0\" git push origin v1 Result: Both v1 and v1.0.0 point to the same commit. Bug Fix Release (v1.0.1): git tag -a v1.0.1 -m \"Release v1.0.1\" git push origin v1.0.1 # Move v1 to point to v1.0.1 git tag -fa v1 -m \"Update v1 -> v1.0.1\" git push origin v1 --force Result: - v1.0.0 \u2192 Still points to old commit - v1.0.1 \u2192 Points to new commit - v1 \u2192 Now points to new commit (moved) New Feature Release (v1.1.0): git tag -a v1.1.0 -m \"Release v1.1.0\" git push origin v1.1.0 # Move v1 again git tag -fa v1 -m \"Update v1 -> v1.1.0\" git push origin v1 --force Result: v1 now points to v1.1.0 (moved again). Breaking Change Release (v2.0.0): git tag -a v2.0.0 -m \"Release v2.0.0\" git push origin v2.0.0 # Create NEW major version tag (don't move v1) git tag -a v2 -m \"Major version v2 -> v2.0.0\" git push origin v2 Result: - v1 \u2192 Still points to v1.1.0 - v2 \u2192 Points to v2.0.0 (new tag) - Users must explicitly update to @v2 Usage for Consumers Referencing Actions Users can reference your actions in three ways: Option 1: Specific Version (Recommended for Production) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1.0.0 Pros: - \u2705 Completely stable and reproducible - \u2705 Never changes unexpectedly - \u2705 Best for security-critical workflows Cons: - \u274c Doesn't get bug fixes automatically - \u274c Must manually update for new features Best for: Production, security-sensitive, compliance-required workflows Option 2: Major Version (Recommended for Most Users) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 Pros: - \u2705 Gets bug fixes automatically - \u2705 Gets new features automatically (within v1.x.x) - \u2705 No breaking changes Cons: - \u274c Behavior may change slightly - \u274c Requires trust in maintainers Best for: Most workflows, active development, CI/CD pipelines Option 3: Branch (Not Recommended) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@main Pros: - \u2705 Always latest code Cons: - \u274c Can break at any time - \u274c Includes breaking changes - \u274c Not reproducible Best for: Testing unreleased features, development only Recommendation Matrix Use Case Recommended Reference Example Production workflows Specific version @v1.0.0 CI/CD pipelines Major version @v1 Active development Major version @v1 Security-critical Specific version @v1.0.0 Testing new features Branch @main Dependabot/Renovate Major version @v1 Breaking Changes What Constitutes a Breaking Change? A breaking change requires a major version bump (e.g., v1.x.x \u2192 v2.0.0). Breaking Changes (Require v2.0.0): \u274c Removing an input parameter \u274c Renaming an input parameter \u274c Changing an input from optional to required \u274c Changing default values that affect behavior \u274c Removing or renaming outputs \u274c Changing behavior in incompatible ways \u274c Dropping support for older versions (e.g., Python 3.7) \u274c Changing error handling that could break workflows NOT Breaking Changes (Can be v1.1.0): \u2705 Adding new optional input parameters \u2705 Adding new outputs \u2705 Deprecating features (but still working) \u2705 Bug fixes that restore intended behavior \u2705 Performance improvements \u2705 Documentation updates \u2705 Adding new features that don't affect existing usage Handling Breaking Changes 1. Deprecation Period (Preferred) Before making a breaking change, deprecate in a minor version: v1.5.0 - Deprecation: inputs: old-name: description: 'DEPRECATED: Use new-name instead' required: false Add warning in action: - name: Deprecation warning if: inputs.old-name != '' shell: bash run: | echo \"::warning::Input 'old-name' is deprecated and will be removed in v2.0.0. Use 'new-name' instead.\" v2.0.0 - Removal: inputs: new-name: description: 'Replacement for old-name' required: false 2. Migration Guide Always provide a migration guide in the release notes: ## \ud83d\udca5 Breaking Changes in v2.0.0 ### Removed `cache-key` input The `cache-key` input has been removed. Caching now uses an automatic key based on `pixi.lock`. **Migration:** ```diff - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: - cache-key: custom-key cache: 'true' The action will automatically generate an optimal cache key. Changed verify-lock default The default for verify-lock changed from 'false' to 'true' . Migration: If you want the old behavior: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v2 with: verify-lock: 'false' # Explicit old behavior ## Examples ### Example 1: First Release ```bash # Initial release git tag -a v1.0.0 -m \"Release v1.0.0: Initial release\" git push origin v1.0.0 git tag -a v1 -m \"Major version v1\" git push origin v1 gh release create v1.0.0 --title \"v1.0.0 - Initial Release\" --generate-notes Example 2: Bug Fix # Bug fix release git tag -a v1.0.1 -m \"Release v1.0.1: Fix cache key generation\" git push origin v1.0.1 # Move v1 to include the fix git tag -fa v1 -m \"Update v1 to v1.0.1\" git push origin v1 --force gh release create v1.0.1 --title \"v1.0.1 - Bug Fixes\" --notes \"Fix cache key generation for Windows\" Example 3: New Feature # New feature release git tag -a v1.1.0 -m \"Release v1.1.0: Add caching support\" git push origin v1.1.0 # Move v1 to include the feature git tag -fa v1 -m \"Update v1 to v1.1.0\" git push origin v1 --force gh release create v1.1.0 --title \"v1.1.0 - Caching Support\" --generate-notes Example 4: Breaking Change # Breaking change release git tag -a v2.0.0 -m \"Release v2.0.0: Remove deprecated inputs\" git push origin v2.0.0 # Create NEW major version tag (don't touch v1) git tag -a v2 -m \"Major version v2\" git push origin v2 gh release create v2.0.0 --title \"v2.0.0 - Breaking Changes\" --notes \"See MIGRATION.md for upgrade guide\" Best Practices For Maintainers \u2705 Always use annotated tags ( -a flag) with meaningful messages \u2705 Test thoroughly before releasing \u2705 Write clear release notes explaining what changed \u2705 Pin action dependencies to specific SHA or version tags \u2705 Document breaking changes with migration guides \u2705 Use deprecation warnings before removing features \u2705 Keep v1, v2, etc. updated with each release \u2705 Never delete or force-push specific version tags (only major versions) For Consumers \u2705 Use major version tags for most workflows ( @v1 ) \u2705 Pin specific versions for critical/production workflows ( @v1.0.0 ) \u2705 Read release notes when major versions change \u2705 Test in staging before updating major versions \u2705 Use Dependabot/Renovate to track updates \u2705 Never use @main in production Checklist for Releases Pre-Release [ ] All changes committed and pushed [ ] Tests passing [ ] Documentation updated [ ] CHANGELOG updated (if applicable) [ ] Version number decided (PATCH/MINOR/MAJOR) [ ] Breaking changes documented [ ] Migration guide written (if breaking changes) Release [ ] Create specific version tag (e.g., v1.1.0 ) [ ] Push specific version tag [ ] Move major version tag (e.g., v1 ) [ ] Force push major version tag [ ] Create GitHub release with notes [ ] Test the release in a sample workflow Post-Release [ ] Verify tags are correct on GitHub [ ] Verify release notes are clear [ ] Update README if needed [ ] Announce in relevant channels [ ] Monitor for issues References Semantic Versioning GitHub Actions Versioning Git Tagging Version : 1.0 Last Updated : January 2026 Maintained by : Serapieum-of-alex","title":"Versioning Guide for GitHub Actions"},{"location":"VERSIONING/#versioning-guide-for-github-actions","text":"This document explains the versioning strategy used in this repository for publishing and maintaining GitHub Actions.","title":"Versioning Guide for GitHub Actions"},{"location":"VERSIONING/#table-of-contents","text":"Overview Semantic Versioning Tag Strategy Release Process Moving Major Version Tags Usage for Consumers Breaking Changes Examples","title":"Table of Contents"},{"location":"VERSIONING/#overview","text":"This repository contains reusable GitHub Actions (composite actions). Unlike traditional software packages, GitHub Actions use a tag-based versioning system where users reference specific versions directly in their workflows. Key Principles: - \u2705 Use semantic versioning (e.g., v1.0.0 , v1.1.0 , v2.0.0 ) - \u2705 Maintain moving major version tags (e.g., v1 , v2 ) for convenience - \u2705 Keep specific version tags immutable (e.g., v1.0.0 never changes) - \u2705 Use v prefix for all version tags","title":"Overview"},{"location":"VERSIONING/#semantic-versioning","text":"We follow Semantic Versioning 2.0.0 with the format: vMAJOR.MINOR.PATCH","title":"Semantic Versioning"},{"location":"VERSIONING/#version-components","text":"v1.2.3 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500 PATCH: Bug fixes, documentation updates (backward compatible) \u2502 \u2514\u2500\u2500\u2500\u2500 MINOR: New features, improvements (backward compatible) \u2514\u2500\u2500\u2500\u2500\u2500\u2500 MAJOR: Breaking changes (NOT backward compatible)","title":"Version Components"},{"location":"VERSIONING/#when-to-increment","text":"Version Increment When Examples PATCH Bug fixes, docs, internal refactoring v1.0.0 \u2192 v1.0.1 MINOR New features, new inputs (optional), deprecations v1.0.1 \u2192 v1.1.0 MAJOR Breaking changes, removed features, required inputs changed v1.1.0 \u2192 v2.0.0","title":"When to Increment"},{"location":"VERSIONING/#examples-of-changes","text":"","title":"Examples of Changes"},{"location":"VERSIONING/#patch-version-v100-v101","text":"\ud83d\udc1b Fix a bug in cache key generation \ud83d\udcdd Update documentation \ud83d\udd27 Internal code refactoring \u26a1 Performance improvements (no behavior change)","title":"PATCH Version (v1.0.0 \u2192 v1.0.1)"},{"location":"VERSIONING/#minor-version-v101-v110","text":"\u2728 Add new optional input parameter \ud83c\udf89 Add new feature that doesn't affect existing usage \ud83d\udcca Add new logging/output \u26a0\ufe0f Deprecate a feature (but still works)","title":"MINOR Version (v1.0.1 \u2192 v1.1.0)"},{"location":"VERSIONING/#major-version-v110-v200","text":"\ud83d\udca5 Remove or rename an input parameter \ud83d\udca5 Change default behavior significantly \ud83d\udca5 Remove deprecated features \ud83d\udca5 Change required inputs or validation rules \ud83d\udca5 Update to incompatible dependency versions","title":"MAJOR Version (v1.1.0 \u2192 v2.0.0)"},{"location":"VERSIONING/#tag-strategy","text":"","title":"Tag Strategy"},{"location":"VERSIONING/#two-types-of-tags","text":"We maintain two types of Git tags:","title":"Two Types of Tags"},{"location":"VERSIONING/#1-specific-version-tags-immutable","text":"Format: v1.0.0 , v1.1.0 , v1.2.0 , v2.0.0 Characteristics: - \u2705 Never moved or changed - \u2705 Point to a specific commit forever - \u2705 Used for reproducibility and security - \u2705 Ideal for production workflows Example: # Pin to exact version - never changes - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1.0.0","title":"1. Specific Version Tags (Immutable)"},{"location":"VERSIONING/#2-major-version-tags-moving","text":"Format: v1 , v2 , v3 Characteristics: - \ud83d\udd04 Updated with each new release within the major version - \ud83d\udd04 Points to the latest compatible version - \ud83d\udd04 Used for automatic updates - \u26a0\ufe0f May change behavior (but stays backward compatible) Example: # Use major version - gets updates automatically - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1","title":"2. Major Version Tags (Moving)"},{"location":"VERSIONING/#visual-representation","text":"Timeline of commits and tags: A ---- B ---- C ---- D ---- E ---- F \u2191 \u2191 \u2191 \u2191 \u2502 \u2502 \u2502 \u2502 v1.0.0 v1.1.0 v1.2.0 v2.0.0 \u2191 \u2191 \u2191 v1 (initially) \u2502 v2 \u2502 v1 (moved) After release flow: - v1.0.0: Created v1 and v1.0.0 pointing to commit B - v1.1.0: Created v1.1.0 at commit C, kept v1.0.0 at B - v1.2.0: Created v1.2.0 at commit E, moved v1 from B to E - v2.0.0: Created v2 and v2.0.0 pointing to commit F","title":"Visual Representation"},{"location":"VERSIONING/#release-process","text":"","title":"Release Process"},{"location":"VERSIONING/#step-by-step-guide","text":"","title":"Step-by-Step Guide"},{"location":"VERSIONING/#1-prepare-the-release","text":"Make and commit your changes: # Make your changes git add . git commit -m \"feat: add caching support to pixi action\" git push origin main","title":"1. Prepare the Release"},{"location":"VERSIONING/#2-create-specific-version-tag","text":"# Create an annotated tag git tag -a v1.1.0 -m \"Release v1.1.0 - Add caching support for faster CI runs - Improve error messages for missing lock files - Update documentation with caching examples\" # Push the tag git push origin v1.1.0","title":"2. Create Specific Version Tag"},{"location":"VERSIONING/#3-create-or-move-major-version-tag","text":"# Move the major version tag to the new release git tag -fa v1 -m \"Update v1 to v1.1.0\" # Force push (required because we're overwriting an existing tag) git push origin v1 --force","title":"3. Create or Move Major Version Tag"},{"location":"VERSIONING/#4-create-github-release","text":"Option A: Using GitHub CLI gh release create v1.1.0 \\ --title \"v1.1.0 - Caching Support\" \\ --notes \"## \ud83c\udf89 New Features - **Caching**: Enable environment caching with \\`cache: 'true'\\` - **Improved Errors**: Better error messages for common issues ## \ud83d\udcdd Documentation - Updated pixi.md with caching examples - Added troubleshooting section ## \ud83d\udd27 Internal - Refactored validation logic - Added integration tests for caching ## \ud83d\udce6 Upgrade Notes This is a backward-compatible release. Simply update your action reference from \\`@v1.0.0\\` to \\`@v1.1.0\\` or use \\`@v1\\` for automatic updates.\" Option B: Using GitHub Web UI Go to your repository on GitHub Click \"Releases\" \u2192 \"Draft a new release\" Click \"Choose a tag\" \u2192 Select v1.1.0 Set \"Release title\" : v1.1.0 - Caching Support Write release notes (see format above) Click \"Publish release\"","title":"4. Create GitHub Release"},{"location":"VERSIONING/#automated-release-workflow","text":"Create .github/workflows/release.yml to automate releases: name: Create Release on: push: tags: - 'v*.*.*' permissions: contents: write jobs: release: name: Create Release runs-on: ubuntu-latest steps: - name: Checkout code uses: actions/checkout@v4 with: fetch-depth: 0 - name: Get version info id: version run: | TAG=${GITHUB_REF#refs/tags/} MAJOR_VERSION=$(echo $TAG | cut -d. -f1) echo \"tag=$TAG\" >> $GITHUB_OUTPUT echo \"major=$MAJOR_VERSION\" >> $GITHUB_OUTPUT - name: Create GitHub Release uses: softprops/action-gh-release@v2 with: generate_release_notes: true draft: false prerelease: false - name: Update major version tag run: | git config user.name \"github-actions[bot]\" git config user.email \"github-actions[bot]@users.noreply.github.com\" git tag -fa ${{ steps.version.outputs.major }} -m \"Update ${{ steps.version.outputs.major }} to ${{ steps.version.outputs.tag }}\" git push origin ${{ steps.version.outputs.major }} --force How it works: 1. Push a version tag: git push origin v1.1.0 2. Workflow automatically: - Creates a GitHub release - Generates release notes from commits - Moves the major version tag ( v1 )","title":"Automated Release Workflow"},{"location":"VERSIONING/#moving-major-version-tags","text":"","title":"Moving Major Version Tags"},{"location":"VERSIONING/#what-does-moving-mean","text":"Moving a tag means updating a Git tag to point to a different commit. This is done by: 1. Deleting the old tag (with -f flag) 2. Creating a new tag with the same name at a different commit 3. Force-pushing to overwrite the remote tag","title":"What Does \"Moving\" Mean?"},{"location":"VERSIONING/#why-move-major-version-tags","text":"This allows users to: - \u2705 Get automatic bug fixes and features - \u2705 Stay within a major version (no breaking changes) - \u2705 Avoid updating workflow files for every patch/minor release","title":"Why Move Major Version Tags?"},{"location":"VERSIONING/#commands-explained","text":"# -f = force (allows overwriting existing tag) # -a = annotated (creates tag with metadata) git tag -fa v1 -m \"Update v1 to v1.1.0\" # --force = required to overwrite remote tag git push origin v1 --force","title":"Commands Explained"},{"location":"VERSIONING/#example-flow","text":"Initial Release (v1.0.0): git tag -a v1.0.0 -m \"Release v1.0.0\" git push origin v1.0.0 git tag -a v1 -m \"Major version v1 -> v1.0.0\" git push origin v1 Result: Both v1 and v1.0.0 point to the same commit. Bug Fix Release (v1.0.1): git tag -a v1.0.1 -m \"Release v1.0.1\" git push origin v1.0.1 # Move v1 to point to v1.0.1 git tag -fa v1 -m \"Update v1 -> v1.0.1\" git push origin v1 --force Result: - v1.0.0 \u2192 Still points to old commit - v1.0.1 \u2192 Points to new commit - v1 \u2192 Now points to new commit (moved) New Feature Release (v1.1.0): git tag -a v1.1.0 -m \"Release v1.1.0\" git push origin v1.1.0 # Move v1 again git tag -fa v1 -m \"Update v1 -> v1.1.0\" git push origin v1 --force Result: v1 now points to v1.1.0 (moved again). Breaking Change Release (v2.0.0): git tag -a v2.0.0 -m \"Release v2.0.0\" git push origin v2.0.0 # Create NEW major version tag (don't move v1) git tag -a v2 -m \"Major version v2 -> v2.0.0\" git push origin v2 Result: - v1 \u2192 Still points to v1.1.0 - v2 \u2192 Points to v2.0.0 (new tag) - Users must explicitly update to @v2","title":"Example Flow"},{"location":"VERSIONING/#usage-for-consumers","text":"","title":"Usage for Consumers"},{"location":"VERSIONING/#referencing-actions","text":"Users can reference your actions in three ways:","title":"Referencing Actions"},{"location":"VERSIONING/#option-1-specific-version-recommended-for-production","text":"- uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1.0.0 Pros: - \u2705 Completely stable and reproducible - \u2705 Never changes unexpectedly - \u2705 Best for security-critical workflows Cons: - \u274c Doesn't get bug fixes automatically - \u274c Must manually update for new features Best for: Production, security-sensitive, compliance-required workflows","title":"Option 1: Specific Version (Recommended for Production)"},{"location":"VERSIONING/#option-2-major-version-recommended-for-most-users","text":"- uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 Pros: - \u2705 Gets bug fixes automatically - \u2705 Gets new features automatically (within v1.x.x) - \u2705 No breaking changes Cons: - \u274c Behavior may change slightly - \u274c Requires trust in maintainers Best for: Most workflows, active development, CI/CD pipelines","title":"Option 2: Major Version (Recommended for Most Users)"},{"location":"VERSIONING/#option-3-branch-not-recommended","text":"- uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@main Pros: - \u2705 Always latest code Cons: - \u274c Can break at any time - \u274c Includes breaking changes - \u274c Not reproducible Best for: Testing unreleased features, development only","title":"Option 3: Branch (Not Recommended)"},{"location":"VERSIONING/#recommendation-matrix","text":"Use Case Recommended Reference Example Production workflows Specific version @v1.0.0 CI/CD pipelines Major version @v1 Active development Major version @v1 Security-critical Specific version @v1.0.0 Testing new features Branch @main Dependabot/Renovate Major version @v1","title":"Recommendation Matrix"},{"location":"VERSIONING/#breaking-changes","text":"","title":"Breaking Changes"},{"location":"VERSIONING/#what-constitutes-a-breaking-change","text":"A breaking change requires a major version bump (e.g., v1.x.x \u2192 v2.0.0).","title":"What Constitutes a Breaking Change?"},{"location":"VERSIONING/#breaking-changes-require-v200","text":"\u274c Removing an input parameter \u274c Renaming an input parameter \u274c Changing an input from optional to required \u274c Changing default values that affect behavior \u274c Removing or renaming outputs \u274c Changing behavior in incompatible ways \u274c Dropping support for older versions (e.g., Python 3.7) \u274c Changing error handling that could break workflows","title":"Breaking Changes (Require v2.0.0):"},{"location":"VERSIONING/#not-breaking-changes-can-be-v110","text":"\u2705 Adding new optional input parameters \u2705 Adding new outputs \u2705 Deprecating features (but still working) \u2705 Bug fixes that restore intended behavior \u2705 Performance improvements \u2705 Documentation updates \u2705 Adding new features that don't affect existing usage","title":"NOT Breaking Changes (Can be v1.1.0):"},{"location":"VERSIONING/#handling-breaking-changes","text":"","title":"Handling Breaking Changes"},{"location":"VERSIONING/#1-deprecation-period-preferred","text":"Before making a breaking change, deprecate in a minor version: v1.5.0 - Deprecation: inputs: old-name: description: 'DEPRECATED: Use new-name instead' required: false Add warning in action: - name: Deprecation warning if: inputs.old-name != '' shell: bash run: | echo \"::warning::Input 'old-name' is deprecated and will be removed in v2.0.0. Use 'new-name' instead.\" v2.0.0 - Removal: inputs: new-name: description: 'Replacement for old-name' required: false","title":"1. Deprecation Period (Preferred)"},{"location":"VERSIONING/#2-migration-guide","text":"Always provide a migration guide in the release notes: ## \ud83d\udca5 Breaking Changes in v2.0.0 ### Removed `cache-key` input The `cache-key` input has been removed. Caching now uses an automatic key based on `pixi.lock`. **Migration:** ```diff - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: - cache-key: custom-key cache: 'true' The action will automatically generate an optimal cache key.","title":"2. Migration Guide"},{"location":"VERSIONING/#changed-verify-lock-default","text":"The default for verify-lock changed from 'false' to 'true' . Migration: If you want the old behavior: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v2 with: verify-lock: 'false' # Explicit old behavior ## Examples ### Example 1: First Release ```bash # Initial release git tag -a v1.0.0 -m \"Release v1.0.0: Initial release\" git push origin v1.0.0 git tag -a v1 -m \"Major version v1\" git push origin v1 gh release create v1.0.0 --title \"v1.0.0 - Initial Release\" --generate-notes","title":"Changed verify-lock default"},{"location":"VERSIONING/#example-2-bug-fix","text":"# Bug fix release git tag -a v1.0.1 -m \"Release v1.0.1: Fix cache key generation\" git push origin v1.0.1 # Move v1 to include the fix git tag -fa v1 -m \"Update v1 to v1.0.1\" git push origin v1 --force gh release create v1.0.1 --title \"v1.0.1 - Bug Fixes\" --notes \"Fix cache key generation for Windows\"","title":"Example 2: Bug Fix"},{"location":"VERSIONING/#example-3-new-feature","text":"# New feature release git tag -a v1.1.0 -m \"Release v1.1.0: Add caching support\" git push origin v1.1.0 # Move v1 to include the feature git tag -fa v1 -m \"Update v1 to v1.1.0\" git push origin v1 --force gh release create v1.1.0 --title \"v1.1.0 - Caching Support\" --generate-notes","title":"Example 3: New Feature"},{"location":"VERSIONING/#example-4-breaking-change","text":"# Breaking change release git tag -a v2.0.0 -m \"Release v2.0.0: Remove deprecated inputs\" git push origin v2.0.0 # Create NEW major version tag (don't touch v1) git tag -a v2 -m \"Major version v2\" git push origin v2 gh release create v2.0.0 --title \"v2.0.0 - Breaking Changes\" --notes \"See MIGRATION.md for upgrade guide\"","title":"Example 4: Breaking Change"},{"location":"VERSIONING/#best-practices","text":"","title":"Best Practices"},{"location":"VERSIONING/#for-maintainers","text":"\u2705 Always use annotated tags ( -a flag) with meaningful messages \u2705 Test thoroughly before releasing \u2705 Write clear release notes explaining what changed \u2705 Pin action dependencies to specific SHA or version tags \u2705 Document breaking changes with migration guides \u2705 Use deprecation warnings before removing features \u2705 Keep v1, v2, etc. updated with each release \u2705 Never delete or force-push specific version tags (only major versions)","title":"For Maintainers"},{"location":"VERSIONING/#for-consumers","text":"\u2705 Use major version tags for most workflows ( @v1 ) \u2705 Pin specific versions for critical/production workflows ( @v1.0.0 ) \u2705 Read release notes when major versions change \u2705 Test in staging before updating major versions \u2705 Use Dependabot/Renovate to track updates \u2705 Never use @main in production","title":"For Consumers"},{"location":"VERSIONING/#checklist-for-releases","text":"","title":"Checklist for Releases"},{"location":"VERSIONING/#pre-release","text":"[ ] All changes committed and pushed [ ] Tests passing [ ] Documentation updated [ ] CHANGELOG updated (if applicable) [ ] Version number decided (PATCH/MINOR/MAJOR) [ ] Breaking changes documented [ ] Migration guide written (if breaking changes)","title":"Pre-Release"},{"location":"VERSIONING/#release","text":"[ ] Create specific version tag (e.g., v1.1.0 ) [ ] Push specific version tag [ ] Move major version tag (e.g., v1 ) [ ] Force push major version tag [ ] Create GitHub release with notes [ ] Test the release in a sample workflow","title":"Release"},{"location":"VERSIONING/#post-release","text":"[ ] Verify tags are correct on GitHub [ ] Verify release notes are clear [ ] Update README if needed [ ] Announce in relevant channels [ ] Monitor for issues","title":"Post-Release"},{"location":"VERSIONING/#references","text":"Semantic Versioning GitHub Actions Versioning Git Tagging Version : 1.0 Last Updated : January 2026 Maintained by : Serapieum-of-alex","title":"References"},{"location":"pytho-setup/pip/","text":"Python Setup with pip - Complete Guide Composite GitHub Action for setting up Python environments with pip package manager, designed for projects using pyproject.toml for dependency management. Table of Contents Overview Quick Start Inputs Reference Features Usage Scenarios Cache Configuration Dependency Groups Testing Guide Troubleshooting Best Practices Overview This action wraps actions/setup-python@v6 with additional functionality for managing pip-based Python projects. It provides: Automatic Python installation and configuration Optional dependency caching for faster CI runs Support for pyproject.toml optional dependency groups Automatic pip upgrade Cross-platform support (Linux, Windows, macOS) Architecture selection (x64, x86) Location : Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 Quick Start Basic Usage (No Cache) steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 This sets up Python 3.12 (default) without caching. Suitable for projects without pyproject.toml or requirements.txt . With Caching steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' Important : Caching requires either pyproject.toml or requirements.txt in your repository root. With Optional Dependencies (Extras) steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: dev test' Installs your package with pip install .[dev,test] . Inputs Reference Input Description Required Default Valid Values python-version Python version to install No '3.12' Any valid Python version (e.g., '3.10' , '3.11' , '3.12' ) cache Enable dependency caching No '' (disabled) '' , 'pip' , 'pipenv' , 'poetry' architecture Target CPU architecture No 'x64' 'x64' , 'x86' install-groups Dependency groups and/or optional dependencies to install No '' (none) Format: 'groups: name1 name2, extras: extra1 extra2' Input Details python-version Specifies which Python version to install. Supports: - Major.minor versions: '3.11' , '3.12' , '3.13' - Full versions: '3.11.5' - Version ranges: '3.x' , '>=3.11' cache Controls dependency caching via actions/setup-python@v6 : - '' (empty string, default): No caching. Use when no pyproject.toml or requirements.txt exists. - 'pip' : Cache pip dependencies from pyproject.toml or requirements.txt - 'pipenv' : Cache pipenv dependencies from Pipfile.lock - 'poetry' : Cache poetry dependencies from poetry.lock Cache Validation : If cache is non-empty, the action validates that pyproject.toml or requirements.txt exists. If neither file is found, the action fails with a clear error message. architecture Selects CPU architecture (mainly relevant for Windows): - 'x64' : 64-bit Python (default, recommended) - 'x86' : 32-bit Python (legacy systems) install-groups Specifies dependency groups from [dependency-groups] and/or optional dependencies from [project.optional-dependencies] in pyproject.toml . Format : 'groups: group1 group2, extras: extra1 extra2' Examples : - Only dependency groups: 'groups: dev test' - Only optional dependencies: 'extras: aws viz' - Mixed: 'groups: dev test, extras: aws viz' - Legacy format (still works): 'dev test' (interpreted as extras for backward compatibility) Behavior : - Optional dependencies (extras) use pip install .[extra1,extra2] - Dependency groups use pip install --dependency-groups group1,group2 (requires pip with PEP 735 support) - If pip doesn't support --dependency-groups , a warning is shown and only extras are installed If install-groups is empty and pyproject.toml exists, runs pip install . (installs only core dependencies). Features 1. Cache Validation The action validates cache requirements before running actions/setup-python@v6 : # This will FAIL with a clear error - uses: ./actions/python-setup/pip with: cache: 'pip' # No pyproject.toml or requirements.txt exists # Error message: # Cache is enabled (cache='pip') but no pyproject.toml or requirements.txt found. # Either create a pyproject.toml/requirements.txt file or set cache: '' to disable caching. 2. Smart Dependency Installation The action intelligently handles different scenarios: Scenario pyproject.toml exists? install-groups Command Executed No file No Any Skipped (message logged) Basic install Yes Empty pip install . With groups Yes 'dev test' pip install .[dev,test] 3. Automatic Pip Upgrade Always runs python -m pip install --upgrade pip after Python setup to ensure the latest pip version. 4. Package Summary Lists installed packages after installation for debugging: pip list 5. Grouped Output All actions are grouped in GitHub Actions logs for better readability: - \"Validating cache requirements\" - \"Upgrading pip\" - \"Installing dependencies\" - \"Installed packages summary\" Usage Scenarios Scenario 1: Basic Install (No Dependency Files) Use Case : Testing the action itself, simple scripts without dependencies, or when you'll install dependencies manually. Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 - name: Verify Python installation run: | python --version pip --version What Happens : - Python 3.12 installed (default) - Pip upgraded to latest - No dependencies installed (logs \"No pyproject.toml found - skipping package installation\") - Cache disabled by default When to use : Quick scripts, action testing, or when you prefer manual pip install commands Scenario 2: Basic Project with pyproject.toml Use Case : Standard Python package with core dependencies. # pyproject.toml [project] name = \"my-package\" version = \"1.0.0\" dependencies = [\"requests\", \"numpy\"] - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' What Happens : - Python installed with caching - Pip upgraded - pip install . executed (installs requests, numpy, and your package) Scenario 3: Development with Optional Dependencies Use Case : Running tests and linters that require dev dependencies. # pyproject.toml [project] name = \"my-package\" dependencies = [\"requests\"] [project.optional-dependencies] dev = [\"pytest\", \"black\", \"mypy\"] test = [\"pytest-cov\", \"pytest-mock\"] docs = [\"mkdocs\", \"mkdocs-material\"] [dependency-groups] lint = [\"ruff\", \"flake8\"] build = [\"build\", \"twine\"] - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'extras: dev test' What Happens : - Python installed with caching - pip install .[dev,test] executed - Installs: requests (core), pytest, black, mypy (dev), pytest-cov, pytest-mock (test) Scenario 4: Matrix Testing Across Python Versions Use Case : Testing compatibility with multiple Python versions. strategy: matrix: python-version: ['3.10', '3.11', '3.12'] os: [ubuntu-latest, windows-latest, macos-latest] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: ${{ matrix.python-version }} cache: 'pip' What Happens : - Tests run on 9 combinations (3 Python versions \u00d7 3 OS platforms) - Each uses cached dependencies for faster runs Scenario 5: Using requirements.txt Instead Use Case : Legacy project using requirements.txt . # requirements.txt requests==2.31.0 numpy==1.26.0 - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' What Happens : - Python installed with caching (validates requirements.txt exists) - Pip upgraded - No automatic installation (you must run pip install -r requirements.txt separately) Scenario 6: Windows 32-bit Architecture Use Case : Supporting legacy Windows systems. - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: architecture: 'x86' cache: 'pip' Scenario 7: Mixed Groups and Extras Use Case : Installing both dependency groups (PEP 735) and optional dependencies (extras) together. pyproject.toml : [project] name = \"my-package\" dependencies = [\"requests\"] [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] [dependency-groups] dev = [\"httpx\", \"pytest\"] Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'groups: dev, extras: aws' - name: Verify installation shell: bash run: | python -c \"import requests; print('[OK] Core dependencies installed')\" python -c \"import boto3; print('[OK] AWS extra installed')\" # Dev group depends on pip version if python -c \"import httpx\" 2>/dev/null; then echo \"[OK] Dev group installed (pip supports --dependency-groups)\" else echo \"[OK] Dev group not installed (pip version limitation)\" fi What Happens : - Core dependencies: requests (always installed) - Optional dependencies (extras): boto3 , s3fs (always works with pip) - Dependency groups: httpx , pytest (requires pip with PEP 735 support) - Shows warning if pip doesn't support --dependency-groups Scenario 8: Poetry/Pipenv Projects Use Case : Using alternative package managers with their specific lock files. With Poetry: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'poetry' - name: Install with Poetry run: | pip install poetry poetry install With Pipenv: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pipenv' - name: Install with Pipenv run: | pip install pipenv pipenv install Scenario 9: Empty Groups/Extras Handling Use Case : Testing edge cases with empty values in install-groups. Workflow: jobs: test-empty-groups: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'groups: , extras: aws' - name: Verify handling shell: bash run: | pip list python -c \"import requests; print('[OK] Core dependencies')\" python -c \"import boto3; print('[OK] AWS extra despite empty groups')\" What Happens : - Empty groups section is gracefully ignored - Core dependencies still installed - AWS extra installs normally Scenario 10: Invalid Format Handling Use Case : Understanding how the action handles malformed input. Workflow: jobs: test-invalid: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'invalid format without colons' - name: Verify warning shown shell: bash run: | # Action will show warning but still install core dependencies python -c \"import requests; print('[OK] Core dependencies installed despite invalid format')\" What Happens : - Warning logged: \"No 'groups:' or 'extras:' sections found\" - Core dependencies still installed - Workflow continues (doesn't fail) Scenario 11: Whitespace Handling Use Case : Flexible formatting with extra whitespace in install-groups. Workflow: jobs: test-whitespace: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: ' groups: dev test , extras: aws viz ' - name: Verify whitespace handling shell: bash run: | python -c \"import boto3; print('[OK] AWS extra installed')\" python -c \"import matplotlib; print('[OK] Viz extra installed')\" What Happens : - Leading/trailing whitespace trimmed - Multiple spaces between groups handled correctly - Groups parsed: dev , test , aws , viz Scenario 12: Only Core Dependencies Use Case : Installing just the package without any optional groups or extras. pyproject.toml : [project] name = \"my-package\" dependencies = [\"requests\", \"click\", \"httpx\"] [project.optional-dependencies] dev = [\"pytest\", \"black\"] [dependency-groups] test = [\"pytest-cov\"] Workflow: jobs: production-install: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # No install-groups parameter - name: Verify only core installed shell: bash run: | pip list python -c \"import requests, click, httpx; print('[OK] Core dependencies')\" echo \"[OK] Only core dependencies installed as expected\" What Happens : - Runs pip install . without any extras or groups - Only dependencies from [project] section installed - Optional dependencies and groups not installed Scenario 13: All Combinations (Comprehensive Test) Use Case : Installing multiple groups and extras simultaneously. pyproject.toml : [project] name = \"enterprise-app\" dependencies = [\"requests\", \"click\"] [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] azure = [\"azure-storage-blob\"] gcp = [\"google-cloud-storage\"] [dependency-groups] dev = [\"httpx\", \"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\", \"mkdocstrings\"] Workflow: jobs: comprehensive-test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'groups: dev test docs, extras: aws azure gcp' - name: Verify comprehensive installation shell: bash run: | # Verify core python -c \"import requests, click; print('[OK] Core dependencies')\" # Verify all extras python -c \"import boto3; print('[OK] AWS extra')\" python -c \"from azure.storage.blob import BlobServiceClient; print('[OK] Azure extra')\" python -c \"from google.cloud import storage; print('[OK] GCP extra')\" # Verify groups (if pip supports) if python -c \"import httpx, pytest, mkdocs\" 2>/dev/null; then echo \"[OK] All dependency groups installed\" else echo \"[OK] Dependency groups not installed (pip doesn't support PEP 735)\" fi What Happens : - Core: requests , click - Extras: All cloud provider SDKs - Groups: Dev, test, docs tools (if pip supports PEP 735) Scenario 14: Reverse Order (Extras Before Groups) Use Case : Verifying order doesn't matter. Workflow: jobs: test-order: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: aws, groups: dev' - name: Verify order handling shell: bash run: | python -c \"import boto3; print('[OK] AWS extra installed')\" if python -c \"import httpx\" 2>/dev/null; then echo \"[OK] Dev group installed\" fi What Happens : - Action parses both sections regardless of order - Same result as 'groups: dev, extras: aws' Cache Configuration When to Enable Cache Enable cache ( cache: 'pip' ) when: - You have pyproject.toml or requirements.txt - Your dependencies don't change frequently - You want faster CI runs (caching can save 30-60 seconds per run) Disable cache ( cache: '' ) when: - No pyproject.toml or requirements.txt exists - Dependencies change on every commit - Testing the action itself - Debugging dependency issues Cache Validation Flow User sets cache: 'pip' \u2193 Action checks for pyproject.toml or requirements.txt \u2193 Found? \u2192 Yes \u2192 Continue to setup-python (cache enabled) \u2192 No \u2192 FAIL with error message Cache Example: Before and After Without Cache (60-90 seconds): Set up Python: 10s Install dependencies: 50-80s Total: 60-90s With Cache (20-30 seconds): Set up Python: 10s Restore cache: 5s Install dependencies: 5-15s (only new/changed packages) Total: 20-30s Dependency Groups Optional Dependencies vs Dependency Groups Key Differences : Optional Dependencies ( [project.optional-dependencies] ): Part of PEP 621 standard, widely supported by all pip versions Published with your package on PyPI Installed using pip install package[extra] syntax Use prefix extras: in this action Always works reliably Dependency Groups ( [dependency-groups] ): Part of PEP 735 standard ( newer, limited support ) Development-only, not published with package Installed using pip install --dependency-groups group (requires recent pip) Use prefix groups: in this action May show warning if pip version doesn't support PEP 735 Recommendation : Use optional dependencies (extras) for maximum compatibility. Use dependency groups only if you need PEP 735 features. Note : If your pip version doesn't support --dependency-groups , the action will show a warning and suggest using the uv action instead, which has full PEP 735 support. Understanding Optional Dependencies (Extras) pyproject.toml supports optional dependency groups using extras: [project] name = \"myapp\" dependencies = [\"requests\"] # Core dependencies (always installed) [project.optional-dependencies] dev = [\"pytest\", \"black\"] # Development tools test = [\"pytest-cov\"] # Testing tools docs = [\"mkdocs\"] # Documentation tools aws = [\"boto3\", \"s3fs\"] # AWS integration viz = [\"matplotlib\", \"seaborn\"] # Visualization all = [\"pytest\", \"black\", \"pytest-cov\", \"mkdocs\", \"boto3\", \"s3fs\", \"matplotlib\", \"seaborn\"] # Everything Understanding Dependency Groups (PEP 735) Dependency groups are an alternative for development-only dependencies: [project] name = \"myapp\" dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx>=0.25\", \"rich>=13.0\"] test = [\"pytest>=7.0\", \"pytest-cov>=4.0\"] docs = [\"mkdocs>=1.5\", \"mkdocstrings>=0.24\"] Installing Groups and Extras install-groups Value Commands Generated What Gets Installed '' (empty) pip install . Core dependencies only 'extras: dev' pip install .[dev] Core + dev extras 'extras: dev test' pip install .[dev,test] Core + dev + test extras 'groups: lint' pip install . then pip install --dependency-groups lint (if supported) Core + lint group 'groups: lint build, extras: dev' pip install .[dev] then pip install --dependency-groups lint,build Core + dev extras + lint/build groups 'extras: aws viz, groups: dev' pip install .[aws,viz] then pip install --dependency-groups dev Core + AWS/viz extras + dev group PEP 735 Support and Warnings When pip supports --dependency-groups : === Installation Summary === \u2713 Dependency groups will be installed: dev test \u2713 Optional dependencies (extras) will be installed: aws \u2713 Core dependencies will always be installed ========================== Installing package with optional dependencies: pip install .[aws] Installing dependency groups: pip install --dependency-groups dev,test When pip doesn't support --dependency-groups : Warning: pip version does not support --dependency-groups flag (PEP 735). Dependency groups will be ignored: dev test Warning: Please use a newer version of pip or consider using the uv action instead. The action will still install core dependencies and extras successfully, but dependency groups will be skipped. Common Patterns Test Workflow (using extras for compatibility) : jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: test' - run: pytest --cov=src Lint Workflow (using extras) : jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: dev' - run: black --check . - run: mypy src/ Documentation Workflow : jobs: docs: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: docs' - run: mkdocs build - run: mkdocs gh-deploy --force Combined Workflow (extras + groups) : jobs: ci: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'groups: dev test, extras: aws' - run: black --check . - run: pytest Production Installation (core only) : jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # No install-groups = core only - run: python app.py Migrating from Dependency Groups to Extras If you encounter warnings about unsupported --dependency-groups , consider: Option 1: Use optional dependencies (extras) instead # Before (dependency groups - limited support) [dependency-groups] dev = [\"pytest\", \"black\"] # After (optional dependencies - universal support) [project.optional-dependencies] dev = [\"pytest\", \"black\"] Option 2: Use the uv action (has full PEP 735 support) # Instead of pip action - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev test' # Full PEP 735 support Testing Guide This action is comprehensively tested across multiple scenarios to ensure reliability. Reference the test workflow at .github/workflows/test-python-setup-pip.yml . Test Coverage Matrix Test Job Purpose Key Validations Fixture test-pip-basic Default behavior without cache Python installed, no cache validation - test-pip-with-groups Optional dependencies (extras) Multiple extras installed correctly test-pip-with-groups/ test-pip-matrix Cross-platform compatibility Works on Linux/Windows/macOS with Python 3.11/3.12/3.13/3.14 test-pip-matrix/ test-pip-cache Cache functionality Dependencies cached and restored test-pip-cache/ test-pip-architecture Architecture selection x64 and x86 work correctly on Windows test-pip-architecture/ test-pip-cache-validation-error Cache validation error handling Fails gracefully when cache enabled without files - test-pip-cache-with-requirements requirements.txt support Cache validation passes with requirements.txt test-pip-cache-with-requirements/ test-pip-no-dependency-file No dependency files Works without pyproject.toml/requirements.txt when cache disabled - test-pip-empty-sections Empty groups/extras sections Empty groups handled gracefully test-pip-empty-sections/ test-pip-invalid-format Invalid format handling Shows warning, continues with core deps test-pip-invalid-format/ test-pip-optional-dependencies Optional dependencies (extras) Extras installed, groups show warning test-pip-optional-dependencies/ test-pip-mixed-groups-and-extras Mixed groups and extras Both types install (groups if supported) test-pip-mixed-groups-and-extras/ test-pip-dependency-groups-only Dependency groups only Groups install if pip supports PEP 735 test-pip-dependency-groups-only/ test-pip-groups-docs-only Single dependency group (docs) Shows expected warning for unsupported pip test-pip-groups-only-docs/ test-pip-all-combinations All combinations (groups + extras) Comprehensive installation of multiple groups/extras test-pip-all-combinations/ test-pip-single-extra Single extra only Single extra installs correctly test-pip-single-extra/ test-pip-single-group Single group only Single group installs if supported test-pip-single-group/ test-pip-only-core-dependencies Core dependencies only Only core deps, no groups/extras test-pip-only-dependencies/ test-pip-whitespace-handling Whitespace handling Extra whitespace trimmed correctly test-pip-whitespace-handling/ test-pip-empty-groups-value Empty groups value Empty groups: handled gracefully test-pip-empty-groups-only/ test-pip-empty-extras-value Empty extras value Empty extras: handled gracefully test-pip-empty-extras-only/ test-pip-python-version-matrix Python version matrix Works with multiple Python versions test-pip-multiple-python-versions/ test-pip-reverse-order Reverse order (extras before groups) Order doesn't matter test-pip-all-combinations/ test-pip-cache-with-groups Cache with groups and extras Caching works with install-groups test-pip-all-combinations/ Test Fixtures Location All test fixtures are located in tests/data/pip/ directory: tests/data/pip/ \u251c\u2500\u2500 test-pip-with-groups/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-matrix/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-cache/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-architecture/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-cache-with-requirements/ \u2502 \u2514\u2500\u2500 requirements.txt \u251c\u2500\u2500 test-pip-empty-sections/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-invalid-format/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-optional-dependencies/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-mixed-groups-and-extras/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-dependency-groups-only/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-groups-only-docs/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-all-combinations/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-single-extra/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-single-group/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-only-dependencies/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-whitespace-handling/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-empty-groups-only/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-empty-extras-only/ \u2502 \u2514\u2500\u2500 pyproject.toml \u2514\u2500\u2500 test-pip-multiple-python-versions/ \u2514\u2500\u2500 pyproject.toml Example Test Fixtures test-pip-with-groups/pyproject.toml: [project] name = \"test-pip-with-groups\" version = \"0.1.0\" requires-python = \">=3.11\" dependencies = [] [project.optional-dependencies] dev = [\"pytest\", \"black\"] test = [\"pytest-cov\"] test-pip-all-combinations/pyproject.toml: [project] name = \"test-pip-all-combinations\" version = \"0.1.0\" requires-python = \">=3.11\" dependencies = [\"requests\", \"click\"] [project.optional-dependencies] aws = [\"boto3\"] azure = [\"azure-storage-blob\"] gcp = [\"google-cloud-storage\"] [dependency-groups] dev = [\"httpx\", \"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\"] test-pip-cache-with-requirements/requirements.txt: requests==2.31.0 numpy>=1.26.0 Running Tests Locally Use act to test locally: # Install act (if needed) # Windows: choco install act-cli # macOS: brew install act # Run specific test act -j test-pip-basic act -j test-pip-with-groups act -j test-pip-matrix # Run all pip tests act -j test-pip-* Testing in Your Own Workflow Basic Test: # .github/workflows/test-pip-action.yml name: Test pip action on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'extras: dev test' - run: pytest Matrix Test: name: Matrix Test on: [push] jobs: test: runs-on: ${{ matrix.os }} strategy: matrix: os: [ubuntu-latest, windows-latest, macos-latest] python-version: ['3.11', '3.12', '3.13'] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: ${{ matrix.python-version }} cache: 'pip' install-groups: 'extras: test' - run: pytest Cache Test: name: Cache Test on: [push] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: First run (populate cache) uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' - name: Verify cache run: pip list # On subsequent runs, cache will be restored automatically Expected Test Behaviors PEP 735 Support Detection: Tests verify that when pip doesn't support --dependency-groups : - Warning is shown - Core dependencies still install - Optional dependencies (extras) still work - Workflow doesn't fail Cache Validation: Tests verify that: - Cache enabled without dependency files \u2192 fails with clear error - Cache with pyproject.toml \u2192 works - Cache with requirements.txt \u2192 works - Cache disabled \u2192 always works Cross-Platform: Tests verify that: - Shell commands work on Windows (PowerShell), Linux (bash), macOS (bash) - File paths handled correctly - Architecture selection works on Windows (x64, x86) Whitespace Handling: Tests verify that: - Leading/trailing whitespace ignored - Multiple spaces between groups handled - Mixed formatting accepted Debugging Failed Tests Check action logs: - name: Debug installation run: | cat pyproject.toml pip list pip show pytest Verify Python version: - name: Check Python run: | python --version python -c \"import sys; print(sys.version_info)\" Test dependency imports: - name: Test imports run: | python -c \"import pytest; print('pytest OK')\" python -c \"import black; print('black OK')\" Troubleshooting Error: \"No file matched to [ /requirements.txt or /pyproject.toml]\" Cause : cache: 'pip' is enabled but no pyproject.toml or requirements.txt exists. Solution : # Option 1: Disable cache - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: '' # Explicitly disable # Option 2: Create pyproject.toml - name: Create pyproject.toml run: | cat > pyproject.toml << 'EOF' [project] name = \"myproject\" version = \"0.1.0\" EOF - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' Error: \"Invalid requirement: '.[dev][test]'\" Cause : This was a bug in earlier versions (now fixed). Multiple groups were generating .[dev][test] instead of .[dev,test] . Solution : Use the latest version of the action ( @v1 or later). Error: \"UnicodeEncodeError: 'charmap' codec can't encode character\" Cause : Windows default encoding (cp1252) doesn't support Unicode characters in Python print statements. Solution : Use shell: bash and avoid Unicode characters: - name: Test shell: bash run: python -c \"print('[OK] Test passed')\" # Not: print('\u2713 Test passed') Dependencies Not Installing Symptoms : Action succeeds but packages are missing. Debug Steps : Check if pyproject.toml exists: - run: ls -la - run: cat pyproject.toml Verify action output in logs (look for \"Installing dependencies\" group): Found pyproject.toml, installing package... Installing with dependency groups: dev test Running: pip install .[dev,test] Check installed packages: - run: pip list - run: pip show pytest # Check specific package Cache Not Working Symptoms : Dependencies reinstall on every run. Debug Steps : Verify cache is enabled: with: cache: 'pip' # Must be explicitly set Check cache hit in logs: Cache restored from key: ... Ensure dependencies file hasn't changed (cache key is based on file hash). Best Practices 1. Use Cache for Stable Dependencies # Good: Stable project with versioned dependencies - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' 2. Pin Dependency Versions in pyproject.toml # Good: Specific versions for reproducible builds dependencies = [ \"requests==2.31.0\", \"numpy>=1.26.0,<2.0.0\" ] # Avoid: Unpinned versions can break builds dependencies = [\"requests\", \"numpy\"] 3. Separate Dependency Groups by Purpose [project.optional-dependencies] # Good: Logical separation dev = [\"black\", \"mypy\", \"ruff\"] test = [\"pytest\", \"pytest-cov\", \"pytest-mock\"] docs = [\"mkdocs\", \"mkdocs-material\"] # Avoid: Single group for everything dev = [\"black\", \"mypy\", \"pytest\", \"mkdocs\"] 4. Use Matrix Testing for Library Projects # Libraries should test against multiple Python versions strategy: matrix: python-version: ['3.10', '3.11', '3.12'] steps: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: ${{ matrix.python-version }} 5. Disable Cache for Dynamic Dependencies # If dependencies change frequently (e.g., from git branches) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # No cache parameter (defaults to '') 6. Use Specific Action Versions # Good: Pin to major version (gets bug fixes) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # Acceptable: Pin to exact commit (maximum stability) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@abc1234 # Avoid: Using @main (unpredictable) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@main 7. Combine with Other Actions - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'test' - name: Run tests with coverage run: pytest --cov=src --cov-report=xml - name: Upload coverage uses: codecov/codecov-action@v4 Comparison with Other Actions Feature This Action actions/setup-python astral-sh/setup-uv Python Installation \u2713 \u2713 \u2713 Pip Caching \u2713 \u2713 \u2717 Auto Pip Upgrade \u2713 \u2717 N/A Dependency Groups \u2713 \u2717 \u2713 Cache Validation \u2713 \u2717 \u2717 pyproject.toml Auto-install \u2713 \u2717 \u2713 Package Summary \u2713 \u2717 \u2717 Cross-platform \u2713 \u2713 \u2713 When to use this action: - Standard pip-based projects - Need dependency groups with pip - Want automatic validation and error messages - Need clear GitHub Actions log output When to use alternatives: - actions/setup-python alone: Minimal setup, no extras needed - astral-sh/setup-uv : Modern projects wanting faster dependency resolution Migration Guide From actions/setup-python Before : - uses: actions/setup-python@v6 with: python-version: '3.12' cache: 'pip' - run: pip install . - run: pip install .[dev,test] After : - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: '3.12' cache: 'pip' install-groups: 'dev test' From Manual Pip Commands Before : - uses: actions/setup-python@v6 - run: python -m pip install --upgrade pip - run: | if [ -f pyproject.toml ]; then pip install .[dev,test] fi After : - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'dev test' Additional Resources GitHub Actions: actions/setup-python Python Packaging User Guide PEP 621: pyproject.toml metadata pip documentation Support For issues, questions, or contributions: - Repository: https://github.com/Serapieum-of-alex/github-actions - Issues: https://github.com/Serapieum-of-alex/github-actions/issues","title":"Python Setup with pip - Complete Guide"},{"location":"pytho-setup/pip/#python-setup-with-pip-complete-guide","text":"Composite GitHub Action for setting up Python environments with pip package manager, designed for projects using pyproject.toml for dependency management.","title":"Python Setup with pip - Complete Guide"},{"location":"pytho-setup/pip/#table-of-contents","text":"Overview Quick Start Inputs Reference Features Usage Scenarios Cache Configuration Dependency Groups Testing Guide Troubleshooting Best Practices","title":"Table of Contents"},{"location":"pytho-setup/pip/#overview","text":"This action wraps actions/setup-python@v6 with additional functionality for managing pip-based Python projects. It provides: Automatic Python installation and configuration Optional dependency caching for faster CI runs Support for pyproject.toml optional dependency groups Automatic pip upgrade Cross-platform support (Linux, Windows, macOS) Architecture selection (x64, x86) Location : Serapieum-of-alex/github-actions/actions/python-setup/pip@v1","title":"Overview"},{"location":"pytho-setup/pip/#quick-start","text":"","title":"Quick Start"},{"location":"pytho-setup/pip/#basic-usage-no-cache","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 This sets up Python 3.12 (default) without caching. Suitable for projects without pyproject.toml or requirements.txt .","title":"Basic Usage (No Cache)"},{"location":"pytho-setup/pip/#with-caching","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' Important : Caching requires either pyproject.toml or requirements.txt in your repository root.","title":"With Caching"},{"location":"pytho-setup/pip/#with-optional-dependencies-extras","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: dev test' Installs your package with pip install .[dev,test] .","title":"With Optional Dependencies (Extras)"},{"location":"pytho-setup/pip/#inputs-reference","text":"Input Description Required Default Valid Values python-version Python version to install No '3.12' Any valid Python version (e.g., '3.10' , '3.11' , '3.12' ) cache Enable dependency caching No '' (disabled) '' , 'pip' , 'pipenv' , 'poetry' architecture Target CPU architecture No 'x64' 'x64' , 'x86' install-groups Dependency groups and/or optional dependencies to install No '' (none) Format: 'groups: name1 name2, extras: extra1 extra2'","title":"Inputs Reference"},{"location":"pytho-setup/pip/#input-details","text":"","title":"Input Details"},{"location":"pytho-setup/pip/#python-version","text":"Specifies which Python version to install. Supports: - Major.minor versions: '3.11' , '3.12' , '3.13' - Full versions: '3.11.5' - Version ranges: '3.x' , '>=3.11'","title":"python-version"},{"location":"pytho-setup/pip/#cache","text":"Controls dependency caching via actions/setup-python@v6 : - '' (empty string, default): No caching. Use when no pyproject.toml or requirements.txt exists. - 'pip' : Cache pip dependencies from pyproject.toml or requirements.txt - 'pipenv' : Cache pipenv dependencies from Pipfile.lock - 'poetry' : Cache poetry dependencies from poetry.lock Cache Validation : If cache is non-empty, the action validates that pyproject.toml or requirements.txt exists. If neither file is found, the action fails with a clear error message.","title":"cache"},{"location":"pytho-setup/pip/#architecture","text":"Selects CPU architecture (mainly relevant for Windows): - 'x64' : 64-bit Python (default, recommended) - 'x86' : 32-bit Python (legacy systems)","title":"architecture"},{"location":"pytho-setup/pip/#install-groups","text":"Specifies dependency groups from [dependency-groups] and/or optional dependencies from [project.optional-dependencies] in pyproject.toml . Format : 'groups: group1 group2, extras: extra1 extra2' Examples : - Only dependency groups: 'groups: dev test' - Only optional dependencies: 'extras: aws viz' - Mixed: 'groups: dev test, extras: aws viz' - Legacy format (still works): 'dev test' (interpreted as extras for backward compatibility) Behavior : - Optional dependencies (extras) use pip install .[extra1,extra2] - Dependency groups use pip install --dependency-groups group1,group2 (requires pip with PEP 735 support) - If pip doesn't support --dependency-groups , a warning is shown and only extras are installed If install-groups is empty and pyproject.toml exists, runs pip install . (installs only core dependencies).","title":"install-groups"},{"location":"pytho-setup/pip/#features","text":"","title":"Features"},{"location":"pytho-setup/pip/#1-cache-validation","text":"The action validates cache requirements before running actions/setup-python@v6 : # This will FAIL with a clear error - uses: ./actions/python-setup/pip with: cache: 'pip' # No pyproject.toml or requirements.txt exists # Error message: # Cache is enabled (cache='pip') but no pyproject.toml or requirements.txt found. # Either create a pyproject.toml/requirements.txt file or set cache: '' to disable caching.","title":"1. Cache Validation"},{"location":"pytho-setup/pip/#2-smart-dependency-installation","text":"The action intelligently handles different scenarios: Scenario pyproject.toml exists? install-groups Command Executed No file No Any Skipped (message logged) Basic install Yes Empty pip install . With groups Yes 'dev test' pip install .[dev,test]","title":"2. Smart Dependency Installation"},{"location":"pytho-setup/pip/#3-automatic-pip-upgrade","text":"Always runs python -m pip install --upgrade pip after Python setup to ensure the latest pip version.","title":"3. Automatic Pip Upgrade"},{"location":"pytho-setup/pip/#4-package-summary","text":"Lists installed packages after installation for debugging: pip list","title":"4. Package Summary"},{"location":"pytho-setup/pip/#5-grouped-output","text":"All actions are grouped in GitHub Actions logs for better readability: - \"Validating cache requirements\" - \"Upgrading pip\" - \"Installing dependencies\" - \"Installed packages summary\"","title":"5. Grouped Output"},{"location":"pytho-setup/pip/#usage-scenarios","text":"","title":"Usage Scenarios"},{"location":"pytho-setup/pip/#scenario-1-basic-install-no-dependency-files","text":"Use Case : Testing the action itself, simple scripts without dependencies, or when you'll install dependencies manually. Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 - name: Verify Python installation run: | python --version pip --version What Happens : - Python 3.12 installed (default) - Pip upgraded to latest - No dependencies installed (logs \"No pyproject.toml found - skipping package installation\") - Cache disabled by default When to use : Quick scripts, action testing, or when you prefer manual pip install commands","title":"Scenario 1: Basic Install (No Dependency Files)"},{"location":"pytho-setup/pip/#scenario-2-basic-project-with-pyprojecttoml","text":"Use Case : Standard Python package with core dependencies. # pyproject.toml [project] name = \"my-package\" version = \"1.0.0\" dependencies = [\"requests\", \"numpy\"] - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' What Happens : - Python installed with caching - Pip upgraded - pip install . executed (installs requests, numpy, and your package)","title":"Scenario 2: Basic Project with pyproject.toml"},{"location":"pytho-setup/pip/#scenario-3-development-with-optional-dependencies","text":"Use Case : Running tests and linters that require dev dependencies. # pyproject.toml [project] name = \"my-package\" dependencies = [\"requests\"] [project.optional-dependencies] dev = [\"pytest\", \"black\", \"mypy\"] test = [\"pytest-cov\", \"pytest-mock\"] docs = [\"mkdocs\", \"mkdocs-material\"] [dependency-groups] lint = [\"ruff\", \"flake8\"] build = [\"build\", \"twine\"] - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'extras: dev test' What Happens : - Python installed with caching - pip install .[dev,test] executed - Installs: requests (core), pytest, black, mypy (dev), pytest-cov, pytest-mock (test)","title":"Scenario 3: Development with Optional Dependencies"},{"location":"pytho-setup/pip/#scenario-4-matrix-testing-across-python-versions","text":"Use Case : Testing compatibility with multiple Python versions. strategy: matrix: python-version: ['3.10', '3.11', '3.12'] os: [ubuntu-latest, windows-latest, macos-latest] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: ${{ matrix.python-version }} cache: 'pip' What Happens : - Tests run on 9 combinations (3 Python versions \u00d7 3 OS platforms) - Each uses cached dependencies for faster runs","title":"Scenario 4: Matrix Testing Across Python Versions"},{"location":"pytho-setup/pip/#scenario-5-using-requirementstxt-instead","text":"Use Case : Legacy project using requirements.txt . # requirements.txt requests==2.31.0 numpy==1.26.0 - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' What Happens : - Python installed with caching (validates requirements.txt exists) - Pip upgraded - No automatic installation (you must run pip install -r requirements.txt separately)","title":"Scenario 5: Using requirements.txt Instead"},{"location":"pytho-setup/pip/#scenario-6-windows-32-bit-architecture","text":"Use Case : Supporting legacy Windows systems. - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: architecture: 'x86' cache: 'pip'","title":"Scenario 6: Windows 32-bit Architecture"},{"location":"pytho-setup/pip/#scenario-7-mixed-groups-and-extras","text":"Use Case : Installing both dependency groups (PEP 735) and optional dependencies (extras) together. pyproject.toml : [project] name = \"my-package\" dependencies = [\"requests\"] [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] [dependency-groups] dev = [\"httpx\", \"pytest\"] Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'groups: dev, extras: aws' - name: Verify installation shell: bash run: | python -c \"import requests; print('[OK] Core dependencies installed')\" python -c \"import boto3; print('[OK] AWS extra installed')\" # Dev group depends on pip version if python -c \"import httpx\" 2>/dev/null; then echo \"[OK] Dev group installed (pip supports --dependency-groups)\" else echo \"[OK] Dev group not installed (pip version limitation)\" fi What Happens : - Core dependencies: requests (always installed) - Optional dependencies (extras): boto3 , s3fs (always works with pip) - Dependency groups: httpx , pytest (requires pip with PEP 735 support) - Shows warning if pip doesn't support --dependency-groups","title":"Scenario 7: Mixed Groups and Extras"},{"location":"pytho-setup/pip/#scenario-8-poetrypipenv-projects","text":"Use Case : Using alternative package managers with their specific lock files. With Poetry: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'poetry' - name: Install with Poetry run: | pip install poetry poetry install With Pipenv: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pipenv' - name: Install with Pipenv run: | pip install pipenv pipenv install","title":"Scenario 8: Poetry/Pipenv Projects"},{"location":"pytho-setup/pip/#scenario-9-empty-groupsextras-handling","text":"Use Case : Testing edge cases with empty values in install-groups. Workflow: jobs: test-empty-groups: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'groups: , extras: aws' - name: Verify handling shell: bash run: | pip list python -c \"import requests; print('[OK] Core dependencies')\" python -c \"import boto3; print('[OK] AWS extra despite empty groups')\" What Happens : - Empty groups section is gracefully ignored - Core dependencies still installed - AWS extra installs normally","title":"Scenario 9: Empty Groups/Extras Handling"},{"location":"pytho-setup/pip/#scenario-10-invalid-format-handling","text":"Use Case : Understanding how the action handles malformed input. Workflow: jobs: test-invalid: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'invalid format without colons' - name: Verify warning shown shell: bash run: | # Action will show warning but still install core dependencies python -c \"import requests; print('[OK] Core dependencies installed despite invalid format')\" What Happens : - Warning logged: \"No 'groups:' or 'extras:' sections found\" - Core dependencies still installed - Workflow continues (doesn't fail)","title":"Scenario 10: Invalid Format Handling"},{"location":"pytho-setup/pip/#scenario-11-whitespace-handling","text":"Use Case : Flexible formatting with extra whitespace in install-groups. Workflow: jobs: test-whitespace: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: ' groups: dev test , extras: aws viz ' - name: Verify whitespace handling shell: bash run: | python -c \"import boto3; print('[OK] AWS extra installed')\" python -c \"import matplotlib; print('[OK] Viz extra installed')\" What Happens : - Leading/trailing whitespace trimmed - Multiple spaces between groups handled correctly - Groups parsed: dev , test , aws , viz","title":"Scenario 11: Whitespace Handling"},{"location":"pytho-setup/pip/#scenario-12-only-core-dependencies","text":"Use Case : Installing just the package without any optional groups or extras. pyproject.toml : [project] name = \"my-package\" dependencies = [\"requests\", \"click\", \"httpx\"] [project.optional-dependencies] dev = [\"pytest\", \"black\"] [dependency-groups] test = [\"pytest-cov\"] Workflow: jobs: production-install: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # No install-groups parameter - name: Verify only core installed shell: bash run: | pip list python -c \"import requests, click, httpx; print('[OK] Core dependencies')\" echo \"[OK] Only core dependencies installed as expected\" What Happens : - Runs pip install . without any extras or groups - Only dependencies from [project] section installed - Optional dependencies and groups not installed","title":"Scenario 12: Only Core Dependencies"},{"location":"pytho-setup/pip/#scenario-13-all-combinations-comprehensive-test","text":"Use Case : Installing multiple groups and extras simultaneously. pyproject.toml : [project] name = \"enterprise-app\" dependencies = [\"requests\", \"click\"] [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] azure = [\"azure-storage-blob\"] gcp = [\"google-cloud-storage\"] [dependency-groups] dev = [\"httpx\", \"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\", \"mkdocstrings\"] Workflow: jobs: comprehensive-test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'groups: dev test docs, extras: aws azure gcp' - name: Verify comprehensive installation shell: bash run: | # Verify core python -c \"import requests, click; print('[OK] Core dependencies')\" # Verify all extras python -c \"import boto3; print('[OK] AWS extra')\" python -c \"from azure.storage.blob import BlobServiceClient; print('[OK] Azure extra')\" python -c \"from google.cloud import storage; print('[OK] GCP extra')\" # Verify groups (if pip supports) if python -c \"import httpx, pytest, mkdocs\" 2>/dev/null; then echo \"[OK] All dependency groups installed\" else echo \"[OK] Dependency groups not installed (pip doesn't support PEP 735)\" fi What Happens : - Core: requests , click - Extras: All cloud provider SDKs - Groups: Dev, test, docs tools (if pip supports PEP 735)","title":"Scenario 13: All Combinations (Comprehensive Test)"},{"location":"pytho-setup/pip/#scenario-14-reverse-order-extras-before-groups","text":"Use Case : Verifying order doesn't matter. Workflow: jobs: test-order: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: aws, groups: dev' - name: Verify order handling shell: bash run: | python -c \"import boto3; print('[OK] AWS extra installed')\" if python -c \"import httpx\" 2>/dev/null; then echo \"[OK] Dev group installed\" fi What Happens : - Action parses both sections regardless of order - Same result as 'groups: dev, extras: aws'","title":"Scenario 14: Reverse Order (Extras Before Groups)"},{"location":"pytho-setup/pip/#cache-configuration","text":"","title":"Cache Configuration"},{"location":"pytho-setup/pip/#when-to-enable-cache","text":"Enable cache ( cache: 'pip' ) when: - You have pyproject.toml or requirements.txt - Your dependencies don't change frequently - You want faster CI runs (caching can save 30-60 seconds per run) Disable cache ( cache: '' ) when: - No pyproject.toml or requirements.txt exists - Dependencies change on every commit - Testing the action itself - Debugging dependency issues","title":"When to Enable Cache"},{"location":"pytho-setup/pip/#cache-validation-flow","text":"User sets cache: 'pip' \u2193 Action checks for pyproject.toml or requirements.txt \u2193 Found? \u2192 Yes \u2192 Continue to setup-python (cache enabled) \u2192 No \u2192 FAIL with error message","title":"Cache Validation Flow"},{"location":"pytho-setup/pip/#cache-example-before-and-after","text":"Without Cache (60-90 seconds): Set up Python: 10s Install dependencies: 50-80s Total: 60-90s With Cache (20-30 seconds): Set up Python: 10s Restore cache: 5s Install dependencies: 5-15s (only new/changed packages) Total: 20-30s","title":"Cache Example: Before and After"},{"location":"pytho-setup/pip/#dependency-groups","text":"","title":"Dependency Groups"},{"location":"pytho-setup/pip/#optional-dependencies-vs-dependency-groups","text":"Key Differences : Optional Dependencies ( [project.optional-dependencies] ): Part of PEP 621 standard, widely supported by all pip versions Published with your package on PyPI Installed using pip install package[extra] syntax Use prefix extras: in this action Always works reliably Dependency Groups ( [dependency-groups] ): Part of PEP 735 standard ( newer, limited support ) Development-only, not published with package Installed using pip install --dependency-groups group (requires recent pip) Use prefix groups: in this action May show warning if pip version doesn't support PEP 735 Recommendation : Use optional dependencies (extras) for maximum compatibility. Use dependency groups only if you need PEP 735 features. Note : If your pip version doesn't support --dependency-groups , the action will show a warning and suggest using the uv action instead, which has full PEP 735 support.","title":"Optional Dependencies vs Dependency Groups"},{"location":"pytho-setup/pip/#understanding-optional-dependencies-extras","text":"pyproject.toml supports optional dependency groups using extras: [project] name = \"myapp\" dependencies = [\"requests\"] # Core dependencies (always installed) [project.optional-dependencies] dev = [\"pytest\", \"black\"] # Development tools test = [\"pytest-cov\"] # Testing tools docs = [\"mkdocs\"] # Documentation tools aws = [\"boto3\", \"s3fs\"] # AWS integration viz = [\"matplotlib\", \"seaborn\"] # Visualization all = [\"pytest\", \"black\", \"pytest-cov\", \"mkdocs\", \"boto3\", \"s3fs\", \"matplotlib\", \"seaborn\"] # Everything","title":"Understanding Optional Dependencies (Extras)"},{"location":"pytho-setup/pip/#understanding-dependency-groups-pep-735","text":"Dependency groups are an alternative for development-only dependencies: [project] name = \"myapp\" dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx>=0.25\", \"rich>=13.0\"] test = [\"pytest>=7.0\", \"pytest-cov>=4.0\"] docs = [\"mkdocs>=1.5\", \"mkdocstrings>=0.24\"]","title":"Understanding Dependency Groups (PEP 735)"},{"location":"pytho-setup/pip/#installing-groups-and-extras","text":"install-groups Value Commands Generated What Gets Installed '' (empty) pip install . Core dependencies only 'extras: dev' pip install .[dev] Core + dev extras 'extras: dev test' pip install .[dev,test] Core + dev + test extras 'groups: lint' pip install . then pip install --dependency-groups lint (if supported) Core + lint group 'groups: lint build, extras: dev' pip install .[dev] then pip install --dependency-groups lint,build Core + dev extras + lint/build groups 'extras: aws viz, groups: dev' pip install .[aws,viz] then pip install --dependency-groups dev Core + AWS/viz extras + dev group","title":"Installing Groups and Extras"},{"location":"pytho-setup/pip/#pep-735-support-and-warnings","text":"When pip supports --dependency-groups : === Installation Summary === \u2713 Dependency groups will be installed: dev test \u2713 Optional dependencies (extras) will be installed: aws \u2713 Core dependencies will always be installed ========================== Installing package with optional dependencies: pip install .[aws] Installing dependency groups: pip install --dependency-groups dev,test When pip doesn't support --dependency-groups : Warning: pip version does not support --dependency-groups flag (PEP 735). Dependency groups will be ignored: dev test Warning: Please use a newer version of pip or consider using the uv action instead. The action will still install core dependencies and extras successfully, but dependency groups will be skipped.","title":"PEP 735 Support and Warnings"},{"location":"pytho-setup/pip/#common-patterns","text":"Test Workflow (using extras for compatibility) : jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: test' - run: pytest --cov=src Lint Workflow (using extras) : jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: dev' - run: black --check . - run: mypy src/ Documentation Workflow : jobs: docs: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'extras: docs' - run: mkdocs build - run: mkdocs gh-deploy --force Combined Workflow (extras + groups) : jobs: ci: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: install-groups: 'groups: dev test, extras: aws' - run: black --check . - run: pytest Production Installation (core only) : jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # No install-groups = core only - run: python app.py","title":"Common Patterns"},{"location":"pytho-setup/pip/#migrating-from-dependency-groups-to-extras","text":"If you encounter warnings about unsupported --dependency-groups , consider: Option 1: Use optional dependencies (extras) instead # Before (dependency groups - limited support) [dependency-groups] dev = [\"pytest\", \"black\"] # After (optional dependencies - universal support) [project.optional-dependencies] dev = [\"pytest\", \"black\"] Option 2: Use the uv action (has full PEP 735 support) # Instead of pip action - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev test' # Full PEP 735 support","title":"Migrating from Dependency Groups to Extras"},{"location":"pytho-setup/pip/#testing-guide","text":"This action is comprehensively tested across multiple scenarios to ensure reliability. Reference the test workflow at .github/workflows/test-python-setup-pip.yml .","title":"Testing Guide"},{"location":"pytho-setup/pip/#test-coverage-matrix","text":"Test Job Purpose Key Validations Fixture test-pip-basic Default behavior without cache Python installed, no cache validation - test-pip-with-groups Optional dependencies (extras) Multiple extras installed correctly test-pip-with-groups/ test-pip-matrix Cross-platform compatibility Works on Linux/Windows/macOS with Python 3.11/3.12/3.13/3.14 test-pip-matrix/ test-pip-cache Cache functionality Dependencies cached and restored test-pip-cache/ test-pip-architecture Architecture selection x64 and x86 work correctly on Windows test-pip-architecture/ test-pip-cache-validation-error Cache validation error handling Fails gracefully when cache enabled without files - test-pip-cache-with-requirements requirements.txt support Cache validation passes with requirements.txt test-pip-cache-with-requirements/ test-pip-no-dependency-file No dependency files Works without pyproject.toml/requirements.txt when cache disabled - test-pip-empty-sections Empty groups/extras sections Empty groups handled gracefully test-pip-empty-sections/ test-pip-invalid-format Invalid format handling Shows warning, continues with core deps test-pip-invalid-format/ test-pip-optional-dependencies Optional dependencies (extras) Extras installed, groups show warning test-pip-optional-dependencies/ test-pip-mixed-groups-and-extras Mixed groups and extras Both types install (groups if supported) test-pip-mixed-groups-and-extras/ test-pip-dependency-groups-only Dependency groups only Groups install if pip supports PEP 735 test-pip-dependency-groups-only/ test-pip-groups-docs-only Single dependency group (docs) Shows expected warning for unsupported pip test-pip-groups-only-docs/ test-pip-all-combinations All combinations (groups + extras) Comprehensive installation of multiple groups/extras test-pip-all-combinations/ test-pip-single-extra Single extra only Single extra installs correctly test-pip-single-extra/ test-pip-single-group Single group only Single group installs if supported test-pip-single-group/ test-pip-only-core-dependencies Core dependencies only Only core deps, no groups/extras test-pip-only-dependencies/ test-pip-whitespace-handling Whitespace handling Extra whitespace trimmed correctly test-pip-whitespace-handling/ test-pip-empty-groups-value Empty groups value Empty groups: handled gracefully test-pip-empty-groups-only/ test-pip-empty-extras-value Empty extras value Empty extras: handled gracefully test-pip-empty-extras-only/ test-pip-python-version-matrix Python version matrix Works with multiple Python versions test-pip-multiple-python-versions/ test-pip-reverse-order Reverse order (extras before groups) Order doesn't matter test-pip-all-combinations/ test-pip-cache-with-groups Cache with groups and extras Caching works with install-groups test-pip-all-combinations/","title":"Test Coverage Matrix"},{"location":"pytho-setup/pip/#test-fixtures-location","text":"All test fixtures are located in tests/data/pip/ directory: tests/data/pip/ \u251c\u2500\u2500 test-pip-with-groups/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-matrix/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-cache/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-architecture/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-cache-with-requirements/ \u2502 \u2514\u2500\u2500 requirements.txt \u251c\u2500\u2500 test-pip-empty-sections/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-invalid-format/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-optional-dependencies/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-mixed-groups-and-extras/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-dependency-groups-only/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-groups-only-docs/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-all-combinations/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-single-extra/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-single-group/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-only-dependencies/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-whitespace-handling/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-empty-groups-only/ \u2502 \u2514\u2500\u2500 pyproject.toml \u251c\u2500\u2500 test-pip-empty-extras-only/ \u2502 \u2514\u2500\u2500 pyproject.toml \u2514\u2500\u2500 test-pip-multiple-python-versions/ \u2514\u2500\u2500 pyproject.toml","title":"Test Fixtures Location"},{"location":"pytho-setup/pip/#example-test-fixtures","text":"test-pip-with-groups/pyproject.toml: [project] name = \"test-pip-with-groups\" version = \"0.1.0\" requires-python = \">=3.11\" dependencies = [] [project.optional-dependencies] dev = [\"pytest\", \"black\"] test = [\"pytest-cov\"] test-pip-all-combinations/pyproject.toml: [project] name = \"test-pip-all-combinations\" version = \"0.1.0\" requires-python = \">=3.11\" dependencies = [\"requests\", \"click\"] [project.optional-dependencies] aws = [\"boto3\"] azure = [\"azure-storage-blob\"] gcp = [\"google-cloud-storage\"] [dependency-groups] dev = [\"httpx\", \"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\"] test-pip-cache-with-requirements/requirements.txt: requests==2.31.0 numpy>=1.26.0","title":"Example Test Fixtures"},{"location":"pytho-setup/pip/#running-tests-locally","text":"Use act to test locally: # Install act (if needed) # Windows: choco install act-cli # macOS: brew install act # Run specific test act -j test-pip-basic act -j test-pip-with-groups act -j test-pip-matrix # Run all pip tests act -j test-pip-*","title":"Running Tests Locally"},{"location":"pytho-setup/pip/#testing-in-your-own-workflow","text":"Basic Test: # .github/workflows/test-pip-action.yml name: Test pip action on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'extras: dev test' - run: pytest Matrix Test: name: Matrix Test on: [push] jobs: test: runs-on: ${{ matrix.os }} strategy: matrix: os: [ubuntu-latest, windows-latest, macos-latest] python-version: ['3.11', '3.12', '3.13'] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: ${{ matrix.python-version }} cache: 'pip' install-groups: 'extras: test' - run: pytest Cache Test: name: Cache Test on: [push] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: First run (populate cache) uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' - name: Verify cache run: pip list # On subsequent runs, cache will be restored automatically","title":"Testing in Your Own Workflow"},{"location":"pytho-setup/pip/#expected-test-behaviors","text":"PEP 735 Support Detection: Tests verify that when pip doesn't support --dependency-groups : - Warning is shown - Core dependencies still install - Optional dependencies (extras) still work - Workflow doesn't fail Cache Validation: Tests verify that: - Cache enabled without dependency files \u2192 fails with clear error - Cache with pyproject.toml \u2192 works - Cache with requirements.txt \u2192 works - Cache disabled \u2192 always works Cross-Platform: Tests verify that: - Shell commands work on Windows (PowerShell), Linux (bash), macOS (bash) - File paths handled correctly - Architecture selection works on Windows (x64, x86) Whitespace Handling: Tests verify that: - Leading/trailing whitespace ignored - Multiple spaces between groups handled - Mixed formatting accepted","title":"Expected Test Behaviors"},{"location":"pytho-setup/pip/#debugging-failed-tests","text":"Check action logs: - name: Debug installation run: | cat pyproject.toml pip list pip show pytest Verify Python version: - name: Check Python run: | python --version python -c \"import sys; print(sys.version_info)\" Test dependency imports: - name: Test imports run: | python -c \"import pytest; print('pytest OK')\" python -c \"import black; print('black OK')\"","title":"Debugging Failed Tests"},{"location":"pytho-setup/pip/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"pytho-setup/pip/#error-no-file-matched-to-requirementstxt-or-pyprojecttoml","text":"Cause : cache: 'pip' is enabled but no pyproject.toml or requirements.txt exists. Solution : # Option 1: Disable cache - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: '' # Explicitly disable # Option 2: Create pyproject.toml - name: Create pyproject.toml run: | cat > pyproject.toml << 'EOF' [project] name = \"myproject\" version = \"0.1.0\" EOF - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip'","title":"Error: \"No file matched to [/requirements.txt or /pyproject.toml]\""},{"location":"pytho-setup/pip/#error-invalid-requirement-devtest","text":"Cause : This was a bug in earlier versions (now fixed). Multiple groups were generating .[dev][test] instead of .[dev,test] . Solution : Use the latest version of the action ( @v1 or later).","title":"Error: \"Invalid requirement: '.[dev][test]'\""},{"location":"pytho-setup/pip/#error-unicodeencodeerror-charmap-codec-cant-encode-character","text":"Cause : Windows default encoding (cp1252) doesn't support Unicode characters in Python print statements. Solution : Use shell: bash and avoid Unicode characters: - name: Test shell: bash run: python -c \"print('[OK] Test passed')\" # Not: print('\u2713 Test passed')","title":"Error: \"UnicodeEncodeError: 'charmap' codec can't encode character\""},{"location":"pytho-setup/pip/#dependencies-not-installing","text":"Symptoms : Action succeeds but packages are missing. Debug Steps : Check if pyproject.toml exists: - run: ls -la - run: cat pyproject.toml Verify action output in logs (look for \"Installing dependencies\" group): Found pyproject.toml, installing package... Installing with dependency groups: dev test Running: pip install .[dev,test] Check installed packages: - run: pip list - run: pip show pytest # Check specific package","title":"Dependencies Not Installing"},{"location":"pytho-setup/pip/#cache-not-working","text":"Symptoms : Dependencies reinstall on every run. Debug Steps : Verify cache is enabled: with: cache: 'pip' # Must be explicitly set Check cache hit in logs: Cache restored from key: ... Ensure dependencies file hasn't changed (cache key is based on file hash).","title":"Cache Not Working"},{"location":"pytho-setup/pip/#best-practices","text":"","title":"Best Practices"},{"location":"pytho-setup/pip/#1-use-cache-for-stable-dependencies","text":"# Good: Stable project with versioned dependencies - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip'","title":"1. Use Cache for Stable Dependencies"},{"location":"pytho-setup/pip/#2-pin-dependency-versions-in-pyprojecttoml","text":"# Good: Specific versions for reproducible builds dependencies = [ \"requests==2.31.0\", \"numpy>=1.26.0,<2.0.0\" ] # Avoid: Unpinned versions can break builds dependencies = [\"requests\", \"numpy\"]","title":"2. Pin Dependency Versions in pyproject.toml"},{"location":"pytho-setup/pip/#3-separate-dependency-groups-by-purpose","text":"[project.optional-dependencies] # Good: Logical separation dev = [\"black\", \"mypy\", \"ruff\"] test = [\"pytest\", \"pytest-cov\", \"pytest-mock\"] docs = [\"mkdocs\", \"mkdocs-material\"] # Avoid: Single group for everything dev = [\"black\", \"mypy\", \"pytest\", \"mkdocs\"]","title":"3. Separate Dependency Groups by Purpose"},{"location":"pytho-setup/pip/#4-use-matrix-testing-for-library-projects","text":"# Libraries should test against multiple Python versions strategy: matrix: python-version: ['3.10', '3.11', '3.12'] steps: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: ${{ matrix.python-version }}","title":"4. Use Matrix Testing for Library Projects"},{"location":"pytho-setup/pip/#5-disable-cache-for-dynamic-dependencies","text":"# If dependencies change frequently (e.g., from git branches) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # No cache parameter (defaults to '')","title":"5. Disable Cache for Dynamic Dependencies"},{"location":"pytho-setup/pip/#6-use-specific-action-versions","text":"# Good: Pin to major version (gets bug fixes) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 # Acceptable: Pin to exact commit (maximum stability) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@abc1234 # Avoid: Using @main (unpredictable) - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@main","title":"6. Use Specific Action Versions"},{"location":"pytho-setup/pip/#7-combine-with-other-actions","text":"- uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'test' - name: Run tests with coverage run: pytest --cov=src --cov-report=xml - name: Upload coverage uses: codecov/codecov-action@v4","title":"7. Combine with Other Actions"},{"location":"pytho-setup/pip/#comparison-with-other-actions","text":"Feature This Action actions/setup-python astral-sh/setup-uv Python Installation \u2713 \u2713 \u2713 Pip Caching \u2713 \u2713 \u2717 Auto Pip Upgrade \u2713 \u2717 N/A Dependency Groups \u2713 \u2717 \u2713 Cache Validation \u2713 \u2717 \u2717 pyproject.toml Auto-install \u2713 \u2717 \u2713 Package Summary \u2713 \u2717 \u2717 Cross-platform \u2713 \u2713 \u2713 When to use this action: - Standard pip-based projects - Need dependency groups with pip - Want automatic validation and error messages - Need clear GitHub Actions log output When to use alternatives: - actions/setup-python alone: Minimal setup, no extras needed - astral-sh/setup-uv : Modern projects wanting faster dependency resolution","title":"Comparison with Other Actions"},{"location":"pytho-setup/pip/#migration-guide","text":"","title":"Migration Guide"},{"location":"pytho-setup/pip/#from-actionssetup-python","text":"Before : - uses: actions/setup-python@v6 with: python-version: '3.12' cache: 'pip' - run: pip install . - run: pip install .[dev,test] After : - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: python-version: '3.12' cache: 'pip' install-groups: 'dev test'","title":"From actions/setup-python"},{"location":"pytho-setup/pip/#from-manual-pip-commands","text":"Before : - uses: actions/setup-python@v6 - run: python -m pip install --upgrade pip - run: | if [ -f pyproject.toml ]; then pip install .[dev,test] fi After : - uses: Serapieum-of-alex/github-actions/actions/python-setup/pip@v1 with: cache: 'pip' install-groups: 'dev test'","title":"From Manual Pip Commands"},{"location":"pytho-setup/pip/#additional-resources","text":"GitHub Actions: actions/setup-python Python Packaging User Guide PEP 621: pyproject.toml metadata pip documentation","title":"Additional Resources"},{"location":"pytho-setup/pip/#support","text":"For issues, questions, or contributions: - Repository: https://github.com/Serapieum-of-alex/github-actions - Issues: https://github.com/Serapieum-of-alex/github-actions/issues","title":"Support"},{"location":"pytho-setup/pixi/","text":"te a# Python Setup with pixi - Complete Guide Composite GitHub Action for setting up Python environments with the pixi package manager, designed for projects using conda-forge packages and cross-platform development with pyproject.toml . Table of Contents Overview Quick Start Inputs Reference Features Usage Scenarios Basic Setup Multiple Environments Environment Activation Matrix Testing Complex Projects with Features Caching Lock File Management Lock File Verification Frozen vs Locked Modes Environment Architecture Caching Strategy Testing Guide Troubleshooting Best Practices Overview This action provides a complete Python environment setup using pixi , a fast package manager built on top of conda. It automatically: Installs pixi package manager Validates lock file existence Sets up one or more pixi environments Activates a specified environment Optionally caches environments for faster CI runs Verifies lock file integrity (configurable) Key Features: - \u2705 Support for conda-forge and other conda channels - \u2705 Cross-platform compatibility (Linux, macOS, Windows) - \u2705 Multiple environment support - \u2705 Feature-based dependency management - \u2705 Intelligent caching with lock file validation - \u2705 Lock file verification modes (locked/frozen) Location : Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 Quick Start Basic Usage (Default Environment) steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 # The default environment is automatically activated! - run: python --version - run: pytest With Multiple Environments steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev test prod' activate-environment: 'dev' - run: pytest # Runs in dev environment With Caching Enabled steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' - run: python --version # Much faster on subsequent runs! Inputs Reference Input Description Required Default Valid Values environments Pixi environments to install No 'default' Space-separated list (e.g., 'py311' , 'dev test prod' ) activate-environment Environment to activate after installation No 'default' Any environment name from your pyproject.toml cache Enable caching of pixi environments No 'false' 'true' , 'false' verify-lock Verify lock file is up to date No 'true' 'true' , 'false' Input Details environments Specifies which pixi environments from [tool.pixi.environments] in pyproject.toml to install. Default behavior ( 'default' ) : Installs only the default environment. When specified : Installs all specified environments. This is useful when you need to prepare multiple environments or when running matrix tests. Formats supported: - Single environment: 'dev' - Space-separated: 'dev test prod' - Multiple runs: You can call the action multiple times with different environments (though not recommended - see best practices) Example pyproject.toml : [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev-tools\"] test = [\"core\", \"test-tools\"] prod = [\"core\"] Usage: # Install only dev environment environments: 'dev' # Install dev and test environments environments: 'dev test' # Install all environments environments: 'default dev test prod' activate-environment Specifies which environment to activate in the GitHub Actions PATH after installation. Default behavior ( 'default' ) : Activates the default environment. Important : This should be ONE of the environments listed in the environments input. If you specify an environment that wasn't installed, the action will fail. Example: # Install multiple environments but activate only 'dev' with: environments: 'dev test prod' activate-environment: 'dev' After activation: - Python and packages from the activated environment are available in PATH - All subsequent steps use this environment - You can run pixi run -e <env> to run commands in other environments cache Controls whether to cache the pixi environments directory ( .pixi ) for faster CI runs. Default: 'false' - No caching by default to ensure clean environments unless explicitly requested. When 'true' : - Caches the .pixi directory based on pixi.lock hash - Cache is only written on push events to the main branch - Significantly speeds up subsequent CI runs (from minutes to seconds) - Requires pixi.lock file - will fail with a clear error if missing Cache key structure : pixi-<hash-of-pixi.lock> Cache write behavior : Only writes cache when: - cache: 'true' is set - Event is push (not PR) - Branch is main Example: # Enable caching (recommended for production) cache: 'true' # Disable caching (useful for debugging) cache: 'false' verify-lock Controls lock file verification behavior and pixi installation mode. Default: 'true' - Always verify lock file is up to date. When 'true' (locked mode) : - Uses pixi install --locked - Verifies that pixi.lock matches pyproject.toml - Fails if lock file is outdated - prevents installing mismatched dependencies - Recommended for CI/CD to catch lock file drift When 'false' (frozen mode) : - Uses pixi install --frozen - Uses lock file as-is without verification - Faster but won't catch outdated lock files - Useful when you're certain the lock file is correct Example: # Verify lock file (default, recommended for CI) verify-lock: 'true' # Skip verification (faster, use cautiously) verify-lock: 'false' Features 1. Automatic Lock File Validation The action always requires a pixi.lock file to be present in your repository. This ensures reproducible builds across all environments. What happens: 1. \u2705 Checks if pixi.lock exists 2. \u274c Fails with a clear error message if missing 3. \ud83d\udcdd Provides instructions on how to generate the lock file locally Error message when lock file is missing: \u274c pixi.lock file does not exist! To fix this issue: Run 'pixi install' locally to generate pixi.lock and commit it to your repository This action requires a committed lock file and will never generate it in CI. Why this design? - Lock files should be generated on the developer's machine, not in CI - Ensures all developers and CI use the same dependency versions - Prevents CI from making commits or masking dependency conflicts - Makes dependency updates explicit and reviewable 2. Dual Mode Installation: Locked vs Frozen The action supports two installation modes controlled by the verify-lock input: Locked Mode ( verify-lock: 'true' - default): pixi install --locked Verifies pixi.lock matches pyproject.toml Fails if dependencies were added/removed without updating lock file Best for : CI/CD pipelines, ensuring strict reproducibility Frozen Mode ( verify-lock: 'false' ): pixi install --frozen Uses pixi.lock without verification Faster but won't detect lock file drift Best for : Local development, trusted environments Comparison: Mode Flag Verifies Lock Speed Use Case Locked --locked \u2705 Yes Slower CI/CD, production Frozen --frozen \u274c No Faster Development, trusted deploys 3. Environment Information Logging After installation, the action automatically logs environment information: Pixi Information: Active environment: dev Available environments: - default - dev - test - prod Installed Packages: Installed packages summary: python 3.11.7 numpy 1.26.2 pandas 2.1.4 pytest 7.4.3 ... This appears in collapsible sections in GitHub Actions logs for easy debugging. 4. Intelligent Caching When cache: 'true' is enabled: Cache Behavior: - Key : pixi-<hash(pixi.lock)> - Cached : .pixi/ directory (all environments) - Write : Only on push to main branch - Read : All runs (including PRs) Performance Impact: - \ud83d\udc0c First run: ~5-10 minutes (install all packages) - \ud83d\ude80 Cached run: ~30 seconds (restore cache + verification) Cache Invalidation: - Automatic when pixi.lock changes - Manual: bump version in pyproject.toml or clear GitHub cache 5. Cross-Platform Support The action works seamlessly across: - \ud83d\udc27 Linux (ubuntu-latest) - \ud83c\udf4e macOS (macos-latest, macos-13, macos-14) - \ud83e\ude9f Windows (windows-latest) Shell commands automatically adapt to the platform (bash on Linux/macOS, PowerShell on Windows). 6. Multiple Environment Management Install and manage multiple environments in a single workflow: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'py311 py312 py313' activate-environment: 'py311' # py311 is active by default - run: python --version # Python 3.11 # Switch to another environment for specific commands - run: pixi run -e py312 python --version # Python 3.12 - run: pixi run -e py313 pytest # Run tests in Python 3.13 Usage Scenarios Basic Setup Scenario : Simple project with a single environment. pyproject.toml : [project] name = \"my-project\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" numpy = \">=1.26\" pytest = \">=7.0\" Workflow: name: Test on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup Python with pixi uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' - name: Run tests run: pytest - name: Verify installation run: | python --version python -c \"import numpy; print(f'NumPy {numpy.__version__}')\" Result : Default environment is installed and activated, all packages available. Multiple Environments Scenario : Project with separate development and production environments. pyproject.toml : [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" [tool.pixi.feature.core.dependencies] numpy = \">=1.26\" pandas = \">=2.0\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" ruff = \">=0.1\" [tool.pixi.feature.prod.dependencies] gunicorn = \">=21.0\" [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev\"] prod = [\"core\", \"prod\"] Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup dev environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev' activate-environment: 'dev' cache: 'false' - name: Run linting run: | black --check . ruff check . - name: Run tests run: pytest deploy-check: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup prod environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'prod' activate-environment: 'prod' cache: 'false' - name: Verify prod dependencies run: | python -c \"import gunicorn\" python -c \"import numpy, pandas\" Result : Different jobs use different environments with appropriate dependencies. Environment Activation Scenario : Install multiple environments but work primarily in one. pyproject.toml : [tool.pixi.feature.core.dependencies] python = \">=3.11\" requests = \">=2.31\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" [tool.pixi.feature.test.dependencies] pytest = \">=7.0\" pytest-cov = \">=4.0\" hypothesis = \">=6.0\" [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev\"] test = [\"core\", \"test\"] Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup all environments uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev test' activate-environment: 'dev' # Dev is active by default cache: 'false' - name: Run linting (uses active dev environment) run: black --check . - name: Run tests (switch to test environment) run: pixi run -e test pytest --cov - name: Check coverage (in test environment) run: pixi run -e test coverage report Result : Multiple environments available, explicit control over which is active. Matrix Testing Scenario : Test across multiple Python versions or OS combinations. pyproject.toml : [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" [tool.pixi.feature.py311.dependencies] python = \"3.11.*\" pandas = \">=2.0\" [tool.pixi.feature.py312.dependencies] python = \"3.12.*\" scikit-learn = \">=1.3\" [tool.pixi.environments] default = [] py311 = [\"py311\"] py312 = [\"py312\"] Workflow: jobs: test-matrix: name: Test Python ${{ matrix.python-env }} on ${{ matrix.os }} strategy: matrix: os: [ubuntu-latest, windows-latest, macos-latest] python-env: ['py311', 'py312'] runs-on: ${{ matrix.os }} steps: - uses: actions/checkout@v5 - name: Setup Python environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: ${{ matrix.python-env }} activate-environment: ${{ matrix.python-env }} cache: 'false' - name: Run tests run: | python --version pytest Result : Tests run on 6 combinations (3 OS \u00d7 2 Python versions), each with correct environment. Complex Projects with Features Scenario : Large project with multiple feature sets (ML, visualization, development tools). pyproject.toml : [project] name = \"complex-ml-project\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\", \"pytorch\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.tasks] test = \"pytest tests/\" lint = \"ruff check .\" train = \"python scripts/train.py\" [tool.pixi.dependencies] python = \">=3.11,<3.13\" [tool.pixi.feature.core.dependencies] numpy = \">=1.26\" pandas = \">=2.0\" scipy = \">=1.11\" [tool.pixi.feature.ml.dependencies] scikit-learn = \">=1.3\" xgboost = \">=2.0\" pytorch = \">=2.0\" [tool.pixi.feature.viz.dependencies] matplotlib = \">=3.8\" seaborn = \">=0.13\" plotly = \">=5.18\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" pytest-cov = \">=4.0\" black = \">=23.0\" ruff = \">=0.1\" mypy = \">=1.0\" [tool.pixi.environments] default = [\"core\", \"dev\"] ml = [\"core\", \"ml\", \"viz\", \"dev\"] prod = [\"core\", \"ml\"] ci = [\"core\", \"ml\", \"dev\"] Workflow: jobs: lint-and-test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup CI environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'ci' activate-environment: 'ci' cache: 'true' # Enable caching for complex environments - name: Lint code run: | black --check . ruff check . mypy src/ - name: Run tests run: pytest --cov=src tests/ - name: Test ML models run: | python -c \"import sklearn, xgboost, torch\" python scripts/test_model.py train-model: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup ML environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'ml' activate-environment: 'ml' cache: 'true' - name: Train model run: python scripts/train.py - name: Generate visualizations run: python scripts/visualize.py Result : Different jobs use optimized environments with only necessary dependencies. Caching Scenario : Speed up CI by caching the pixi environment. Without Caching Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup Python uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' # No caching - name: Run tests run: pytest Time : ~5-10 minutes per run (full package installation each time) With Caching Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup Python with caching uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' # Enable caching - name: Run tests run: pytest Time : - First run: ~5-10 minutes (installs packages + saves cache) - Subsequent runs: ~30 seconds (restores cache) - After lock file change: ~5-10 minutes (cache miss, rebuilds) Cache behavior: - \u2705 Reads cache : All runs (PRs, pushes, manual) - \u270f\ufe0f Writes cache : Only on push to main branch - \ud83d\udd04 Updates cache : When pixi.lock changes Validation Without Lock File The action will fail if you enable caching without a lock file: Workflow (will fail): - name: Setup Python with caching uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' # \u274c Will fail - no pixi.lock! Error: \u274c Cache is enabled but pixi.lock file does not exist! To fix this issue: First run 'pixi install' locally to generate pixi.lock and then commit it to your repository How to fix: # On your local machine pixi install # Generates pixi.lock git add pixi.lock git commit -m \"Add pixi lock file\" git push Lock File Management Lock File Verification The action implements a lock-file-first approach: Lock file is mandatory : Action fails immediately if pixi.lock doesn't exist Generated locally : Developers run pixi install on their machines Committed to repository : Lock file is version-controlled Verified in CI : Action validates (optionally) that lock matches dependencies Benefits: - \ud83d\udd12 Reproducibility : Everyone uses exact same versions - \ud83d\udc40 Visibility : Lock file changes are reviewable in PRs - \ud83d\udeab No surprises : CI doesn't install different versions than local - \u26a1 Speed : No lock resolution in CI Frozen vs Locked Modes The verify-lock input controls how pixi uses the lock file: Locked Mode ( verify-lock: 'true' - Default) Command used : pixi install --locked Behavior: 1. Reads pixi.lock 2. Compares with pyproject.toml 3. \u274c Fails if mismatch (dependencies added/changed without updating lock) 4. \u2705 Installs exact versions from lock file Use when: - Running CI/CD pipelines - You want strict reproducibility - You want to catch lock file drift Example: - name: Setup with verification uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: verify-lock: 'true' # Default What it catches: # pyproject.toml - added pandas [tool.pixi.dependencies] python = \">=3.11\" numpy = \">=1.26\" pandas = \">=2.0\" # \u26a0\ufe0f NEW! # pixi.lock - doesn't have pandas # \u274c Action fails: \"Lock file is outdated!\" Frozen Mode ( verify-lock: 'false' ) Command used : pixi install --frozen Behavior: 1. Reads pixi.lock 2. Installs exact versions from lock file 3. \u2705 No verification - trusts lock file is correct 4. Faster (skips verification step) Use when: - You're certain the lock file is up to date - You want faster CI runs - Lock file is updated automatically by bots/tools Example: - name: Setup without verification uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: verify-lock: 'false' Warning : Won't catch lock file drift, so use carefully. Comparison Table Aspect Locked Mode Frozen Mode Command --locked --frozen Verifies lock \u2705 Yes \u274c No Fails on drift \u2705 Yes \u274c No Speed Slower (verification) Faster Safety Safer Less safe Best for CI/CD Trusted environments Default \u2705 Yes No When to Use Each Mode Use Locked Mode ( verify-lock: 'true' ) when: - \u2705 Running CI/CD pipelines - \u2705 Multiple contributors updating dependencies - \u2705 You want to enforce lock file updates - \u2705 Security is important (catch unexpected changes) Use Frozen Mode ( verify-lock: 'false' ) when: - \u2705 Lock file is auto-updated (Dependabot, Renovate) - \u2705 Single developer project - \u2705 Speed is critical (many CI runs) - \u2705 You have other verification mechanisms Updating Lock Files Recommended workflow: Update dependencies locally: ```bash # Edit pyproject.toml vim pyproject.toml # Update lock file pixi install # Verify it works pixi run pytest ``` Commit both files: bash git add pyproject.toml pixi.lock git commit -m \"Update numpy to 2.0\" git push CI validates: PR runs with verify-lock: 'true' \u2705 Passes because lock file matches Reviewers see both files changed What NOT to do: # \u274c Don't edit only pyproject.toml without updating lock vim pyproject.toml git add pyproject.toml # Missing pixi.lock! git commit -m \"Update numpy\" # CI will fail with \"Lock file is outdated\" Environment Architecture Understanding Pixi Environments Pixi uses a feature-based system to compose environments: Features \u2192 Environments \u2192 Activation 1. Features (Dependency Groups) Features define groups of related dependencies: [tool.pixi.feature.core.dependencies] python = \">=3.11\" numpy = \">=1.26\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" [tool.pixi.feature.ml.dependencies] scikit-learn = \">=1.3\" pytorch = \">=2.0\" Think of features as: - \ud83d\udce6 Reusable dependency sets - \ud83e\udde9 Building blocks for environments - \ud83c\udfaf Logical groupings (core, dev, ML, viz, etc.) 2. Environments (Feature Combinations) Environments combine multiple features: [tool.pixi.environments] default = [\"core\"] # Just core dev = [\"core\", \"dev\"] # Core + dev tools ml = [\"core\", \"ml\"] # Core + ML packages full = [\"core\", \"dev\", \"ml\"] # Everything Think of environments as: - \ud83c\udfad Different use cases (dev, test, prod) - \ud83d\udd27 Job-specific setups - \ud83d\udcca Matrix test configurations 3. Activation (Runtime Selection) The action installs environments and activates one: environments: 'dev ml' # Installs both activate-environment: 'dev' # Activates dev (adds to PATH) After activation: - \u2705 python \u2192 Python from activated environment - \u2705 pytest \u2192 If in activated environment - \u2705 Package imports work from activated environment - \u274c Packages from other environments not in PATH (but can use pixi run -e ) Environment Lifecycle Step-by-step what happens: Validation : Check pixi.lock exists Installation : Install pixi (if not cached) Lock Check (if verify-lock: 'true' ): Verify lock matches pyproject.toml Environment Creation : Install specified environments bash pixi install --locked # or --frozen # Creates .pixi/envs/dev/, .pixi/envs/ml/, etc. Activation : Add environment to PATH bash # Adds .pixi/envs/dev/bin to PATH Verification : Log environment info Directory Structure After installation, your project looks like: my-project/ \u251c\u2500\u2500 pyproject.toml \u251c\u2500\u2500 pixi.lock \u251c\u2500\u2500 .pixi/ # Created by pixi \u2502 \u251c\u2500\u2500 envs/ \u2502 \u2502 \u251c\u2500\u2500 default/ # Each environment \u2502 \u2502 \u2502 \u251c\u2500\u2500 bin/ \u2502 \u2502 \u2502 \u251c\u2500\u2500 lib/ \u2502 \u2502 \u2502 \u2514\u2500\u2500 ... \u2502 \u2502 \u251c\u2500\u2500 dev/ \u2502 \u2502 \u2502 \u251c\u2500\u2500 bin/ \u2502 \u2502 \u2502 \u2514\u2500\u2500 ... \u2502 \u2502 \u2514\u2500\u2500 ml/ \u2502 \u2502 \u2514\u2500\u2500 ... \u2502 \u2514\u2500\u2500 bin/ \u2502 \u2514\u2500\u2500 pixi # Pixi binary \u251c\u2500\u2500 src/ \u2514\u2500\u2500 tests/ Caching caches : The entire .pixi/ directory Caching Strategy How Caching Works Cache Key : pixi-<hash(pixi.lock)> What's cached : Entire .pixi/ directory containing: - All installed environments - Pixi binary - Package metadata Cache flow: \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Run starts \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Hash pixi.lock \u2502 \u2190 Generate cache key \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Cache \u2502 \u2502 hit? \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518 \u2502 \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 YES NO \u2502 \u2502 \u25bc \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502Restore \u2502 \u2502Install fresh \u2502 \u2502cache \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u25bc \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 Is push to \u2502 \u2502 \u2502 main branch? \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 YES NO \u2502 \u2502 \u2502 \u2502 \u25bc \u25bc \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 Save \u2502 \u2502 Skip \u2502 \u2502 \u2502 cache \u2502 \u2502 save \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Done \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Cache Performance Typical timings: Scenario Time Notes No cache, small project 1-2 min Few packages No cache, large project 5-10 min Many packages (ML libs) Cache hit 20-40 sec Restore + verify Cache miss 5-10 min Full install + save Factors affecting speed: - Number of packages - Package size (pytorch is large!) - Number of environments - Network speed (first install) Cache Invalidation Automatic invalidation when: - \u2705 pixi.lock changes (new hash \u2192 new key) - \u2705 GitHub clears old caches (7 days unused) Manual invalidation: - Clear cache via GitHub UI (Settings \u2192 Actions \u2192 Caches) - Change cache key (modify action or add version to pyproject.toml ) Cache won't invalidate when: - \u274c Only pyproject.toml changes (lock file unchanged) - \u274c Code changes - \u274c Non-dependency configuration changes Cache Best Practices DO: - \u2705 Enable caching for stable projects - \u2705 Use caching in production CI - \u2705 Monitor cache hit rates - \u2705 Include lock file in commits DON'T: - \u274c Enable caching when debugging dependency issues - \u274c Rely on cache without lock file verification - \u274c Cache in fork PRs (limited cache space) Optimal configuration: # Main branch - write cache - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' verify-lock: 'true' # Verify even with cache # PR branches - read cache only (automatic) # Same configuration, but cache-write is disabled automatically Testing Guide This action is comprehensively tested across multiple scenarios to ensure reliability. Reference the test workflow at .github/workflows/test-python-setup-pixi.yml . Test Coverage Matrix Test Job Purpose Key Validations Fixture test-pixi-basic Default behavior Pixi and Python installed, packages available test-pixi-basic/ test-pixi-default-environment Default environment only Only default environment installed test-pixi-default-environment/ test-pixi-multiple-environments Multiple environments Multiple envs installed, correct one activated test-pixi-multiple-environments/ test-pixi-environment-activation Environment activation Specific environment activated correctly test-pixi-environment-activation/ test-pixi-lock-verification-valid Valid lock file Lock verification passes test-pixi-lock-verification-valid/ test-pixi-lock-verification-outdated Outdated lock handling Fails with outdated lock file test-pixi-lock-verification-outdated/ test-pixi-lock-verification-disabled Skip lock check Works with verify-lock: 'false' test-pixi-lock-verification-disabled/ test-pixi-lock-verification-validation Missing lock file Fails without lock file test-pixi-lock-verification-validation/ test-pixi-caching-populate Cache population Cache created and packages installed test-pixi-caching-populate/ test-pixi-caching-retrieve Cache retrieval Cache restored on subsequent runs test-pixi-caching-retrieve/ test-pixi-caching-validation Cache without lock Fails when cache enabled without lock - test-pixi-matrix Cross-platform matrix Works on Linux/Windows/macOS with multiple environments test-pixi-matrix/ test-pixi-error-scenarios Error handling Proper errors for missing lock, wrong environment test-pixi-basic/ test-pixi-complex-project Complex setup Multiple features and environments test-pixi-complex-project/ Test Fixtures Location All test fixtures are located in tests/data/pixi/ directory: tests/data/pixi/ \u251c\u2500\u2500 test-pixi-basic/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-default-environment/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-multiple-environments/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-environment-activation/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-valid/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-outdated/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-disabled/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-validation/ \u2502 \u2514\u2500\u2500 pyproject.toml # No lock file (intentional) \u251c\u2500\u2500 test-pixi-caching-populate/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-caching-retrieve/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-matrix/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u2514\u2500\u2500 test-pixi-complex-project/ \u251c\u2500\u2500 pyproject.toml \u2514\u2500\u2500 pixi.lock Example Test Fixtures test-pixi-basic/pyproject.toml: [project] name = \"test-pixi-basic\" version = \"0.1.0\" dependencies = [] [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" numpy = \">=1.26\" pytest = \">=7.0\" test-pixi-multiple-environments/pyproject.toml: [project] name = \"test-multi-env\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.feature.core.dependencies] python = \">=3.11\" numpy = \">=1.26\" [tool.pixi.feature.py311.dependencies] python = \"3.11.*\" pandas = \">=2.0\" [tool.pixi.feature.py312.dependencies] python = \"3.12.*\" pandas = \">=2.0\" [tool.pixi.environments] default = [\"core\"] py311 = [\"core\", \"py311\"] py312 = [\"core\", \"py312\"] test-pixi-complex-project/pyproject.toml: [project] name = \"test-complex\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.feature.core.dependencies] python = \">=3.11\" requests = \">=2.31\" [tool.pixi.feature.ml.dependencies] numpy = \">=1.26\" scikit-learn = \">=1.3\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" [tool.pixi.environments] default = [\"core\", \"dev\"] ml = [\"core\", \"ml\", \"dev\"] prod = [\"core\", \"ml\"] Basic Test Setup name: Tests on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' - run: pytest tests/ Matrix Testing: Multiple Python Versions jobs: test: strategy: matrix: python-env: ['py310', 'py311', 'py312'] runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: ${{ matrix.python-env }} activate-environment: ${{ matrix.python-env }} cache: 'false' - run: pytest Matrix Testing: Multiple Operating Systems jobs: test: strategy: matrix: os: [ubuntu-latest, macos-latest, windows-latest] runs-on: ${{ matrix.os }} steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' - run: pytest Matrix Testing: Combined jobs: test: strategy: matrix: os: [ubuntu-latest, macos-latest, windows-latest] python-env: ['py311', 'py312'] runs-on: ${{ matrix.os }} steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: ${{ matrix.python-env }} activate-environment: ${{ matrix.python-env }} cache: 'false' - run: pytest Testing Multiple Environments in One Job jobs: test-all: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev test' activate-environment: 'dev' cache: 'false' - name: Lint with dev environment run: | black --check . ruff check . - name: Test with test environment run: pixi run -e test pytest --cov Lock File Verification Tests Test Valid Lock File jobs: test-valid-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: verify-lock: 'true' # Should pass cache: 'false' - run: pytest Test Outdated Lock File (Should Fail) jobs: test-outdated-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 # Modify pyproject.toml to make lock outdated - run: | echo \"\" >> pyproject.toml echo \"[tool.pixi.dependencies]\" >> pyproject.toml echo \"newpackage = \\\">=1.0\\\"\" >> pyproject.toml - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 id: setup continue-on-error: true with: verify-lock: 'true' # Should fail cache: 'false' - name: Verify it failed if: steps.setup.outcome != 'failure' run: | echo \"ERROR: Should have failed with outdated lock\" exit 1 Test Without Lock File (Should Fail) jobs: test-no-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - run: rm pixi.lock # Remove lock file - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 id: setup continue-on-error: true with: cache: 'false' - name: Verify it failed if: steps.setup.outcome != 'failure' run: | echo \"ERROR: Should have failed without lock file\" exit 1 Caching Tests Test Cache Population jobs: cache-populate: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' - run: pytest Test Cache Retrieval jobs: cache-populate: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' - run: pytest cache-retrieve: runs-on: ubuntu-latest needs: cache-populate steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 id: setup with: cache: 'true' # Second run should be much faster - run: pytest Troubleshooting Common Issues Issue: \"pixi.lock file does not exist\" Error message: \u274c pixi.lock file does not exist! To fix this issue: Run 'pixi install' locally to generate pixi.lock and commit it to your repository Solution: # On your local machine pixi install git add pixi.lock git commit -m \"Add pixi lock file\" git push Issue: \"Lock file is outdated\" Error message: The pixi.lock file is outdated. Please run `pixi install` to update it. Cause: You modified pyproject.toml without updating the lock file. Solution: # Update lock file pixi install # Commit both files git add pyproject.toml pixi.lock git commit -m \"Update dependencies\" git push Issue: Cache not working Symptoms: Every run takes 5-10 minutes even with cache: 'true' Possible causes: Lock file keeps changing: bash # Check if lock file is in .gitignore git check-ignore pixi.lock # Should output nothing (not ignored) Running on PR from fork: Forks have limited cache access This is a GitHub limitation Cache was cleared: Check GitHub Actions \u2192 Caches Old caches are auto-deleted after 7 days Solution: - Ensure pixi.lock is committed - Check cache hit/miss in logs - For fork PRs, accept slower runs Issue: \"Environment not found\" Error message: Error: Environment 'ml' not found Cause: Trying to activate an environment that doesn't exist in pyproject.toml or wasn't installed. Solution: # Wrong with: environments: 'dev' activate-environment: 'ml' # \u274c ml not installed! # Correct with: environments: 'dev ml' # \u2705 Install both activate-environment: 'ml' # \u2705 Now can activate ml Issue: Package not found after setup Symptoms: ModuleNotFoundError: No module named 'numpy' even though it's in pyproject.toml Possible causes: Wrong environment activated: ```yaml # Package is in 'ml' environment but 'dev' is active with: environments: 'dev ml' activate-environment: 'dev' # numpy might not be here run: python -c \"import numpy\" # \u274c Fails ``` Package in wrong feature: Check your pyproject.toml environment definitions Solution: # Check which environment has the package pixi list -e dev | grep numpy pixi list -e ml | grep numpy # Either switch environment or add package to current environment Issue: Different versions locally vs CI Symptoms: Works locally but fails in CI (or vice versa) Cause: Lock file not synchronized Solution: # Regenerate lock file locally rm pixi.lock pixi install # Commit and push git add pixi.lock git commit -m \"Regenerate lock file\" git push Issue: Windows-specific path issues Symptoms: Works on Linux/Mac but fails on Windows Cause: Path separators or shell-specific commands Solution: # Use pixi tasks instead of shell commands # In pyproject.toml: [tool.pixi.tasks] test = \"pytest tests/\" # In workflow: - run: pixi run test # Cross-platform! Issue: Slow installation even with cache Symptoms: Cache hits but still takes 2-3 minutes Cause: Lock verification and environment activation take time Solution: # For trusted environments, disable verification with: cache: 'true' verify-lock: 'false' # Faster but less safe Debug Mode To get more information about what's happening: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' # Add debug steps - name: Debug environment info run: | echo \"Pixi version:\" pixi --version echo \"Available environments:\" pixi info echo \"Active Python:\" which python python --version echo \"Installed packages:\" pixi list echo \"PATH:\" echo $PATH Best Practices 1. Always Commit Lock Files \u2705 DO: git add pyproject.toml pixi.lock git commit -m \"Update numpy to 2.0\" \u274c DON'T: git add pyproject.toml # Missing pixi.lock - CI will fail! 2. Use Locked Mode in CI \u2705 DO: with: verify-lock: 'true' # Catch drift \u274c DON'T: with: verify-lock: 'false' # Silent failures Exception: Disable when lock is auto-updated by bots 3. Enable Caching for Stable Projects \u2705 DO: # Stable project with infrequent dependency changes with: cache: 'true' \u274c DON'T: # When debugging dependency issues with: cache: 'true' # Cache might mask issues 4. Use Minimal Environments \u2705 DO: # Install only what you need jobs: lint: steps: - uses: .../pixi@v1 with: environments: 'dev' # Just linting tools test: steps: - uses: .../pixi@v1 with: environments: 'test' # Just test deps \u274c DON'T: # Install everything everywhere jobs: lint: steps: - uses: .../pixi@v1 with: environments: 'dev test ml viz' # Overkill! 5. One Environment Activation Per Job \u2705 DO: - uses: .../pixi@v1 with: environments: 'dev' activate-environment: 'dev' # All subsequent steps use dev environment \u274c DON'T: # Trying to activate multiple environments (not possible) - uses: .../pixi@v1 with: activate-environment: 'dev' - uses: .../pixi@v1 # \u274c Second activation with: activate-environment: 'test' If you need multiple environments , use pixi run -e : - uses: .../pixi@v1 with: environments: 'dev test' activate-environment: 'dev' - run: black --check . # Uses dev - run: pixi run -e test pytest # Uses test 6. Organize Dependencies by Purpose \u2705 DO: [tool.pixi.feature.core.dependencies] # Core runtime dependencies numpy = \">=1.26\" pandas = \">=2.0\" [tool.pixi.feature.dev.dependencies] # Development tools black = \">=23.0\" ruff = \">=0.1\" [tool.pixi.feature.test.dependencies] # Testing tools pytest = \">=7.0\" pytest-cov = \">=4.0\" [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev\"] ci = [\"core\", \"test\"] \u274c DON'T: [tool.pixi.dependencies] # Everything in one place numpy = \">=1.26\" pandas = \">=2.0\" black = \">=23.0\" pytest = \">=7.0\" # No organization! 7. Use Descriptive Environment Names \u2705 DO: [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev-tools\"] test-py311 = [\"core\", \"test\", \"py311\"] test-py312 = [\"core\", \"test\", \"py312\"] prod = [\"core\"] \u274c DON'T: [tool.pixi.environments] env1 = [\"core\"] env2 = [\"core\", \"dev\"] myenv = [\"core\", \"test\"] 8. Document Environment Purpose \u2705 DO: [tool.pixi.environments] # Core dependencies only - minimal install default = [\"core\"] # Development environment - includes linting and formatting tools dev = [\"core\", \"dev-tools\"] # CI testing environment - includes test runners and coverage ci = [\"core\", \"test\"] # Production environment - runtime dependencies only prod = [\"core\"] 9. Pin Major Python Version \u2705 DO: [tool.pixi.dependencies] python = \">=3.11,<3.13\" # Explicit range \u274c DON'T: [tool.pixi.dependencies] python = \">=3.11\" # Too permissive 10. Test Lock File Verification in CI \u2705 DO: jobs: validate-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: .../pixi@v1 with: verify-lock: 'true' # Enforce verification cache: 'false' This catches PRs with outdated lock files early. Migration Guide From setup-python + pip Before (pip): - uses: actions/setup-python@v5 with: python-version: '3.11' cache: 'pip' - run: pip install -r requirements.txt After (pixi): - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' Migration steps: 1. Create pyproject.toml with pixi configuration 2. Run pixi install locally to generate pixi.lock 3. Commit both files 4. Update workflow to use pixi action From setup-python + conda Before (conda): - uses: conda-incubator/setup-miniconda@v3 with: python-version: '3.11' environment-file: environment.yml After (pixi): - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' Migration steps: 1. Convert environment.yml to pyproject.toml pixi format 2. Run pixi install to generate lock file 3. Commit files 4. Update workflow From mamba-org/setup-micromamba Before (micromamba): - uses: mamba-org/setup-micromamba@v1 with: environment-file: environment.yml cache-environment: true After (pixi): - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' Pixi is faster than micromamba and has better lock file support! Additional Resources Pixi Documentation : https://prefix.dev/docs/pixi Pixi GitHub : https://github.com/prefix-dev/pixi Conda-forge : https://conda-forge.org/ Action Source : Serapieum-of-alex/github-actions/actions/python-setup/pixi Examples Repository See the test suite for comprehensive examples: - .github/workflows/test-python-setup-pixi.yml - All test scenarios - tests/data/pixi/ - Example configurations Support For issues or questions: 1. Check Troubleshooting 2. Review test examples 3. Open an issue in the repository Version : 1.0.0 Last Updated : January 2026 Compatibility : Linux, macOS, Windows Pixi Version : v0.49.0","title":"Pixi"},{"location":"pytho-setup/pixi/#table-of-contents","text":"Overview Quick Start Inputs Reference Features Usage Scenarios Basic Setup Multiple Environments Environment Activation Matrix Testing Complex Projects with Features Caching Lock File Management Lock File Verification Frozen vs Locked Modes Environment Architecture Caching Strategy Testing Guide Troubleshooting Best Practices","title":"Table of Contents"},{"location":"pytho-setup/pixi/#overview","text":"This action provides a complete Python environment setup using pixi , a fast package manager built on top of conda. It automatically: Installs pixi package manager Validates lock file existence Sets up one or more pixi environments Activates a specified environment Optionally caches environments for faster CI runs Verifies lock file integrity (configurable) Key Features: - \u2705 Support for conda-forge and other conda channels - \u2705 Cross-platform compatibility (Linux, macOS, Windows) - \u2705 Multiple environment support - \u2705 Feature-based dependency management - \u2705 Intelligent caching with lock file validation - \u2705 Lock file verification modes (locked/frozen) Location : Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1","title":"Overview"},{"location":"pytho-setup/pixi/#quick-start","text":"","title":"Quick Start"},{"location":"pytho-setup/pixi/#basic-usage-default-environment","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 # The default environment is automatically activated! - run: python --version - run: pytest","title":"Basic Usage (Default Environment)"},{"location":"pytho-setup/pixi/#with-multiple-environments","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev test prod' activate-environment: 'dev' - run: pytest # Runs in dev environment","title":"With Multiple Environments"},{"location":"pytho-setup/pixi/#with-caching-enabled","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' - run: python --version # Much faster on subsequent runs!","title":"With Caching Enabled"},{"location":"pytho-setup/pixi/#inputs-reference","text":"Input Description Required Default Valid Values environments Pixi environments to install No 'default' Space-separated list (e.g., 'py311' , 'dev test prod' ) activate-environment Environment to activate after installation No 'default' Any environment name from your pyproject.toml cache Enable caching of pixi environments No 'false' 'true' , 'false' verify-lock Verify lock file is up to date No 'true' 'true' , 'false'","title":"Inputs Reference"},{"location":"pytho-setup/pixi/#input-details","text":"","title":"Input Details"},{"location":"pytho-setup/pixi/#environments","text":"Specifies which pixi environments from [tool.pixi.environments] in pyproject.toml to install. Default behavior ( 'default' ) : Installs only the default environment. When specified : Installs all specified environments. This is useful when you need to prepare multiple environments or when running matrix tests. Formats supported: - Single environment: 'dev' - Space-separated: 'dev test prod' - Multiple runs: You can call the action multiple times with different environments (though not recommended - see best practices) Example pyproject.toml : [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev-tools\"] test = [\"core\", \"test-tools\"] prod = [\"core\"] Usage: # Install only dev environment environments: 'dev' # Install dev and test environments environments: 'dev test' # Install all environments environments: 'default dev test prod'","title":"environments"},{"location":"pytho-setup/pixi/#activate-environment","text":"Specifies which environment to activate in the GitHub Actions PATH after installation. Default behavior ( 'default' ) : Activates the default environment. Important : This should be ONE of the environments listed in the environments input. If you specify an environment that wasn't installed, the action will fail. Example: # Install multiple environments but activate only 'dev' with: environments: 'dev test prod' activate-environment: 'dev' After activation: - Python and packages from the activated environment are available in PATH - All subsequent steps use this environment - You can run pixi run -e <env> to run commands in other environments","title":"activate-environment"},{"location":"pytho-setup/pixi/#cache","text":"Controls whether to cache the pixi environments directory ( .pixi ) for faster CI runs. Default: 'false' - No caching by default to ensure clean environments unless explicitly requested. When 'true' : - Caches the .pixi directory based on pixi.lock hash - Cache is only written on push events to the main branch - Significantly speeds up subsequent CI runs (from minutes to seconds) - Requires pixi.lock file - will fail with a clear error if missing Cache key structure : pixi-<hash-of-pixi.lock> Cache write behavior : Only writes cache when: - cache: 'true' is set - Event is push (not PR) - Branch is main Example: # Enable caching (recommended for production) cache: 'true' # Disable caching (useful for debugging) cache: 'false'","title":"cache"},{"location":"pytho-setup/pixi/#verify-lock","text":"Controls lock file verification behavior and pixi installation mode. Default: 'true' - Always verify lock file is up to date. When 'true' (locked mode) : - Uses pixi install --locked - Verifies that pixi.lock matches pyproject.toml - Fails if lock file is outdated - prevents installing mismatched dependencies - Recommended for CI/CD to catch lock file drift When 'false' (frozen mode) : - Uses pixi install --frozen - Uses lock file as-is without verification - Faster but won't catch outdated lock files - Useful when you're certain the lock file is correct Example: # Verify lock file (default, recommended for CI) verify-lock: 'true' # Skip verification (faster, use cautiously) verify-lock: 'false'","title":"verify-lock"},{"location":"pytho-setup/pixi/#features","text":"","title":"Features"},{"location":"pytho-setup/pixi/#1-automatic-lock-file-validation","text":"The action always requires a pixi.lock file to be present in your repository. This ensures reproducible builds across all environments. What happens: 1. \u2705 Checks if pixi.lock exists 2. \u274c Fails with a clear error message if missing 3. \ud83d\udcdd Provides instructions on how to generate the lock file locally Error message when lock file is missing: \u274c pixi.lock file does not exist! To fix this issue: Run 'pixi install' locally to generate pixi.lock and commit it to your repository This action requires a committed lock file and will never generate it in CI. Why this design? - Lock files should be generated on the developer's machine, not in CI - Ensures all developers and CI use the same dependency versions - Prevents CI from making commits or masking dependency conflicts - Makes dependency updates explicit and reviewable","title":"1. Automatic Lock File Validation"},{"location":"pytho-setup/pixi/#2-dual-mode-installation-locked-vs-frozen","text":"The action supports two installation modes controlled by the verify-lock input: Locked Mode ( verify-lock: 'true' - default): pixi install --locked Verifies pixi.lock matches pyproject.toml Fails if dependencies were added/removed without updating lock file Best for : CI/CD pipelines, ensuring strict reproducibility Frozen Mode ( verify-lock: 'false' ): pixi install --frozen Uses pixi.lock without verification Faster but won't detect lock file drift Best for : Local development, trusted environments Comparison: Mode Flag Verifies Lock Speed Use Case Locked --locked \u2705 Yes Slower CI/CD, production Frozen --frozen \u274c No Faster Development, trusted deploys","title":"2. Dual Mode Installation: Locked vs Frozen"},{"location":"pytho-setup/pixi/#3-environment-information-logging","text":"After installation, the action automatically logs environment information: Pixi Information: Active environment: dev Available environments: - default - dev - test - prod Installed Packages: Installed packages summary: python 3.11.7 numpy 1.26.2 pandas 2.1.4 pytest 7.4.3 ... This appears in collapsible sections in GitHub Actions logs for easy debugging.","title":"3. Environment Information Logging"},{"location":"pytho-setup/pixi/#4-intelligent-caching","text":"When cache: 'true' is enabled: Cache Behavior: - Key : pixi-<hash(pixi.lock)> - Cached : .pixi/ directory (all environments) - Write : Only on push to main branch - Read : All runs (including PRs) Performance Impact: - \ud83d\udc0c First run: ~5-10 minutes (install all packages) - \ud83d\ude80 Cached run: ~30 seconds (restore cache + verification) Cache Invalidation: - Automatic when pixi.lock changes - Manual: bump version in pyproject.toml or clear GitHub cache","title":"4. Intelligent Caching"},{"location":"pytho-setup/pixi/#5-cross-platform-support","text":"The action works seamlessly across: - \ud83d\udc27 Linux (ubuntu-latest) - \ud83c\udf4e macOS (macos-latest, macos-13, macos-14) - \ud83e\ude9f Windows (windows-latest) Shell commands automatically adapt to the platform (bash on Linux/macOS, PowerShell on Windows).","title":"5. Cross-Platform Support"},{"location":"pytho-setup/pixi/#6-multiple-environment-management","text":"Install and manage multiple environments in a single workflow: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'py311 py312 py313' activate-environment: 'py311' # py311 is active by default - run: python --version # Python 3.11 # Switch to another environment for specific commands - run: pixi run -e py312 python --version # Python 3.12 - run: pixi run -e py313 pytest # Run tests in Python 3.13","title":"6. Multiple Environment Management"},{"location":"pytho-setup/pixi/#usage-scenarios","text":"","title":"Usage Scenarios"},{"location":"pytho-setup/pixi/#basic-setup","text":"Scenario : Simple project with a single environment. pyproject.toml : [project] name = \"my-project\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" numpy = \">=1.26\" pytest = \">=7.0\" Workflow: name: Test on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup Python with pixi uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' - name: Run tests run: pytest - name: Verify installation run: | python --version python -c \"import numpy; print(f'NumPy {numpy.__version__}')\" Result : Default environment is installed and activated, all packages available.","title":"Basic Setup"},{"location":"pytho-setup/pixi/#multiple-environments","text":"Scenario : Project with separate development and production environments. pyproject.toml : [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" [tool.pixi.feature.core.dependencies] numpy = \">=1.26\" pandas = \">=2.0\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" ruff = \">=0.1\" [tool.pixi.feature.prod.dependencies] gunicorn = \">=21.0\" [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev\"] prod = [\"core\", \"prod\"] Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup dev environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev' activate-environment: 'dev' cache: 'false' - name: Run linting run: | black --check . ruff check . - name: Run tests run: pytest deploy-check: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup prod environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'prod' activate-environment: 'prod' cache: 'false' - name: Verify prod dependencies run: | python -c \"import gunicorn\" python -c \"import numpy, pandas\" Result : Different jobs use different environments with appropriate dependencies.","title":"Multiple Environments"},{"location":"pytho-setup/pixi/#environment-activation","text":"Scenario : Install multiple environments but work primarily in one. pyproject.toml : [tool.pixi.feature.core.dependencies] python = \">=3.11\" requests = \">=2.31\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" [tool.pixi.feature.test.dependencies] pytest = \">=7.0\" pytest-cov = \">=4.0\" hypothesis = \">=6.0\" [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev\"] test = [\"core\", \"test\"] Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup all environments uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev test' activate-environment: 'dev' # Dev is active by default cache: 'false' - name: Run linting (uses active dev environment) run: black --check . - name: Run tests (switch to test environment) run: pixi run -e test pytest --cov - name: Check coverage (in test environment) run: pixi run -e test coverage report Result : Multiple environments available, explicit control over which is active.","title":"Environment Activation"},{"location":"pytho-setup/pixi/#matrix-testing","text":"Scenario : Test across multiple Python versions or OS combinations. pyproject.toml : [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" [tool.pixi.feature.py311.dependencies] python = \"3.11.*\" pandas = \">=2.0\" [tool.pixi.feature.py312.dependencies] python = \"3.12.*\" scikit-learn = \">=1.3\" [tool.pixi.environments] default = [] py311 = [\"py311\"] py312 = [\"py312\"] Workflow: jobs: test-matrix: name: Test Python ${{ matrix.python-env }} on ${{ matrix.os }} strategy: matrix: os: [ubuntu-latest, windows-latest, macos-latest] python-env: ['py311', 'py312'] runs-on: ${{ matrix.os }} steps: - uses: actions/checkout@v5 - name: Setup Python environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: ${{ matrix.python-env }} activate-environment: ${{ matrix.python-env }} cache: 'false' - name: Run tests run: | python --version pytest Result : Tests run on 6 combinations (3 OS \u00d7 2 Python versions), each with correct environment.","title":"Matrix Testing"},{"location":"pytho-setup/pixi/#complex-projects-with-features","text":"Scenario : Large project with multiple feature sets (ML, visualization, development tools). pyproject.toml : [project] name = \"complex-ml-project\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\", \"pytorch\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.tasks] test = \"pytest tests/\" lint = \"ruff check .\" train = \"python scripts/train.py\" [tool.pixi.dependencies] python = \">=3.11,<3.13\" [tool.pixi.feature.core.dependencies] numpy = \">=1.26\" pandas = \">=2.0\" scipy = \">=1.11\" [tool.pixi.feature.ml.dependencies] scikit-learn = \">=1.3\" xgboost = \">=2.0\" pytorch = \">=2.0\" [tool.pixi.feature.viz.dependencies] matplotlib = \">=3.8\" seaborn = \">=0.13\" plotly = \">=5.18\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" pytest-cov = \">=4.0\" black = \">=23.0\" ruff = \">=0.1\" mypy = \">=1.0\" [tool.pixi.environments] default = [\"core\", \"dev\"] ml = [\"core\", \"ml\", \"viz\", \"dev\"] prod = [\"core\", \"ml\"] ci = [\"core\", \"ml\", \"dev\"] Workflow: jobs: lint-and-test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup CI environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'ci' activate-environment: 'ci' cache: 'true' # Enable caching for complex environments - name: Lint code run: | black --check . ruff check . mypy src/ - name: Run tests run: pytest --cov=src tests/ - name: Test ML models run: | python -c \"import sklearn, xgboost, torch\" python scripts/test_model.py train-model: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup ML environment uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'ml' activate-environment: 'ml' cache: 'true' - name: Train model run: python scripts/train.py - name: Generate visualizations run: python scripts/visualize.py Result : Different jobs use optimized environments with only necessary dependencies.","title":"Complex Projects with Features"},{"location":"pytho-setup/pixi/#caching","text":"Scenario : Speed up CI by caching the pixi environment.","title":"Caching"},{"location":"pytho-setup/pixi/#without-caching","text":"Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup Python uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' # No caching - name: Run tests run: pytest Time : ~5-10 minutes per run (full package installation each time)","title":"Without Caching"},{"location":"pytho-setup/pixi/#with-caching","text":"Workflow: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Setup Python with caching uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' # Enable caching - name: Run tests run: pytest Time : - First run: ~5-10 minutes (installs packages + saves cache) - Subsequent runs: ~30 seconds (restores cache) - After lock file change: ~5-10 minutes (cache miss, rebuilds) Cache behavior: - \u2705 Reads cache : All runs (PRs, pushes, manual) - \u270f\ufe0f Writes cache : Only on push to main branch - \ud83d\udd04 Updates cache : When pixi.lock changes","title":"With Caching"},{"location":"pytho-setup/pixi/#validation-without-lock-file","text":"The action will fail if you enable caching without a lock file: Workflow (will fail): - name: Setup Python with caching uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' # \u274c Will fail - no pixi.lock! Error: \u274c Cache is enabled but pixi.lock file does not exist! To fix this issue: First run 'pixi install' locally to generate pixi.lock and then commit it to your repository How to fix: # On your local machine pixi install # Generates pixi.lock git add pixi.lock git commit -m \"Add pixi lock file\" git push","title":"Validation Without Lock File"},{"location":"pytho-setup/pixi/#lock-file-management","text":"","title":"Lock File Management"},{"location":"pytho-setup/pixi/#lock-file-verification","text":"The action implements a lock-file-first approach: Lock file is mandatory : Action fails immediately if pixi.lock doesn't exist Generated locally : Developers run pixi install on their machines Committed to repository : Lock file is version-controlled Verified in CI : Action validates (optionally) that lock matches dependencies Benefits: - \ud83d\udd12 Reproducibility : Everyone uses exact same versions - \ud83d\udc40 Visibility : Lock file changes are reviewable in PRs - \ud83d\udeab No surprises : CI doesn't install different versions than local - \u26a1 Speed : No lock resolution in CI","title":"Lock File Verification"},{"location":"pytho-setup/pixi/#frozen-vs-locked-modes","text":"The verify-lock input controls how pixi uses the lock file:","title":"Frozen vs Locked Modes"},{"location":"pytho-setup/pixi/#locked-mode-verify-lock-true-default","text":"Command used : pixi install --locked Behavior: 1. Reads pixi.lock 2. Compares with pyproject.toml 3. \u274c Fails if mismatch (dependencies added/changed without updating lock) 4. \u2705 Installs exact versions from lock file Use when: - Running CI/CD pipelines - You want strict reproducibility - You want to catch lock file drift Example: - name: Setup with verification uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: verify-lock: 'true' # Default What it catches: # pyproject.toml - added pandas [tool.pixi.dependencies] python = \">=3.11\" numpy = \">=1.26\" pandas = \">=2.0\" # \u26a0\ufe0f NEW! # pixi.lock - doesn't have pandas # \u274c Action fails: \"Lock file is outdated!\"","title":"Locked Mode (verify-lock: 'true' - Default)"},{"location":"pytho-setup/pixi/#frozen-mode-verify-lock-false","text":"Command used : pixi install --frozen Behavior: 1. Reads pixi.lock 2. Installs exact versions from lock file 3. \u2705 No verification - trusts lock file is correct 4. Faster (skips verification step) Use when: - You're certain the lock file is up to date - You want faster CI runs - Lock file is updated automatically by bots/tools Example: - name: Setup without verification uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: verify-lock: 'false' Warning : Won't catch lock file drift, so use carefully.","title":"Frozen Mode (verify-lock: 'false')"},{"location":"pytho-setup/pixi/#comparison-table","text":"Aspect Locked Mode Frozen Mode Command --locked --frozen Verifies lock \u2705 Yes \u274c No Fails on drift \u2705 Yes \u274c No Speed Slower (verification) Faster Safety Safer Less safe Best for CI/CD Trusted environments Default \u2705 Yes No","title":"Comparison Table"},{"location":"pytho-setup/pixi/#when-to-use-each-mode","text":"Use Locked Mode ( verify-lock: 'true' ) when: - \u2705 Running CI/CD pipelines - \u2705 Multiple contributors updating dependencies - \u2705 You want to enforce lock file updates - \u2705 Security is important (catch unexpected changes) Use Frozen Mode ( verify-lock: 'false' ) when: - \u2705 Lock file is auto-updated (Dependabot, Renovate) - \u2705 Single developer project - \u2705 Speed is critical (many CI runs) - \u2705 You have other verification mechanisms","title":"When to Use Each Mode"},{"location":"pytho-setup/pixi/#updating-lock-files","text":"Recommended workflow: Update dependencies locally: ```bash # Edit pyproject.toml vim pyproject.toml # Update lock file pixi install # Verify it works pixi run pytest ``` Commit both files: bash git add pyproject.toml pixi.lock git commit -m \"Update numpy to 2.0\" git push CI validates: PR runs with verify-lock: 'true' \u2705 Passes because lock file matches Reviewers see both files changed What NOT to do: # \u274c Don't edit only pyproject.toml without updating lock vim pyproject.toml git add pyproject.toml # Missing pixi.lock! git commit -m \"Update numpy\" # CI will fail with \"Lock file is outdated\"","title":"Updating Lock Files"},{"location":"pytho-setup/pixi/#environment-architecture","text":"","title":"Environment Architecture"},{"location":"pytho-setup/pixi/#understanding-pixi-environments","text":"Pixi uses a feature-based system to compose environments: Features \u2192 Environments \u2192 Activation","title":"Understanding Pixi Environments"},{"location":"pytho-setup/pixi/#1-features-dependency-groups","text":"Features define groups of related dependencies: [tool.pixi.feature.core.dependencies] python = \">=3.11\" numpy = \">=1.26\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" [tool.pixi.feature.ml.dependencies] scikit-learn = \">=1.3\" pytorch = \">=2.0\" Think of features as: - \ud83d\udce6 Reusable dependency sets - \ud83e\udde9 Building blocks for environments - \ud83c\udfaf Logical groupings (core, dev, ML, viz, etc.)","title":"1. Features (Dependency Groups)"},{"location":"pytho-setup/pixi/#2-environments-feature-combinations","text":"Environments combine multiple features: [tool.pixi.environments] default = [\"core\"] # Just core dev = [\"core\", \"dev\"] # Core + dev tools ml = [\"core\", \"ml\"] # Core + ML packages full = [\"core\", \"dev\", \"ml\"] # Everything Think of environments as: - \ud83c\udfad Different use cases (dev, test, prod) - \ud83d\udd27 Job-specific setups - \ud83d\udcca Matrix test configurations","title":"2. Environments (Feature Combinations)"},{"location":"pytho-setup/pixi/#3-activation-runtime-selection","text":"The action installs environments and activates one: environments: 'dev ml' # Installs both activate-environment: 'dev' # Activates dev (adds to PATH) After activation: - \u2705 python \u2192 Python from activated environment - \u2705 pytest \u2192 If in activated environment - \u2705 Package imports work from activated environment - \u274c Packages from other environments not in PATH (but can use pixi run -e )","title":"3. Activation (Runtime Selection)"},{"location":"pytho-setup/pixi/#environment-lifecycle","text":"Step-by-step what happens: Validation : Check pixi.lock exists Installation : Install pixi (if not cached) Lock Check (if verify-lock: 'true' ): Verify lock matches pyproject.toml Environment Creation : Install specified environments bash pixi install --locked # or --frozen # Creates .pixi/envs/dev/, .pixi/envs/ml/, etc. Activation : Add environment to PATH bash # Adds .pixi/envs/dev/bin to PATH Verification : Log environment info","title":"Environment Lifecycle"},{"location":"pytho-setup/pixi/#directory-structure","text":"After installation, your project looks like: my-project/ \u251c\u2500\u2500 pyproject.toml \u251c\u2500\u2500 pixi.lock \u251c\u2500\u2500 .pixi/ # Created by pixi \u2502 \u251c\u2500\u2500 envs/ \u2502 \u2502 \u251c\u2500\u2500 default/ # Each environment \u2502 \u2502 \u2502 \u251c\u2500\u2500 bin/ \u2502 \u2502 \u2502 \u251c\u2500\u2500 lib/ \u2502 \u2502 \u2502 \u2514\u2500\u2500 ... \u2502 \u2502 \u251c\u2500\u2500 dev/ \u2502 \u2502 \u2502 \u251c\u2500\u2500 bin/ \u2502 \u2502 \u2502 \u2514\u2500\u2500 ... \u2502 \u2502 \u2514\u2500\u2500 ml/ \u2502 \u2502 \u2514\u2500\u2500 ... \u2502 \u2514\u2500\u2500 bin/ \u2502 \u2514\u2500\u2500 pixi # Pixi binary \u251c\u2500\u2500 src/ \u2514\u2500\u2500 tests/ Caching caches : The entire .pixi/ directory","title":"Directory Structure"},{"location":"pytho-setup/pixi/#caching-strategy","text":"","title":"Caching Strategy"},{"location":"pytho-setup/pixi/#how-caching-works","text":"Cache Key : pixi-<hash(pixi.lock)> What's cached : Entire .pixi/ directory containing: - All installed environments - Pixi binary - Package metadata Cache flow: \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Run starts \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Hash pixi.lock \u2502 \u2190 Generate cache key \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Cache \u2502 \u2502 hit? \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518 \u2502 \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 YES NO \u2502 \u2502 \u25bc \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502Restore \u2502 \u2502Install fresh \u2502 \u2502cache \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u25bc \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 Is push to \u2502 \u2502 \u2502 main branch? \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 YES NO \u2502 \u2502 \u2502 \u2502 \u25bc \u25bc \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 Save \u2502 \u2502 Skip \u2502 \u2502 \u2502 cache \u2502 \u2502 save \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Done \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"How Caching Works"},{"location":"pytho-setup/pixi/#cache-performance","text":"Typical timings: Scenario Time Notes No cache, small project 1-2 min Few packages No cache, large project 5-10 min Many packages (ML libs) Cache hit 20-40 sec Restore + verify Cache miss 5-10 min Full install + save Factors affecting speed: - Number of packages - Package size (pytorch is large!) - Number of environments - Network speed (first install)","title":"Cache Performance"},{"location":"pytho-setup/pixi/#cache-invalidation","text":"Automatic invalidation when: - \u2705 pixi.lock changes (new hash \u2192 new key) - \u2705 GitHub clears old caches (7 days unused) Manual invalidation: - Clear cache via GitHub UI (Settings \u2192 Actions \u2192 Caches) - Change cache key (modify action or add version to pyproject.toml ) Cache won't invalidate when: - \u274c Only pyproject.toml changes (lock file unchanged) - \u274c Code changes - \u274c Non-dependency configuration changes","title":"Cache Invalidation"},{"location":"pytho-setup/pixi/#cache-best-practices","text":"DO: - \u2705 Enable caching for stable projects - \u2705 Use caching in production CI - \u2705 Monitor cache hit rates - \u2705 Include lock file in commits DON'T: - \u274c Enable caching when debugging dependency issues - \u274c Rely on cache without lock file verification - \u274c Cache in fork PRs (limited cache space) Optimal configuration: # Main branch - write cache - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' verify-lock: 'true' # Verify even with cache # PR branches - read cache only (automatic) # Same configuration, but cache-write is disabled automatically","title":"Cache Best Practices"},{"location":"pytho-setup/pixi/#testing-guide","text":"This action is comprehensively tested across multiple scenarios to ensure reliability. Reference the test workflow at .github/workflows/test-python-setup-pixi.yml .","title":"Testing Guide"},{"location":"pytho-setup/pixi/#test-coverage-matrix","text":"Test Job Purpose Key Validations Fixture test-pixi-basic Default behavior Pixi and Python installed, packages available test-pixi-basic/ test-pixi-default-environment Default environment only Only default environment installed test-pixi-default-environment/ test-pixi-multiple-environments Multiple environments Multiple envs installed, correct one activated test-pixi-multiple-environments/ test-pixi-environment-activation Environment activation Specific environment activated correctly test-pixi-environment-activation/ test-pixi-lock-verification-valid Valid lock file Lock verification passes test-pixi-lock-verification-valid/ test-pixi-lock-verification-outdated Outdated lock handling Fails with outdated lock file test-pixi-lock-verification-outdated/ test-pixi-lock-verification-disabled Skip lock check Works with verify-lock: 'false' test-pixi-lock-verification-disabled/ test-pixi-lock-verification-validation Missing lock file Fails without lock file test-pixi-lock-verification-validation/ test-pixi-caching-populate Cache population Cache created and packages installed test-pixi-caching-populate/ test-pixi-caching-retrieve Cache retrieval Cache restored on subsequent runs test-pixi-caching-retrieve/ test-pixi-caching-validation Cache without lock Fails when cache enabled without lock - test-pixi-matrix Cross-platform matrix Works on Linux/Windows/macOS with multiple environments test-pixi-matrix/ test-pixi-error-scenarios Error handling Proper errors for missing lock, wrong environment test-pixi-basic/ test-pixi-complex-project Complex setup Multiple features and environments test-pixi-complex-project/","title":"Test Coverage Matrix"},{"location":"pytho-setup/pixi/#test-fixtures-location","text":"All test fixtures are located in tests/data/pixi/ directory: tests/data/pixi/ \u251c\u2500\u2500 test-pixi-basic/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-default-environment/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-multiple-environments/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-environment-activation/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-valid/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-outdated/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-disabled/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-lock-verification-validation/ \u2502 \u2514\u2500\u2500 pyproject.toml # No lock file (intentional) \u251c\u2500\u2500 test-pixi-caching-populate/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-caching-retrieve/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u251c\u2500\u2500 test-pixi-matrix/ \u2502 \u251c\u2500\u2500 pyproject.toml \u2502 \u2514\u2500\u2500 pixi.lock \u2514\u2500\u2500 test-pixi-complex-project/ \u251c\u2500\u2500 pyproject.toml \u2514\u2500\u2500 pixi.lock","title":"Test Fixtures Location"},{"location":"pytho-setup/pixi/#example-test-fixtures","text":"test-pixi-basic/pyproject.toml: [project] name = \"test-pixi-basic\" version = \"0.1.0\" dependencies = [] [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.dependencies] python = \">=3.11\" numpy = \">=1.26\" pytest = \">=7.0\" test-pixi-multiple-environments/pyproject.toml: [project] name = \"test-multi-env\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.feature.core.dependencies] python = \">=3.11\" numpy = \">=1.26\" [tool.pixi.feature.py311.dependencies] python = \"3.11.*\" pandas = \">=2.0\" [tool.pixi.feature.py312.dependencies] python = \"3.12.*\" pandas = \">=2.0\" [tool.pixi.environments] default = [\"core\"] py311 = [\"core\", \"py311\"] py312 = [\"core\", \"py312\"] test-pixi-complex-project/pyproject.toml: [project] name = \"test-complex\" version = \"0.1.0\" [tool.pixi.workspace] channels = [\"conda-forge\"] platforms = [\"linux-64\", \"osx-64\", \"osx-arm64\", \"win-64\"] [tool.pixi.feature.core.dependencies] python = \">=3.11\" requests = \">=2.31\" [tool.pixi.feature.ml.dependencies] numpy = \">=1.26\" scikit-learn = \">=1.3\" [tool.pixi.feature.dev.dependencies] pytest = \">=7.0\" black = \">=23.0\" [tool.pixi.environments] default = [\"core\", \"dev\"] ml = [\"core\", \"ml\", \"dev\"] prod = [\"core\", \"ml\"]","title":"Example Test Fixtures"},{"location":"pytho-setup/pixi/#basic-test-setup","text":"name: Tests on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' - run: pytest tests/","title":"Basic Test Setup"},{"location":"pytho-setup/pixi/#matrix-testing-multiple-python-versions","text":"jobs: test: strategy: matrix: python-env: ['py310', 'py311', 'py312'] runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: ${{ matrix.python-env }} activate-environment: ${{ matrix.python-env }} cache: 'false' - run: pytest","title":"Matrix Testing: Multiple Python Versions"},{"location":"pytho-setup/pixi/#matrix-testing-multiple-operating-systems","text":"jobs: test: strategy: matrix: os: [ubuntu-latest, macos-latest, windows-latest] runs-on: ${{ matrix.os }} steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' - run: pytest","title":"Matrix Testing: Multiple Operating Systems"},{"location":"pytho-setup/pixi/#matrix-testing-combined","text":"jobs: test: strategy: matrix: os: [ubuntu-latest, macos-latest, windows-latest] python-env: ['py311', 'py312'] runs-on: ${{ matrix.os }} steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: ${{ matrix.python-env }} activate-environment: ${{ matrix.python-env }} cache: 'false' - run: pytest","title":"Matrix Testing: Combined"},{"location":"pytho-setup/pixi/#testing-multiple-environments-in-one-job","text":"jobs: test-all: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: environments: 'dev test' activate-environment: 'dev' cache: 'false' - name: Lint with dev environment run: | black --check . ruff check . - name: Test with test environment run: pixi run -e test pytest --cov","title":"Testing Multiple Environments in One Job"},{"location":"pytho-setup/pixi/#lock-file-verification-tests","text":"","title":"Lock File Verification Tests"},{"location":"pytho-setup/pixi/#test-valid-lock-file","text":"jobs: test-valid-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: verify-lock: 'true' # Should pass cache: 'false' - run: pytest","title":"Test Valid Lock File"},{"location":"pytho-setup/pixi/#test-outdated-lock-file-should-fail","text":"jobs: test-outdated-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 # Modify pyproject.toml to make lock outdated - run: | echo \"\" >> pyproject.toml echo \"[tool.pixi.dependencies]\" >> pyproject.toml echo \"newpackage = \\\">=1.0\\\"\" >> pyproject.toml - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 id: setup continue-on-error: true with: verify-lock: 'true' # Should fail cache: 'false' - name: Verify it failed if: steps.setup.outcome != 'failure' run: | echo \"ERROR: Should have failed with outdated lock\" exit 1","title":"Test Outdated Lock File (Should Fail)"},{"location":"pytho-setup/pixi/#test-without-lock-file-should-fail","text":"jobs: test-no-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - run: rm pixi.lock # Remove lock file - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 id: setup continue-on-error: true with: cache: 'false' - name: Verify it failed if: steps.setup.outcome != 'failure' run: | echo \"ERROR: Should have failed without lock file\" exit 1","title":"Test Without Lock File (Should Fail)"},{"location":"pytho-setup/pixi/#caching-tests","text":"","title":"Caching Tests"},{"location":"pytho-setup/pixi/#test-cache-population","text":"jobs: cache-populate: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' - run: pytest","title":"Test Cache Population"},{"location":"pytho-setup/pixi/#test-cache-retrieval","text":"jobs: cache-populate: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' - run: pytest cache-retrieve: runs-on: ubuntu-latest needs: cache-populate steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 id: setup with: cache: 'true' # Second run should be much faster - run: pytest","title":"Test Cache Retrieval"},{"location":"pytho-setup/pixi/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"pytho-setup/pixi/#common-issues","text":"","title":"Common Issues"},{"location":"pytho-setup/pixi/#issue-pixilock-file-does-not-exist","text":"Error message: \u274c pixi.lock file does not exist! To fix this issue: Run 'pixi install' locally to generate pixi.lock and commit it to your repository Solution: # On your local machine pixi install git add pixi.lock git commit -m \"Add pixi lock file\" git push","title":"Issue: \"pixi.lock file does not exist\""},{"location":"pytho-setup/pixi/#issue-lock-file-is-outdated","text":"Error message: The pixi.lock file is outdated. Please run `pixi install` to update it. Cause: You modified pyproject.toml without updating the lock file. Solution: # Update lock file pixi install # Commit both files git add pyproject.toml pixi.lock git commit -m \"Update dependencies\" git push","title":"Issue: \"Lock file is outdated\""},{"location":"pytho-setup/pixi/#issue-cache-not-working","text":"Symptoms: Every run takes 5-10 minutes even with cache: 'true' Possible causes: Lock file keeps changing: bash # Check if lock file is in .gitignore git check-ignore pixi.lock # Should output nothing (not ignored) Running on PR from fork: Forks have limited cache access This is a GitHub limitation Cache was cleared: Check GitHub Actions \u2192 Caches Old caches are auto-deleted after 7 days Solution: - Ensure pixi.lock is committed - Check cache hit/miss in logs - For fork PRs, accept slower runs","title":"Issue: Cache not working"},{"location":"pytho-setup/pixi/#issue-environment-not-found","text":"Error message: Error: Environment 'ml' not found Cause: Trying to activate an environment that doesn't exist in pyproject.toml or wasn't installed. Solution: # Wrong with: environments: 'dev' activate-environment: 'ml' # \u274c ml not installed! # Correct with: environments: 'dev ml' # \u2705 Install both activate-environment: 'ml' # \u2705 Now can activate ml","title":"Issue: \"Environment not found\""},{"location":"pytho-setup/pixi/#issue-package-not-found-after-setup","text":"Symptoms: ModuleNotFoundError: No module named 'numpy' even though it's in pyproject.toml Possible causes: Wrong environment activated: ```yaml # Package is in 'ml' environment but 'dev' is active with: environments: 'dev ml' activate-environment: 'dev' # numpy might not be here run: python -c \"import numpy\" # \u274c Fails ``` Package in wrong feature: Check your pyproject.toml environment definitions Solution: # Check which environment has the package pixi list -e dev | grep numpy pixi list -e ml | grep numpy # Either switch environment or add package to current environment","title":"Issue: Package not found after setup"},{"location":"pytho-setup/pixi/#issue-different-versions-locally-vs-ci","text":"Symptoms: Works locally but fails in CI (or vice versa) Cause: Lock file not synchronized Solution: # Regenerate lock file locally rm pixi.lock pixi install # Commit and push git add pixi.lock git commit -m \"Regenerate lock file\" git push","title":"Issue: Different versions locally vs CI"},{"location":"pytho-setup/pixi/#issue-windows-specific-path-issues","text":"Symptoms: Works on Linux/Mac but fails on Windows Cause: Path separators or shell-specific commands Solution: # Use pixi tasks instead of shell commands # In pyproject.toml: [tool.pixi.tasks] test = \"pytest tests/\" # In workflow: - run: pixi run test # Cross-platform!","title":"Issue: Windows-specific path issues"},{"location":"pytho-setup/pixi/#issue-slow-installation-even-with-cache","text":"Symptoms: Cache hits but still takes 2-3 minutes Cause: Lock verification and environment activation take time Solution: # For trusted environments, disable verification with: cache: 'true' verify-lock: 'false' # Faster but less safe","title":"Issue: Slow installation even with cache"},{"location":"pytho-setup/pixi/#debug-mode","text":"To get more information about what's happening: - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'false' # Add debug steps - name: Debug environment info run: | echo \"Pixi version:\" pixi --version echo \"Available environments:\" pixi info echo \"Active Python:\" which python python --version echo \"Installed packages:\" pixi list echo \"PATH:\" echo $PATH","title":"Debug Mode"},{"location":"pytho-setup/pixi/#best-practices","text":"","title":"Best Practices"},{"location":"pytho-setup/pixi/#1-always-commit-lock-files","text":"\u2705 DO: git add pyproject.toml pixi.lock git commit -m \"Update numpy to 2.0\" \u274c DON'T: git add pyproject.toml # Missing pixi.lock - CI will fail!","title":"1. Always Commit Lock Files"},{"location":"pytho-setup/pixi/#2-use-locked-mode-in-ci","text":"\u2705 DO: with: verify-lock: 'true' # Catch drift \u274c DON'T: with: verify-lock: 'false' # Silent failures Exception: Disable when lock is auto-updated by bots","title":"2. Use Locked Mode in CI"},{"location":"pytho-setup/pixi/#3-enable-caching-for-stable-projects","text":"\u2705 DO: # Stable project with infrequent dependency changes with: cache: 'true' \u274c DON'T: # When debugging dependency issues with: cache: 'true' # Cache might mask issues","title":"3. Enable Caching for Stable Projects"},{"location":"pytho-setup/pixi/#4-use-minimal-environments","text":"\u2705 DO: # Install only what you need jobs: lint: steps: - uses: .../pixi@v1 with: environments: 'dev' # Just linting tools test: steps: - uses: .../pixi@v1 with: environments: 'test' # Just test deps \u274c DON'T: # Install everything everywhere jobs: lint: steps: - uses: .../pixi@v1 with: environments: 'dev test ml viz' # Overkill!","title":"4. Use Minimal Environments"},{"location":"pytho-setup/pixi/#5-one-environment-activation-per-job","text":"\u2705 DO: - uses: .../pixi@v1 with: environments: 'dev' activate-environment: 'dev' # All subsequent steps use dev environment \u274c DON'T: # Trying to activate multiple environments (not possible) - uses: .../pixi@v1 with: activate-environment: 'dev' - uses: .../pixi@v1 # \u274c Second activation with: activate-environment: 'test' If you need multiple environments , use pixi run -e : - uses: .../pixi@v1 with: environments: 'dev test' activate-environment: 'dev' - run: black --check . # Uses dev - run: pixi run -e test pytest # Uses test","title":"5. One Environment Activation Per Job"},{"location":"pytho-setup/pixi/#6-organize-dependencies-by-purpose","text":"\u2705 DO: [tool.pixi.feature.core.dependencies] # Core runtime dependencies numpy = \">=1.26\" pandas = \">=2.0\" [tool.pixi.feature.dev.dependencies] # Development tools black = \">=23.0\" ruff = \">=0.1\" [tool.pixi.feature.test.dependencies] # Testing tools pytest = \">=7.0\" pytest-cov = \">=4.0\" [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev\"] ci = [\"core\", \"test\"] \u274c DON'T: [tool.pixi.dependencies] # Everything in one place numpy = \">=1.26\" pandas = \">=2.0\" black = \">=23.0\" pytest = \">=7.0\" # No organization!","title":"6. Organize Dependencies by Purpose"},{"location":"pytho-setup/pixi/#7-use-descriptive-environment-names","text":"\u2705 DO: [tool.pixi.environments] default = [\"core\"] dev = [\"core\", \"dev-tools\"] test-py311 = [\"core\", \"test\", \"py311\"] test-py312 = [\"core\", \"test\", \"py312\"] prod = [\"core\"] \u274c DON'T: [tool.pixi.environments] env1 = [\"core\"] env2 = [\"core\", \"dev\"] myenv = [\"core\", \"test\"]","title":"7. Use Descriptive Environment Names"},{"location":"pytho-setup/pixi/#8-document-environment-purpose","text":"\u2705 DO: [tool.pixi.environments] # Core dependencies only - minimal install default = [\"core\"] # Development environment - includes linting and formatting tools dev = [\"core\", \"dev-tools\"] # CI testing environment - includes test runners and coverage ci = [\"core\", \"test\"] # Production environment - runtime dependencies only prod = [\"core\"]","title":"8. Document Environment Purpose"},{"location":"pytho-setup/pixi/#9-pin-major-python-version","text":"\u2705 DO: [tool.pixi.dependencies] python = \">=3.11,<3.13\" # Explicit range \u274c DON'T: [tool.pixi.dependencies] python = \">=3.11\" # Too permissive","title":"9. Pin Major Python Version"},{"location":"pytho-setup/pixi/#10-test-lock-file-verification-in-ci","text":"\u2705 DO: jobs: validate-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: .../pixi@v1 with: verify-lock: 'true' # Enforce verification cache: 'false' This catches PRs with outdated lock files early.","title":"10. Test Lock File Verification in CI"},{"location":"pytho-setup/pixi/#migration-guide","text":"","title":"Migration Guide"},{"location":"pytho-setup/pixi/#from-setup-python-pip","text":"Before (pip): - uses: actions/setup-python@v5 with: python-version: '3.11' cache: 'pip' - run: pip install -r requirements.txt After (pixi): - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' Migration steps: 1. Create pyproject.toml with pixi configuration 2. Run pixi install locally to generate pixi.lock 3. Commit both files 4. Update workflow to use pixi action","title":"From setup-python + pip"},{"location":"pytho-setup/pixi/#from-setup-python-conda","text":"Before (conda): - uses: conda-incubator/setup-miniconda@v3 with: python-version: '3.11' environment-file: environment.yml After (pixi): - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' Migration steps: 1. Convert environment.yml to pyproject.toml pixi format 2. Run pixi install to generate lock file 3. Commit files 4. Update workflow","title":"From setup-python + conda"},{"location":"pytho-setup/pixi/#from-mamba-orgsetup-micromamba","text":"Before (micromamba): - uses: mamba-org/setup-micromamba@v1 with: environment-file: environment.yml cache-environment: true After (pixi): - uses: Serapieum-of-alex/github-actions/actions/python-setup/pixi@v1 with: cache: 'true' Pixi is faster than micromamba and has better lock file support!","title":"From mamba-org/setup-micromamba"},{"location":"pytho-setup/pixi/#additional-resources","text":"Pixi Documentation : https://prefix.dev/docs/pixi Pixi GitHub : https://github.com/prefix-dev/pixi Conda-forge : https://conda-forge.org/ Action Source : Serapieum-of-alex/github-actions/actions/python-setup/pixi","title":"Additional Resources"},{"location":"pytho-setup/pixi/#examples-repository","text":"See the test suite for comprehensive examples: - .github/workflows/test-python-setup-pixi.yml - All test scenarios - tests/data/pixi/ - Example configurations","title":"Examples Repository"},{"location":"pytho-setup/pixi/#support","text":"For issues or questions: 1. Check Troubleshooting 2. Review test examples 3. Open an issue in the repository Version : 1.0.0 Last Updated : January 2026 Compatibility : Linux, macOS, Windows Pixi Version : v0.49.0","title":"Support"},{"location":"pytho-setup/uv/","text":"Python Setup with uv - Complete Guide Composite GitHub Action for setting up Python environments with the uv package manager, designed for modern Python projects using pyproject.toml and dependency groups. Table of Contents Overview Quick Start Inputs Reference Features Usage Scenarios Dependency Groups Lock File Verification Virtual Environment Testing Guide Troubleshooting Best Practices Overview This action provides a complete Python environment setup using uv , the fast Python package installer and resolver. It automatically: Installs Python and uv Verifies lock file integrity (optional) Installs dependencies with group support Activates the virtual environment automatically Caches dependencies for faster CI runs Location : Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 Quick Start Basic Usage (Core Dependencies Only) steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # Virtual environment is automatically activated! - run: python --version - run: pytest With Dependency Groups steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' - run: pytest - run: black --check . Inputs Reference Input Description Required Default Valid Values python-version Python version to install No '3.12' Any valid Python version (e.g., '3.10' , '3.11' , '3.12' ) install-groups Dependency groups to install No '' (core only) Space or comma-separated list (e.g., 'dev' , 'dev test' , 'dev,test,docs' ) verify-lock Verify lock file is up to date No 'true' 'true' , 'false' Input Details python-version Specifies which Python version to install via actions/setup-python@v6 . Examples: python-version: '3.10' # Python 3.10 python-version: '3.11' # Python 3.11 python-version: '3.12' # Python 3.12 (default) install-groups Specifies which dependency groups from [dependency-groups] in pyproject.toml to install. Default behavior ( '' ) : Installs only core dependencies (those listed in dependencies ), no optional groups. When specified : Installs core dependencies + only the specified groups (all other groups are excluded). Formats supported: - Space-separated: 'dev test' - Comma-separated: 'dev,test,docs' - Mixed: 'dev, test docs' Important : The action uses uv sync --no-default-groups --group <name> to ensure ONLY the specified groups are installed, preventing unwanted transitive group installations. verify-lock Controls whether to verify the uv.lock file is up to date before installation. When 'true' (default) : Runs uv lock --check and fails if lock file is outdated. **When 'false' : Skips lock file verification. Features 1. Automatic Virtual Environment Activation The action automatically activates the .venv virtual environment by: - Adding .venv/bin (Linux/macOS) or .venv/Scripts (Windows) to $GITHUB_PATH - Setting $VIRTUAL_ENV environment variable Result : All subsequent steps can use python , pytest , black , etc. directly without manual activation or uv run . - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' # No activation needed! - run: python --version # Uses venv Python - run: pytest # Uses venv pytest - run: black . # Uses venv black 2. Smart Dependency Group Management The action uses --no-default-groups flag to ensure clean group isolation: # pyproject.toml [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx\"] test = [\"pytest-cov\"] docs = [\"mkdocs\"] Without groups ( install-groups: '' ): - Command: uv sync --frozen --no-default-groups - Installs: requests only With specific groups ( install-groups: 'test docs' ): - Command: uv sync --frozen --no-default-groups --group test --group docs - Installs: requests + pytest-cov + mkdocs - Excludes: httpx (dev group not requested) 3. Lock File Verification Ensures reproducible builds by validating uv.lock matches pyproject.toml : - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Fails if lock is outdated Skip verification (useful for dynamic dependency updates): - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false' 4. Dependency Caching The action uses astral-sh/setup-uv@v4 with: enable-cache: true cache-dependency-glob: uv.lock This caches dependencies based on uv.lock hash, significantly speeding up CI runs. 5. Comprehensive Logging The action provides detailed output: Environment information Virtual environment: ACTIVATED Virtual environment location: /home/runner/work/repo/repo/.venv Python executable: /home/runner/work/repo/repo/.venv/bin/python The virtual environment has been automatically activated. You can now use 'python' and installed CLI tools directly in subsequent steps. Usage Scenarios Scenario 1: Core Dependencies Only Use Case : Simple project with only core dependencies, no dev tools needed. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 - name: Run application run: python main.py pyproject.toml : [project] name = \"my-app\" version = \"1.0.0\" dependencies = [\"requests\", \"pydantic\"] What gets installed : requests , pydantic only Scenario 2: Development Environment Use Case : Local-style development with all dev tools. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev' - run: black --check . - run: mypy src/ - run: ruff check . pyproject.toml : [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\"] What gets installed : requests + black + mypy + ruff Scenario 3: Testing Workflow Use Case : Run tests without dev tools to match production environment. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: test' - run: pytest --cov=src --cov-report=xml - run: coverage report pyproject.toml : [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\", \"coverage\"] What gets installed : requests + pytest + pytest-cov + coverage (dev tools excluded) Scenario 4: Documentation Build Use Case : Build documentation without test/dev dependencies. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'docs' - run: mkdocs build - run: mkdocs gh-deploy --force pyproject.toml : [project] dependencies = [\"mylib\"] [dependency-groups] docs = [\"mkdocs\", \"mkdocs-material\"] What gets installed : mylib + mkdocs + mkdocs-material Scenario 5: Multiple Groups Use Case : CI workflow that needs both testing and linting. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' - name: Lint run: | black --check . mypy src/ - name: Test run: pytest --cov=src pyproject.toml : [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\"] # Not installed What gets installed : requests + black + mypy + pytest + pytest-cov What's excluded : mkdocs (docs group not requested) Scenario 6: Matrix Testing Across Python Versions Use Case : Test compatibility with multiple Python versions. strategy: matrix: python-version: ['3.10', '3.11', '3.12'] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: python-version: ${{ matrix.python-version }} install-groups: 'groups: test' - run: pytest Result : Tests run on Python 3.10, 3.11, and 3.12 Scenario 7: Cross-Platform Testing Use Case : Ensure application works on all major operating systems. strategy: matrix: os: [ubuntu-latest, windows-latest, macos-latest] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'test' - run: pytest Result : Tests run on Linux, Windows, and macOS Scenario 8: Skip Lock Verification for Dynamic Dependencies Use Case : Dependencies from Git branches or local paths that change frequently. pyproject.toml : [project] dependencies = [ \"mylib @ git+https://github.com/user/repo@main\", \"another-lib @ git+https://github.com/user/another@develop\" ] Workflow: jobs: test-dynamic: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false' # Skip lock check for dynamic deps install-groups: 'groups: dev' - name: Run tests run: pytest What Happens : - Skips uv lock --check validation - Installs dependencies from lock file as-is - Useful when lock file changes frequently Scenario 9: No Dependency Groups Section Use Case : Simple project without optional dependency groups. pyproject.toml : [project] name = \"simple-app\" dependencies = [\"requests\", \"click\"] # No [dependency-groups] section Workflow: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 - name: Run application run: python app.py What Happens : - Core dependencies installed: requests , click - No error even though [dependency-groups] section doesn't exist - Action handles missing dependency-groups gracefully Scenario 10: Multiple Formats for Groups Use Case : Demonstrating flexible group specification formats. All these are equivalent: # Space-separated install-groups: 'groups: dev test docs' # Comma-separated install-groups: 'groups: dev,test,docs' # Mixed install-groups: 'groups: dev, test docs' Workflow: jobs: test-formats: runs-on: ubuntu-latest strategy: matrix: format: - 'groups: dev test docs' - 'groups: dev,test,docs' - 'groups: dev, test docs' steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: ${{ matrix.format }} - name: Verify all formats work run: | python -c \"import black, pytest, mkdocs\" echo \"[OK] All formats install same dependencies\" Scenario 11: Complex Multi-Group Setup Use Case : Large project with many specialized dependency groups. pyproject.toml : [project] name = \"enterprise-app\" dependencies = [\"requests\", \"pydantic\", \"typer\"] [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] azure = [\"azure-storage-blob\", \"azure-identity\"] gcp = [\"google-cloud-storage\"] postgres = [\"psycopg2-binary\", \"sqlalchemy\"] redis = [\"redis\", \"hiredis\"] [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\", \"ipython\"] test = [\"pytest\", \"pytest-cov\", \"pytest-mock\", \"hypothesis\"] docs = [\"mkdocs\", \"mkdocs-material\", \"mkdocstrings[python]\"] lint = [\"pylint\", \"flake8\", \"bandit\"] build = [\"build\", \"twine\", \"wheel\"] Workflow (development): jobs: develop: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev test lint, extras: postgres redis' - name: Full dev environment run: | black --check . mypy src/ pytest --cov=src Workflow (documentation): jobs: docs: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: docs' - name: Build docs run: mkdocs build Workflow (production): jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'extras: aws postgres' # No dev groups - name: Deploy app run: python -m app Scenario 12: Testing Lock File Validation Use Case : Ensuring lock file stays in sync with pyproject.toml. Workflow: jobs: validate-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Verify lock file is up to date uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Default, but explicit install-groups: 'groups: dev' - name: Run checks run: | echo \"Lock file is valid and up to date\" pytest What Happens : - Runs uv lock --check before installation - Fails if lock file is outdated with clear error message - Prevents deploying with mismatched dependencies Scenario 13: Explicit Dev Group Installation Use Case : Ensuring dev tools are available for local-style development in CI. pyproject.toml : [project] name = \"myapp\" dependencies = [\"fastapi\", \"uvicorn\"] [dependency-groups] dev = [\"pytest\", \"black\", \"mypy\", \"ruff\", \"httpx\"] Workflow: jobs: dev-ci: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev' - name: Run all dev checks run: | black --check . mypy src/ ruff check . pytest What Happens : - Core: fastapi , uvicorn - Dev group: pytest , black , mypy , ruff , httpx - All dev tools available for comprehensive CI checks Scenario 14: Minimal Production Build Use Case : Production deployment with only runtime dependencies. pyproject.toml : [project] name = \"webapp\" dependencies = [\"flask\", \"gunicorn\", \"psycopg2\"] [dependency-groups] dev = [\"pytest\", \"black\"] test = [\"pytest-cov\", \"faker\"] Workflow: jobs: production: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # No install-groups = core only - name: Verify minimal install run: | uv pip list python -c \"import flask, gunicorn, psycopg2\" echo \"[OK] Only production dependencies installed\" - name: Deploy run: gunicorn app:app What Happens : - Only core dependencies installed - No dev/test tools (smaller image, faster deployment) - Production-ready minimal environment Scenario 15: Cache Behavior Testing Use Case : Understanding and testing caching behavior. Workflow: jobs: cache-test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: First run (populate cache) uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: cache: 'true' # Default install-groups: 'groups: dev test' - name: Verify packages run: uv pip list # On subsequent runs: # - Cache restored from uv.lock hash # - Much faster (seconds vs minutes) Cache behavior : - First run : Downloads and caches all dependencies (~2-5 minutes) - Subsequent runs : Restores from cache (~10-30 seconds) - Cache key : Based on uv.lock hash - Cache invalidation : Automatic when uv.lock changes Dependency Groups Dependency Groups vs Optional Dependencies Key Differences : Dependency Groups ( [dependency-groups] ): Part of PEP 735 standard Fully supported by uv (unlike pip) Development-only dependencies, not published with package Installed using --group flag with uv sync Use prefix groups: in this action Recommended for uv users Optional Dependencies ( [project.optional-dependencies] ): Part of PEP 621 standard, widely supported Published with your package, can be installed by end users Installed using --extra flag with uv sync Use prefix extras: in this action Also supported by uv Key Advantage of uv : Unlike pip, uv has full native support for PEP 735 dependency groups without any limitations or warnings. Understanding Dependency Groups Dependency groups in pyproject.toml allow organizing optional dependencies: [project] name = \"myapp\" dependencies = [\"requests\"] # Core - always installed [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] # Published extras (end-user features) viz = [\"matplotlib\", \"seaborn\"] # End-user features [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\"] # Development tools (not published) test = [\"pytest\", \"pytest-cov\"] # Testing tools (not published) docs = [\"mkdocs\", \"mkdocstrings\"] # Documentation tools (not published) When to use which: - optional-dependencies : Features for end-users (e.g., cloud integrations, visualization) - dependency-groups : Development tools only needed by contributors (e.g., linting, testing) Group Installation Behavior install-groups Value Command Generated What Gets Installed '' (empty/default) uv sync --frozen --no-default-groups Core only 'groups: dev' uv sync --frozen --no-default-groups --group dev Core + dev 'groups: test' uv sync --frozen --no-default-groups --group test Core + test 'groups: dev test' uv sync --frozen --no-default-groups --group dev --group test Core + dev + test 'groups: dev,test,docs' uv sync --frozen --no-default-groups --group dev --group test --group docs Core + dev + test + docs 'extras: aws' uv sync --frozen --no-default-groups --extra aws Core + aws extra 'groups: dev, extras: aws' uv sync --frozen --no-default-groups --group dev --extra aws Core + dev + aws Why --no-default-groups ? By default, uv sync includes certain groups automatically (like dev ). Using --no-default-groups ensures: - \u2705 Clean group isolation - only requested groups are installed - \u2705 Predictable builds - same result every time - \u2705 Reproducible - no unexpected transitive group installations - \u2705 Explicit control - you specify exactly what to install Without --no-default-groups (old behavior): uv sync --group test # Might also install 'dev' group unexpectedly With --no-default-groups (current behavior): uv sync --no-default-groups --group test # ONLY test group Format Options The action accepts multiple formats for install-groups : Space-separated: install-groups: 'groups: dev test docs' Comma-separated: install-groups: 'groups: dev,test,docs' Mixed (spaces and commas): install-groups: 'groups: dev, test docs' Groups and extras together: install-groups: 'groups: dev test, extras: aws viz' Reverse order (extras first): install-groups: 'extras: aws, groups: dev' All formats produce the same result - the action parses them intelligently. Common Group Patterns Development: [dependency-groups] dev = [\"black>=23.0\", \"mypy>=1.0\", \"ruff>=0.1\", \"ipython>=8.0\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: dev' - run: black --check . - run: mypy src/ Testing: [dependency-groups] test = [\"pytest>=7.0\", \"pytest-cov>=4.0\", \"pytest-mock>=3.0\", \"faker>=20.0\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: test' - run: pytest --cov=src Documentation: [dependency-groups] docs = [\"mkdocs>=1.5\", \"mkdocs-material>=9.0\", \"mkdocstrings[python]>=0.24\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: docs' - run: mkdocs build Production (extras for end-users): [project.optional-dependencies] postgres = [\"psycopg2-binary>=2.9\"] redis = [\"redis>=5.0\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'extras: postgres redis' - run: python app.py Combined (dev + testing): - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: dev test' - run: black --check . - run: pytest All groups: - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: dev test docs, extras: aws azure' Installation Summary Output The action provides detailed feedback about what will be installed: Example output: Processing install-groups: groups: dev test, extras: aws - Adding dependency group: dev - Adding dependency group: test - Adding optional dependency (extra): aws === Installation Summary === \u2713 Dependency groups will be installed: dev test \u2713 Optional dependencies (extras) will be installed: aws \u2717 No optional dependencies specified \u2713 Core dependencies will always be installed ========================== Running: uv sync --frozen --no-default-groups --group dev --group test --extra aws This makes it clear exactly what's being installed and why. Lock File Verification What is Lock File Verification? uv.lock is a lock file that pins exact versions of all dependencies. Verification ensures the lock file is synchronized with pyproject.toml . When to Enable (Default) Enable verification ( verify-lock: 'true' ) when: - Working in a team (ensure everyone uses same dependencies) - Production deployments (reproducible builds) - CI/CD pipelines (catch dependency drift early) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Fails if lock is outdated Error if outdated : error: The lockfile at `uv.lock` needs to be updated, but `--locked` was provided. Fix : Run uv lock locally and commit the updated lock file. When to Disable Disable verification ( verify-lock: 'false' ) when: - Dependencies change frequently (Git dependencies) - Development branches with experimental changes - Prototyping/testing new dependencies - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false' Lock File Workflow Recommended workflow : 1. Modify pyproject.toml (add/update dependencies) 2. Run uv lock locally 3. Commit both pyproject.toml and uv.lock 4. CI runs with verify-lock: 'true' and passes Virtual Environment Automatic Activation The action automatically activates the virtual environment created by uv sync at .venv . How it works : 1. Action runs uv sync which creates .venv/ 2. Action adds .venv/bin (or .venv/Scripts on Windows) to $GITHUB_PATH 3. Action sets $VIRTUAL_ENV environment variable 4. All subsequent steps use the activated environment Using the Environment Direct Python/CLI commands (recommended): - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' - run: python --version - run: pytest - run: black . - run: mypy src/ Alternative: uv run (also works): - run: uv run pytest - run: uv run black . Manual activation (unnecessary but possible): - run: | source .venv/bin/activate # Linux/macOS python --version Environment Location The virtual environment is always at: - Linux/macOS : $(pwd)/.venv - Windows : $(pwd)\\.venv Python executable : - Linux/macOS : .venv/bin/python - Windows : .venv\\Scripts\\python.exe Testing Guide This action is comprehensively tested across multiple scenarios to ensure reliability and correct behavior. Reference the test workflow at .github/workflows/test-python-setup-uv.yml . Test Coverage Matrix Test Job Purpose Key Validations Behavior Tested test-uv-basic Default behavior (core only) Core dependencies installed, dev group NOT installed --no-default-groups excludes optional groups by default test-uv-custom-groups Specific groups Only test and docs groups installed, dev excluded Group isolation with --no-default-groups test-uv-no-groups Explicit empty groups Only core dependencies, no optional groups Empty install-groups: '' handled correctly test-uv-lock-verification Lock validation (valid) Lock file check passes uv lock --check succeeds with up-to-date lock test-uv-lock-verification-disabled Skip lock check Installation succeeds without verification verify-lock: 'false' skips validation test-uv-lock-verification-fail Outdated lock handling Action fails gracefully with clear error Outdated lock detected and reported test-uv-matrix Cross-platform/version Python 3.10/3.11/3.12 on Linux/Windows/macOS Platform-specific virtual environment activation test-uv-cache Dependency caching Cache populated and restored based on uv.lock hash enable-cache: true with cache-dependency-glob test-uv-comma-separated-groups Group parsing 'dev,test,docs' format parsed correctly Multiple separator handling test-uv-mixed-separators Group parsing 'dev, test docs' format parsed correctly Flexible formatting support test-uv-space-separated-groups Group parsing 'dev test docs' format parsed correctly Space-separated groups test-uv-no-dependency-groups-section Missing groups section Works without [dependency-groups] in pyproject.toml Graceful handling of missing section test-uv-explicit-dev-group Specific dev group Only dev group installed when requested Explicit group selection test-uv-groups-and-extras Mixed groups/extras Both groups and extras install correctly --group and --extra flags together test-uv-extras-only Extras without groups Only extras installed, groups excluded extras: prefix handling test-uv-reverse-order Order independence Same result regardless of groups/extras order Parser handles any order Test Scenarios Details Default Behavior Test ( test-uv-basic ): - Validates : Core dependencies installed, optional groups excluded by default - Key assertion : httpx from dev group should NOT be present - Purpose : Verify --no-default-groups prevents automatic group installation Custom Groups Test ( test-uv-custom-groups ): - Validates : Only requested groups ( test , docs ) installed - Key assertion : httpx from dev group should NOT be present - Purpose : Verify group isolation and --no-default-groups behavior Lock Verification Test ( test-uv-lock-verification ): - Validates : uv lock --check passes with synchronized lock file - Purpose : Ensure lock file validation works correctly Lock Verification Failure Test ( test-uv-lock-verification-fail ): - Setup : Modifies pyproject.toml after generating lock file - Validates : Action fails with clear error message - Purpose : Verify outdated lock detection Matrix Test ( test-uv-matrix ): - Validates : Works across Python 3.10, 3.11, 3.12 on ubuntu, windows, macos - Purpose : Cross-platform and cross-version compatibility Format Tests ( comma-separated , mixed-separators , space-separated ): - Validates : All group specification formats produce identical results - Purpose : Flexible input format support Test Fixtures Tests use inline pyproject.toml creation for maximum clarity: Basic Test Example: - name: Create test project with uv run: | cat > pyproject.toml << 'EOF' [project] name = \"test-uv-basic\" version = \"0.1.0\" requires-python = \">=3.12\" dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx\"] EOF pip install uv uv lock Custom Groups Test Example: - name: Create test project with multiple groups run: | cat > pyproject.toml << 'EOF' [project] name = \"test-uv-groups\" version = \"0.1.0\" requires-python = \">=3.12\" dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx\"] test = [\"pytest-cov\", \"pytest-mock\"] docs = [\"mkdocs\"] EOF pip install uv uv lock Running Tests Locally Using act (GitHub Actions locally): # Install act choco install act-cli # Windows brew install act # macOS winget install nektos.act # Windows (alternative) # Run specific test act -j test-uv-basic act -j test-uv-custom-groups act -j test-uv-matrix # Run all uv tests act -j test-uv-* Manual testing in your repository: # .github/workflows/test-uv-action.yml name: Test uv action on: [push, pull_request] jobs: test-basic: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev test' - run: pytest test-groups-isolation: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: test' - name: Verify only test group run: | python -c \"import pytest; print('[OK] Test group installed')\" # Verify dev group NOT installed python -c \"import black\" 2>&1 && exit 1 || echo \"[OK] Dev group not installed\" test-lock-verification: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' - run: echo \"Lock file verified\" Expected Test Behaviors Group Isolation: - When install-groups: 'groups: test' specified, ONLY test group installed - Dev, docs, and other groups explicitly excluded via --no-default-groups - Core dependencies always installed Lock File Verification: - With verify-lock: 'true' : Fails if lock outdated - With verify-lock: 'false' : Uses lock as-is without checking - Default is 'true' for safety Virtual Environment Activation: - .venv/bin (Linux/macOS) or .venv/Scripts (Windows) added to PATH - VIRTUAL_ENV environment variable set - Subsequent steps can use python and CLI tools directly Cache Behavior: - First run: Downloads and caches dependencies - Subsequent runs: Restores from cache based on uv.lock hash - Cache invalidates automatically when lock file changes Debugging Failed Tests Verify Python and uv installation: - name: Debug environment run: | python --version uv --version which python which uv Check installed packages: - name: List packages run: | uv pip list python -c \"import sys; print(sys.path)\" Test specific imports: - name: Test imports run: | python -c \"import pytest; print('pytest OK')\" python -c \"import black; print('black OK')\" || echo \"black not installed (expected?)\" Verify virtual environment: - name: Check venv run: | echo \"VIRTUAL_ENV: $VIRTUAL_ENV\" echo \"PATH: $PATH\" ls -la .venv/ Check lock file: - name: Verify lock run: | cat pyproject.toml ls -la uv.lock uv lock --check Test Assertions Examples Positive assertion (should be installed): python -c \"import pytest; print('[OK] pytest installed')\" Negative assertion (should NOT be installed): if python -c \"import httpx\" 2>/dev/null; then echo \"[ERROR] httpx should not be installed\" exit 1 else echo \"[OK] httpx not installed as expected\" fi Version assertion: python -c \"import sys; assert sys.version_info[:2] == (3, 12), 'Wrong Python version'\" Continuous Integration Best Practices Matrix testing: strategy: matrix: python-version: ['3.10', '3.11', '3.12'] os: [ubuntu-latest, windows-latest, macos-latest] groups: ['dev', 'test', 'dev test', ''] steps: - uses: .../actions/python-setup/uv@v1 with: python-version: ${{ matrix.python-version }} install-groups: ${{ matrix.groups && format('groups: {0}', matrix.groups) || '' }} Fail-fast disabled for comprehensive testing: strategy: fail-fast: false # Test all combinations even if one fails matrix: # ... matrix configuration Troubleshooting Error: \"The lockfile at uv.lock needs to be updated\" Cause : Lock file is outdated compared to pyproject.toml . Solution : # Update lock file locally uv lock # Commit the changes git add pyproject.toml uv.lock git commit -m \"Update dependencies\" git push Or disable verification temporarily: - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false' Error: \"No such file or directory: uv.lock\" Cause : Lock file doesn't exist in repository. Solution : # Generate lock file uv lock # Commit it git add uv.lock git commit -m \"Add uv.lock file\" git push Wrong Python Version Issue : Action installs Python 3.12 but need 3.10. Solution : Specify version explicitly: - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: python-version: '3.10' Dependency Not Found After Installation Issue : ModuleNotFoundError even after installation. Possible causes : 1. Group not specified : Dependency is in optional group not requested ```yaml # Wrong: dev group has pytest but not installed install-groups: 'test' # Fix: Add dev group install-groups: 'dev test' ``` Wrong import name : Package name \u2260 import name toml # Package: \"pyyaml\", Import: \"yaml\" dependencies = [\"pyyaml\"] python import yaml # Not: import pyyaml Groups Not Isolated Issue : Unwanted packages installed even though group not specified. Cause : Before the fix, the action used --group which included default groups. Solution : Use latest version of the action which uses --no-default-groups : - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # Latest Virtual Environment Not Activated Issue : python: command not found or wrong Python version. Verification : - run: | echo \"Python: $(which python)\" echo \"PATH: $PATH\" echo \"VIRTUAL_ENV: $VIRTUAL_ENV\" Expected output : Python: /home/runner/work/repo/repo/.venv/bin/python PATH: /home/runner/work/repo/repo/.venv/bin:... VIRTUAL_ENV: /home/runner/work/repo/repo/.venv If not working : Check GitHub Actions runner logs for warnings in \"Activate virtual environment\" step. Cache Not Working Symptoms : Dependencies reinstall on every run. Debug : 1. Check uv.lock exists and is committed 2. Verify cache hit in action logs: Restored cache from key: setup-uv-... 3. Check lock file hasn't changed between runs Force cache refresh : Change uv.lock content (update dependencies). Best Practices 1. Always Commit Lock File # Generate lock file uv lock # Always commit both files together git add pyproject.toml uv.lock git commit -m \"Update dependencies\" Why : Ensures reproducible builds across all environments. 2. Use Specific Python Versions # Good: Explicit version python-version: '3.11' # Avoid: Version ranges or latest python-version: '3.x' # Too broad 3. Organize Dependency Groups by Purpose # Good: Clear separation [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\"] # Avoid: Single \"dev\" group for everything [dependency-groups] dev = [\"black\", \"mypy\", \"pytest\", \"mkdocs\"] # Too broad 4. Use Lock Verification in CI # Good: Catch dependency drift early - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Default, but explicit is clear 5. Pin Action Versions # Good: Pin to major version (gets updates) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # Good: Pin to exact commit (maximum stability) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@abc1234 # Avoid: Using @main (unpredictable) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@main 6. Separate Workflows by Purpose # lint.yml - uses: .../actions/python-setup/uv@v1 with: install-groups: 'dev' - run: black --check . - run: mypy src/ # test.yml - uses: .../actions/python-setup/uv@v1 with: install-groups: 'test' - run: pytest # docs.yml - uses: .../actions/python-setup/uv@v1 with: install-groups: 'docs' - run: mkdocs build 7. Use Matrix for Multi-Version Testing strategy: matrix: python-version: ['3.10', '3.11', '3.12'] os: [ubuntu-latest, windows-latest, macos-latest] steps: - uses: .../actions/python-setup/uv@v1 with: python-version: ${{ matrix.python-version }} Comparison with Other Actions Feature This Action actions/setup-python astral-sh/setup-uv alone Python Installation \u2713 \u2713 \u2717 (requires setup-python) uv Installation \u2713 \u2717 \u2713 Dependency Installation \u2713 (automatic) \u2717 (manual) \u2717 (manual) Group Support \u2713 (built-in) \u2717 \u2713 (manual) Lock Verification \u2713 (built-in) \u2717 \u2717 (manual) Auto VEnv Activation \u2713 \u2717 \u2717 Dependency Caching \u2713 \u2713 (pip only) \u2713 Group Isolation \u2713 ( --no-default-groups ) N/A \u2717 (manual) When to use this action: - Modern Python projects using pyproject.toml - Need dependency group support - Want automatic environment activation - Prefer uv's speed over pip When to use alternatives: - actions/setup-python alone: Minimal setup, no uv needed - astral-sh/setup-uv alone: Need full control over uv commands Additional Resources uv documentation PEP 735: Dependency Groups actions/setup-python astral-sh/setup-uv Support For issues, questions, or contributions: - Repository: https://github.com/Serapieum-of-alex/github-actions - Issues: https://github.com/Serapieum-of-alex/github-actions/issues","title":"Python Setup with uv - Complete Guide"},{"location":"pytho-setup/uv/#python-setup-with-uv-complete-guide","text":"Composite GitHub Action for setting up Python environments with the uv package manager, designed for modern Python projects using pyproject.toml and dependency groups.","title":"Python Setup with uv - Complete Guide"},{"location":"pytho-setup/uv/#table-of-contents","text":"Overview Quick Start Inputs Reference Features Usage Scenarios Dependency Groups Lock File Verification Virtual Environment Testing Guide Troubleshooting Best Practices","title":"Table of Contents"},{"location":"pytho-setup/uv/#overview","text":"This action provides a complete Python environment setup using uv , the fast Python package installer and resolver. It automatically: Installs Python and uv Verifies lock file integrity (optional) Installs dependencies with group support Activates the virtual environment automatically Caches dependencies for faster CI runs Location : Serapieum-of-alex/github-actions/actions/python-setup/uv@v1","title":"Overview"},{"location":"pytho-setup/uv/#quick-start","text":"","title":"Quick Start"},{"location":"pytho-setup/uv/#basic-usage-core-dependencies-only","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # Virtual environment is automatically activated! - run: python --version - run: pytest","title":"Basic Usage (Core Dependencies Only)"},{"location":"pytho-setup/uv/#with-dependency-groups","text":"steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' - run: pytest - run: black --check .","title":"With Dependency Groups"},{"location":"pytho-setup/uv/#inputs-reference","text":"Input Description Required Default Valid Values python-version Python version to install No '3.12' Any valid Python version (e.g., '3.10' , '3.11' , '3.12' ) install-groups Dependency groups to install No '' (core only) Space or comma-separated list (e.g., 'dev' , 'dev test' , 'dev,test,docs' ) verify-lock Verify lock file is up to date No 'true' 'true' , 'false'","title":"Inputs Reference"},{"location":"pytho-setup/uv/#input-details","text":"","title":"Input Details"},{"location":"pytho-setup/uv/#python-version","text":"Specifies which Python version to install via actions/setup-python@v6 . Examples: python-version: '3.10' # Python 3.10 python-version: '3.11' # Python 3.11 python-version: '3.12' # Python 3.12 (default)","title":"python-version"},{"location":"pytho-setup/uv/#install-groups","text":"Specifies which dependency groups from [dependency-groups] in pyproject.toml to install. Default behavior ( '' ) : Installs only core dependencies (those listed in dependencies ), no optional groups. When specified : Installs core dependencies + only the specified groups (all other groups are excluded). Formats supported: - Space-separated: 'dev test' - Comma-separated: 'dev,test,docs' - Mixed: 'dev, test docs' Important : The action uses uv sync --no-default-groups --group <name> to ensure ONLY the specified groups are installed, preventing unwanted transitive group installations.","title":"install-groups"},{"location":"pytho-setup/uv/#verify-lock","text":"Controls whether to verify the uv.lock file is up to date before installation. When 'true' (default) : Runs uv lock --check and fails if lock file is outdated. **When 'false' : Skips lock file verification.","title":"verify-lock"},{"location":"pytho-setup/uv/#features","text":"","title":"Features"},{"location":"pytho-setup/uv/#1-automatic-virtual-environment-activation","text":"The action automatically activates the .venv virtual environment by: - Adding .venv/bin (Linux/macOS) or .venv/Scripts (Windows) to $GITHUB_PATH - Setting $VIRTUAL_ENV environment variable Result : All subsequent steps can use python , pytest , black , etc. directly without manual activation or uv run . - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' # No activation needed! - run: python --version # Uses venv Python - run: pytest # Uses venv pytest - run: black . # Uses venv black","title":"1. Automatic Virtual Environment Activation"},{"location":"pytho-setup/uv/#2-smart-dependency-group-management","text":"The action uses --no-default-groups flag to ensure clean group isolation: # pyproject.toml [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx\"] test = [\"pytest-cov\"] docs = [\"mkdocs\"] Without groups ( install-groups: '' ): - Command: uv sync --frozen --no-default-groups - Installs: requests only With specific groups ( install-groups: 'test docs' ): - Command: uv sync --frozen --no-default-groups --group test --group docs - Installs: requests + pytest-cov + mkdocs - Excludes: httpx (dev group not requested)","title":"2. Smart Dependency Group Management"},{"location":"pytho-setup/uv/#3-lock-file-verification","text":"Ensures reproducible builds by validating uv.lock matches pyproject.toml : - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Fails if lock is outdated Skip verification (useful for dynamic dependency updates): - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false'","title":"3. Lock File Verification"},{"location":"pytho-setup/uv/#4-dependency-caching","text":"The action uses astral-sh/setup-uv@v4 with: enable-cache: true cache-dependency-glob: uv.lock This caches dependencies based on uv.lock hash, significantly speeding up CI runs.","title":"4. Dependency Caching"},{"location":"pytho-setup/uv/#5-comprehensive-logging","text":"The action provides detailed output: Environment information Virtual environment: ACTIVATED Virtual environment location: /home/runner/work/repo/repo/.venv Python executable: /home/runner/work/repo/repo/.venv/bin/python The virtual environment has been automatically activated. You can now use 'python' and installed CLI tools directly in subsequent steps.","title":"5. Comprehensive Logging"},{"location":"pytho-setup/uv/#usage-scenarios","text":"","title":"Usage Scenarios"},{"location":"pytho-setup/uv/#scenario-1-core-dependencies-only","text":"Use Case : Simple project with only core dependencies, no dev tools needed. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 - name: Run application run: python main.py pyproject.toml : [project] name = \"my-app\" version = \"1.0.0\" dependencies = [\"requests\", \"pydantic\"] What gets installed : requests , pydantic only","title":"Scenario 1: Core Dependencies Only"},{"location":"pytho-setup/uv/#scenario-2-development-environment","text":"Use Case : Local-style development with all dev tools. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev' - run: black --check . - run: mypy src/ - run: ruff check . pyproject.toml : [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\"] What gets installed : requests + black + mypy + ruff","title":"Scenario 2: Development Environment"},{"location":"pytho-setup/uv/#scenario-3-testing-workflow","text":"Use Case : Run tests without dev tools to match production environment. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: test' - run: pytest --cov=src --cov-report=xml - run: coverage report pyproject.toml : [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\", \"coverage\"] What gets installed : requests + pytest + pytest-cov + coverage (dev tools excluded)","title":"Scenario 3: Testing Workflow"},{"location":"pytho-setup/uv/#scenario-4-documentation-build","text":"Use Case : Build documentation without test/dev dependencies. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'docs' - run: mkdocs build - run: mkdocs gh-deploy --force pyproject.toml : [project] dependencies = [\"mylib\"] [dependency-groups] docs = [\"mkdocs\", \"mkdocs-material\"] What gets installed : mylib + mkdocs + mkdocs-material","title":"Scenario 4: Documentation Build"},{"location":"pytho-setup/uv/#scenario-5-multiple-groups","text":"Use Case : CI workflow that needs both testing and linting. steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' - name: Lint run: | black --check . mypy src/ - name: Test run: pytest --cov=src pyproject.toml : [project] dependencies = [\"requests\"] [dependency-groups] dev = [\"black\", \"mypy\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\"] # Not installed What gets installed : requests + black + mypy + pytest + pytest-cov What's excluded : mkdocs (docs group not requested)","title":"Scenario 5: Multiple Groups"},{"location":"pytho-setup/uv/#scenario-6-matrix-testing-across-python-versions","text":"Use Case : Test compatibility with multiple Python versions. strategy: matrix: python-version: ['3.10', '3.11', '3.12'] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: python-version: ${{ matrix.python-version }} install-groups: 'groups: test' - run: pytest Result : Tests run on Python 3.10, 3.11, and 3.12","title":"Scenario 6: Matrix Testing Across Python Versions"},{"location":"pytho-setup/uv/#scenario-7-cross-platform-testing","text":"Use Case : Ensure application works on all major operating systems. strategy: matrix: os: [ubuntu-latest, windows-latest, macos-latest] steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'test' - run: pytest Result : Tests run on Linux, Windows, and macOS","title":"Scenario 7: Cross-Platform Testing"},{"location":"pytho-setup/uv/#scenario-8-skip-lock-verification-for-dynamic-dependencies","text":"Use Case : Dependencies from Git branches or local paths that change frequently. pyproject.toml : [project] dependencies = [ \"mylib @ git+https://github.com/user/repo@main\", \"another-lib @ git+https://github.com/user/another@develop\" ] Workflow: jobs: test-dynamic: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false' # Skip lock check for dynamic deps install-groups: 'groups: dev' - name: Run tests run: pytest What Happens : - Skips uv lock --check validation - Installs dependencies from lock file as-is - Useful when lock file changes frequently","title":"Scenario 8: Skip Lock Verification for Dynamic Dependencies"},{"location":"pytho-setup/uv/#scenario-9-no-dependency-groups-section","text":"Use Case : Simple project without optional dependency groups. pyproject.toml : [project] name = \"simple-app\" dependencies = [\"requests\", \"click\"] # No [dependency-groups] section Workflow: jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 - name: Run application run: python app.py What Happens : - Core dependencies installed: requests , click - No error even though [dependency-groups] section doesn't exist - Action handles missing dependency-groups gracefully","title":"Scenario 9: No Dependency Groups Section"},{"location":"pytho-setup/uv/#scenario-10-multiple-formats-for-groups","text":"Use Case : Demonstrating flexible group specification formats. All these are equivalent: # Space-separated install-groups: 'groups: dev test docs' # Comma-separated install-groups: 'groups: dev,test,docs' # Mixed install-groups: 'groups: dev, test docs' Workflow: jobs: test-formats: runs-on: ubuntu-latest strategy: matrix: format: - 'groups: dev test docs' - 'groups: dev,test,docs' - 'groups: dev, test docs' steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: ${{ matrix.format }} - name: Verify all formats work run: | python -c \"import black, pytest, mkdocs\" echo \"[OK] All formats install same dependencies\"","title":"Scenario 10: Multiple Formats for Groups"},{"location":"pytho-setup/uv/#scenario-11-complex-multi-group-setup","text":"Use Case : Large project with many specialized dependency groups. pyproject.toml : [project] name = \"enterprise-app\" dependencies = [\"requests\", \"pydantic\", \"typer\"] [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] azure = [\"azure-storage-blob\", \"azure-identity\"] gcp = [\"google-cloud-storage\"] postgres = [\"psycopg2-binary\", \"sqlalchemy\"] redis = [\"redis\", \"hiredis\"] [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\", \"ipython\"] test = [\"pytest\", \"pytest-cov\", \"pytest-mock\", \"hypothesis\"] docs = [\"mkdocs\", \"mkdocs-material\", \"mkdocstrings[python]\"] lint = [\"pylint\", \"flake8\", \"bandit\"] build = [\"build\", \"twine\", \"wheel\"] Workflow (development): jobs: develop: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev test lint, extras: postgres redis' - name: Full dev environment run: | black --check . mypy src/ pytest --cov=src Workflow (documentation): jobs: docs: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: docs' - name: Build docs run: mkdocs build Workflow (production): jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'extras: aws postgres' # No dev groups - name: Deploy app run: python -m app","title":"Scenario 11: Complex Multi-Group Setup"},{"location":"pytho-setup/uv/#scenario-12-testing-lock-file-validation","text":"Use Case : Ensuring lock file stays in sync with pyproject.toml. Workflow: jobs: validate-lock: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: Verify lock file is up to date uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Default, but explicit install-groups: 'groups: dev' - name: Run checks run: | echo \"Lock file is valid and up to date\" pytest What Happens : - Runs uv lock --check before installation - Fails if lock file is outdated with clear error message - Prevents deploying with mismatched dependencies","title":"Scenario 12: Testing Lock File Validation"},{"location":"pytho-setup/uv/#scenario-13-explicit-dev-group-installation","text":"Use Case : Ensuring dev tools are available for local-style development in CI. pyproject.toml : [project] name = \"myapp\" dependencies = [\"fastapi\", \"uvicorn\"] [dependency-groups] dev = [\"pytest\", \"black\", \"mypy\", \"ruff\", \"httpx\"] Workflow: jobs: dev-ci: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev' - name: Run all dev checks run: | black --check . mypy src/ ruff check . pytest What Happens : - Core: fastapi , uvicorn - Dev group: pytest , black , mypy , ruff , httpx - All dev tools available for comprehensive CI checks","title":"Scenario 13: Explicit Dev Group Installation"},{"location":"pytho-setup/uv/#scenario-14-minimal-production-build","text":"Use Case : Production deployment with only runtime dependencies. pyproject.toml : [project] name = \"webapp\" dependencies = [\"flask\", \"gunicorn\", \"psycopg2\"] [dependency-groups] dev = [\"pytest\", \"black\"] test = [\"pytest-cov\", \"faker\"] Workflow: jobs: production: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # No install-groups = core only - name: Verify minimal install run: | uv pip list python -c \"import flask, gunicorn, psycopg2\" echo \"[OK] Only production dependencies installed\" - name: Deploy run: gunicorn app:app What Happens : - Only core dependencies installed - No dev/test tools (smaller image, faster deployment) - Production-ready minimal environment","title":"Scenario 14: Minimal Production Build"},{"location":"pytho-setup/uv/#scenario-15-cache-behavior-testing","text":"Use Case : Understanding and testing caching behavior. Workflow: jobs: cache-test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - name: First run (populate cache) uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: cache: 'true' # Default install-groups: 'groups: dev test' - name: Verify packages run: uv pip list # On subsequent runs: # - Cache restored from uv.lock hash # - Much faster (seconds vs minutes) Cache behavior : - First run : Downloads and caches all dependencies (~2-5 minutes) - Subsequent runs : Restores from cache (~10-30 seconds) - Cache key : Based on uv.lock hash - Cache invalidation : Automatic when uv.lock changes","title":"Scenario 15: Cache Behavior Testing"},{"location":"pytho-setup/uv/#dependency-groups","text":"","title":"Dependency Groups"},{"location":"pytho-setup/uv/#dependency-groups-vs-optional-dependencies","text":"Key Differences : Dependency Groups ( [dependency-groups] ): Part of PEP 735 standard Fully supported by uv (unlike pip) Development-only dependencies, not published with package Installed using --group flag with uv sync Use prefix groups: in this action Recommended for uv users Optional Dependencies ( [project.optional-dependencies] ): Part of PEP 621 standard, widely supported Published with your package, can be installed by end users Installed using --extra flag with uv sync Use prefix extras: in this action Also supported by uv Key Advantage of uv : Unlike pip, uv has full native support for PEP 735 dependency groups without any limitations or warnings.","title":"Dependency Groups vs Optional Dependencies"},{"location":"pytho-setup/uv/#understanding-dependency-groups","text":"Dependency groups in pyproject.toml allow organizing optional dependencies: [project] name = \"myapp\" dependencies = [\"requests\"] # Core - always installed [project.optional-dependencies] aws = [\"boto3\", \"s3fs\"] # Published extras (end-user features) viz = [\"matplotlib\", \"seaborn\"] # End-user features [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\"] # Development tools (not published) test = [\"pytest\", \"pytest-cov\"] # Testing tools (not published) docs = [\"mkdocs\", \"mkdocstrings\"] # Documentation tools (not published) When to use which: - optional-dependencies : Features for end-users (e.g., cloud integrations, visualization) - dependency-groups : Development tools only needed by contributors (e.g., linting, testing)","title":"Understanding Dependency Groups"},{"location":"pytho-setup/uv/#group-installation-behavior","text":"install-groups Value Command Generated What Gets Installed '' (empty/default) uv sync --frozen --no-default-groups Core only 'groups: dev' uv sync --frozen --no-default-groups --group dev Core + dev 'groups: test' uv sync --frozen --no-default-groups --group test Core + test 'groups: dev test' uv sync --frozen --no-default-groups --group dev --group test Core + dev + test 'groups: dev,test,docs' uv sync --frozen --no-default-groups --group dev --group test --group docs Core + dev + test + docs 'extras: aws' uv sync --frozen --no-default-groups --extra aws Core + aws extra 'groups: dev, extras: aws' uv sync --frozen --no-default-groups --group dev --extra aws Core + dev + aws","title":"Group Installation Behavior"},{"location":"pytho-setup/uv/#why-no-default-groups","text":"By default, uv sync includes certain groups automatically (like dev ). Using --no-default-groups ensures: - \u2705 Clean group isolation - only requested groups are installed - \u2705 Predictable builds - same result every time - \u2705 Reproducible - no unexpected transitive group installations - \u2705 Explicit control - you specify exactly what to install Without --no-default-groups (old behavior): uv sync --group test # Might also install 'dev' group unexpectedly With --no-default-groups (current behavior): uv sync --no-default-groups --group test # ONLY test group","title":"Why --no-default-groups?"},{"location":"pytho-setup/uv/#format-options","text":"The action accepts multiple formats for install-groups : Space-separated: install-groups: 'groups: dev test docs' Comma-separated: install-groups: 'groups: dev,test,docs' Mixed (spaces and commas): install-groups: 'groups: dev, test docs' Groups and extras together: install-groups: 'groups: dev test, extras: aws viz' Reverse order (extras first): install-groups: 'extras: aws, groups: dev' All formats produce the same result - the action parses them intelligently.","title":"Format Options"},{"location":"pytho-setup/uv/#common-group-patterns","text":"Development: [dependency-groups] dev = [\"black>=23.0\", \"mypy>=1.0\", \"ruff>=0.1\", \"ipython>=8.0\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: dev' - run: black --check . - run: mypy src/ Testing: [dependency-groups] test = [\"pytest>=7.0\", \"pytest-cov>=4.0\", \"pytest-mock>=3.0\", \"faker>=20.0\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: test' - run: pytest --cov=src Documentation: [dependency-groups] docs = [\"mkdocs>=1.5\", \"mkdocs-material>=9.0\", \"mkdocstrings[python]>=0.24\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: docs' - run: mkdocs build Production (extras for end-users): [project.optional-dependencies] postgres = [\"psycopg2-binary>=2.9\"] redis = [\"redis>=5.0\"] - uses: .../actions/python-setup/uv@v1 with: install-groups: 'extras: postgres redis' - run: python app.py Combined (dev + testing): - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: dev test' - run: black --check . - run: pytest All groups: - uses: .../actions/python-setup/uv@v1 with: install-groups: 'groups: dev test docs, extras: aws azure'","title":"Common Group Patterns"},{"location":"pytho-setup/uv/#installation-summary-output","text":"The action provides detailed feedback about what will be installed: Example output: Processing install-groups: groups: dev test, extras: aws - Adding dependency group: dev - Adding dependency group: test - Adding optional dependency (extra): aws === Installation Summary === \u2713 Dependency groups will be installed: dev test \u2713 Optional dependencies (extras) will be installed: aws \u2717 No optional dependencies specified \u2713 Core dependencies will always be installed ========================== Running: uv sync --frozen --no-default-groups --group dev --group test --extra aws This makes it clear exactly what's being installed and why.","title":"Installation Summary Output"},{"location":"pytho-setup/uv/#lock-file-verification","text":"","title":"Lock File Verification"},{"location":"pytho-setup/uv/#what-is-lock-file-verification","text":"uv.lock is a lock file that pins exact versions of all dependencies. Verification ensures the lock file is synchronized with pyproject.toml .","title":"What is Lock File Verification?"},{"location":"pytho-setup/uv/#when-to-enable-default","text":"Enable verification ( verify-lock: 'true' ) when: - Working in a team (ensure everyone uses same dependencies) - Production deployments (reproducible builds) - CI/CD pipelines (catch dependency drift early) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Fails if lock is outdated Error if outdated : error: The lockfile at `uv.lock` needs to be updated, but `--locked` was provided. Fix : Run uv lock locally and commit the updated lock file.","title":"When to Enable (Default)"},{"location":"pytho-setup/uv/#when-to-disable","text":"Disable verification ( verify-lock: 'false' ) when: - Dependencies change frequently (Git dependencies) - Development branches with experimental changes - Prototyping/testing new dependencies - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false'","title":"When to Disable"},{"location":"pytho-setup/uv/#lock-file-workflow","text":"Recommended workflow : 1. Modify pyproject.toml (add/update dependencies) 2. Run uv lock locally 3. Commit both pyproject.toml and uv.lock 4. CI runs with verify-lock: 'true' and passes","title":"Lock File Workflow"},{"location":"pytho-setup/uv/#virtual-environment","text":"","title":"Virtual Environment"},{"location":"pytho-setup/uv/#automatic-activation","text":"The action automatically activates the virtual environment created by uv sync at .venv . How it works : 1. Action runs uv sync which creates .venv/ 2. Action adds .venv/bin (or .venv/Scripts on Windows) to $GITHUB_PATH 3. Action sets $VIRTUAL_ENV environment variable 4. All subsequent steps use the activated environment","title":"Automatic Activation"},{"location":"pytho-setup/uv/#using-the-environment","text":"Direct Python/CLI commands (recommended): - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'dev test' - run: python --version - run: pytest - run: black . - run: mypy src/ Alternative: uv run (also works): - run: uv run pytest - run: uv run black . Manual activation (unnecessary but possible): - run: | source .venv/bin/activate # Linux/macOS python --version","title":"Using the Environment"},{"location":"pytho-setup/uv/#environment-location","text":"The virtual environment is always at: - Linux/macOS : $(pwd)/.venv - Windows : $(pwd)\\.venv Python executable : - Linux/macOS : .venv/bin/python - Windows : .venv\\Scripts\\python.exe","title":"Environment Location"},{"location":"pytho-setup/uv/#testing-guide","text":"This action is comprehensively tested across multiple scenarios to ensure reliability and correct behavior. Reference the test workflow at .github/workflows/test-python-setup-uv.yml .","title":"Testing Guide"},{"location":"pytho-setup/uv/#test-coverage-matrix","text":"Test Job Purpose Key Validations Behavior Tested test-uv-basic Default behavior (core only) Core dependencies installed, dev group NOT installed --no-default-groups excludes optional groups by default test-uv-custom-groups Specific groups Only test and docs groups installed, dev excluded Group isolation with --no-default-groups test-uv-no-groups Explicit empty groups Only core dependencies, no optional groups Empty install-groups: '' handled correctly test-uv-lock-verification Lock validation (valid) Lock file check passes uv lock --check succeeds with up-to-date lock test-uv-lock-verification-disabled Skip lock check Installation succeeds without verification verify-lock: 'false' skips validation test-uv-lock-verification-fail Outdated lock handling Action fails gracefully with clear error Outdated lock detected and reported test-uv-matrix Cross-platform/version Python 3.10/3.11/3.12 on Linux/Windows/macOS Platform-specific virtual environment activation test-uv-cache Dependency caching Cache populated and restored based on uv.lock hash enable-cache: true with cache-dependency-glob test-uv-comma-separated-groups Group parsing 'dev,test,docs' format parsed correctly Multiple separator handling test-uv-mixed-separators Group parsing 'dev, test docs' format parsed correctly Flexible formatting support test-uv-space-separated-groups Group parsing 'dev test docs' format parsed correctly Space-separated groups test-uv-no-dependency-groups-section Missing groups section Works without [dependency-groups] in pyproject.toml Graceful handling of missing section test-uv-explicit-dev-group Specific dev group Only dev group installed when requested Explicit group selection test-uv-groups-and-extras Mixed groups/extras Both groups and extras install correctly --group and --extra flags together test-uv-extras-only Extras without groups Only extras installed, groups excluded extras: prefix handling test-uv-reverse-order Order independence Same result regardless of groups/extras order Parser handles any order","title":"Test Coverage Matrix"},{"location":"pytho-setup/uv/#test-scenarios-details","text":"Default Behavior Test ( test-uv-basic ): - Validates : Core dependencies installed, optional groups excluded by default - Key assertion : httpx from dev group should NOT be present - Purpose : Verify --no-default-groups prevents automatic group installation Custom Groups Test ( test-uv-custom-groups ): - Validates : Only requested groups ( test , docs ) installed - Key assertion : httpx from dev group should NOT be present - Purpose : Verify group isolation and --no-default-groups behavior Lock Verification Test ( test-uv-lock-verification ): - Validates : uv lock --check passes with synchronized lock file - Purpose : Ensure lock file validation works correctly Lock Verification Failure Test ( test-uv-lock-verification-fail ): - Setup : Modifies pyproject.toml after generating lock file - Validates : Action fails with clear error message - Purpose : Verify outdated lock detection Matrix Test ( test-uv-matrix ): - Validates : Works across Python 3.10, 3.11, 3.12 on ubuntu, windows, macos - Purpose : Cross-platform and cross-version compatibility Format Tests ( comma-separated , mixed-separators , space-separated ): - Validates : All group specification formats produce identical results - Purpose : Flexible input format support","title":"Test Scenarios Details"},{"location":"pytho-setup/uv/#test-fixtures","text":"Tests use inline pyproject.toml creation for maximum clarity: Basic Test Example: - name: Create test project with uv run: | cat > pyproject.toml << 'EOF' [project] name = \"test-uv-basic\" version = \"0.1.0\" requires-python = \">=3.12\" dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx\"] EOF pip install uv uv lock Custom Groups Test Example: - name: Create test project with multiple groups run: | cat > pyproject.toml << 'EOF' [project] name = \"test-uv-groups\" version = \"0.1.0\" requires-python = \">=3.12\" dependencies = [\"requests\"] [dependency-groups] dev = [\"httpx\"] test = [\"pytest-cov\", \"pytest-mock\"] docs = [\"mkdocs\"] EOF pip install uv uv lock","title":"Test Fixtures"},{"location":"pytho-setup/uv/#running-tests-locally","text":"Using act (GitHub Actions locally): # Install act choco install act-cli # Windows brew install act # macOS winget install nektos.act # Windows (alternative) # Run specific test act -j test-uv-basic act -j test-uv-custom-groups act -j test-uv-matrix # Run all uv tests act -j test-uv-* Manual testing in your repository: # .github/workflows/test-uv-action.yml name: Test uv action on: [push, pull_request] jobs: test-basic: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: dev test' - run: pytest test-groups-isolation: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: install-groups: 'groups: test' - name: Verify only test group run: | python -c \"import pytest; print('[OK] Test group installed')\" # Verify dev group NOT installed python -c \"import black\" 2>&1 && exit 1 || echo \"[OK] Dev group not installed\" test-lock-verification: runs-on: ubuntu-latest steps: - uses: actions/checkout@v5 - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' - run: echo \"Lock file verified\"","title":"Running Tests Locally"},{"location":"pytho-setup/uv/#expected-test-behaviors","text":"Group Isolation: - When install-groups: 'groups: test' specified, ONLY test group installed - Dev, docs, and other groups explicitly excluded via --no-default-groups - Core dependencies always installed Lock File Verification: - With verify-lock: 'true' : Fails if lock outdated - With verify-lock: 'false' : Uses lock as-is without checking - Default is 'true' for safety Virtual Environment Activation: - .venv/bin (Linux/macOS) or .venv/Scripts (Windows) added to PATH - VIRTUAL_ENV environment variable set - Subsequent steps can use python and CLI tools directly Cache Behavior: - First run: Downloads and caches dependencies - Subsequent runs: Restores from cache based on uv.lock hash - Cache invalidates automatically when lock file changes","title":"Expected Test Behaviors"},{"location":"pytho-setup/uv/#debugging-failed-tests","text":"Verify Python and uv installation: - name: Debug environment run: | python --version uv --version which python which uv Check installed packages: - name: List packages run: | uv pip list python -c \"import sys; print(sys.path)\" Test specific imports: - name: Test imports run: | python -c \"import pytest; print('pytest OK')\" python -c \"import black; print('black OK')\" || echo \"black not installed (expected?)\" Verify virtual environment: - name: Check venv run: | echo \"VIRTUAL_ENV: $VIRTUAL_ENV\" echo \"PATH: $PATH\" ls -la .venv/ Check lock file: - name: Verify lock run: | cat pyproject.toml ls -la uv.lock uv lock --check","title":"Debugging Failed Tests"},{"location":"pytho-setup/uv/#test-assertions-examples","text":"Positive assertion (should be installed): python -c \"import pytest; print('[OK] pytest installed')\" Negative assertion (should NOT be installed): if python -c \"import httpx\" 2>/dev/null; then echo \"[ERROR] httpx should not be installed\" exit 1 else echo \"[OK] httpx not installed as expected\" fi Version assertion: python -c \"import sys; assert sys.version_info[:2] == (3, 12), 'Wrong Python version'\"","title":"Test Assertions Examples"},{"location":"pytho-setup/uv/#continuous-integration-best-practices","text":"Matrix testing: strategy: matrix: python-version: ['3.10', '3.11', '3.12'] os: [ubuntu-latest, windows-latest, macos-latest] groups: ['dev', 'test', 'dev test', ''] steps: - uses: .../actions/python-setup/uv@v1 with: python-version: ${{ matrix.python-version }} install-groups: ${{ matrix.groups && format('groups: {0}', matrix.groups) || '' }} Fail-fast disabled for comprehensive testing: strategy: fail-fast: false # Test all combinations even if one fails matrix: # ... matrix configuration","title":"Continuous Integration Best Practices"},{"location":"pytho-setup/uv/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"pytho-setup/uv/#error-the-lockfile-at-uvlock-needs-to-be-updated","text":"Cause : Lock file is outdated compared to pyproject.toml . Solution : # Update lock file locally uv lock # Commit the changes git add pyproject.toml uv.lock git commit -m \"Update dependencies\" git push Or disable verification temporarily: - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'false'","title":"Error: \"The lockfile at uv.lock needs to be updated\""},{"location":"pytho-setup/uv/#error-no-such-file-or-directory-uvlock","text":"Cause : Lock file doesn't exist in repository. Solution : # Generate lock file uv lock # Commit it git add uv.lock git commit -m \"Add uv.lock file\" git push","title":"Error: \"No such file or directory: uv.lock\""},{"location":"pytho-setup/uv/#wrong-python-version","text":"Issue : Action installs Python 3.12 but need 3.10. Solution : Specify version explicitly: - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: python-version: '3.10'","title":"Wrong Python Version"},{"location":"pytho-setup/uv/#dependency-not-found-after-installation","text":"Issue : ModuleNotFoundError even after installation. Possible causes : 1. Group not specified : Dependency is in optional group not requested ```yaml # Wrong: dev group has pytest but not installed install-groups: 'test' # Fix: Add dev group install-groups: 'dev test' ``` Wrong import name : Package name \u2260 import name toml # Package: \"pyyaml\", Import: \"yaml\" dependencies = [\"pyyaml\"] python import yaml # Not: import pyyaml","title":"Dependency Not Found After Installation"},{"location":"pytho-setup/uv/#groups-not-isolated","text":"Issue : Unwanted packages installed even though group not specified. Cause : Before the fix, the action used --group which included default groups. Solution : Use latest version of the action which uses --no-default-groups : - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # Latest","title":"Groups Not Isolated"},{"location":"pytho-setup/uv/#virtual-environment-not-activated","text":"Issue : python: command not found or wrong Python version. Verification : - run: | echo \"Python: $(which python)\" echo \"PATH: $PATH\" echo \"VIRTUAL_ENV: $VIRTUAL_ENV\" Expected output : Python: /home/runner/work/repo/repo/.venv/bin/python PATH: /home/runner/work/repo/repo/.venv/bin:... VIRTUAL_ENV: /home/runner/work/repo/repo/.venv If not working : Check GitHub Actions runner logs for warnings in \"Activate virtual environment\" step.","title":"Virtual Environment Not Activated"},{"location":"pytho-setup/uv/#cache-not-working","text":"Symptoms : Dependencies reinstall on every run. Debug : 1. Check uv.lock exists and is committed 2. Verify cache hit in action logs: Restored cache from key: setup-uv-... 3. Check lock file hasn't changed between runs Force cache refresh : Change uv.lock content (update dependencies).","title":"Cache Not Working"},{"location":"pytho-setup/uv/#best-practices","text":"","title":"Best Practices"},{"location":"pytho-setup/uv/#1-always-commit-lock-file","text":"# Generate lock file uv lock # Always commit both files together git add pyproject.toml uv.lock git commit -m \"Update dependencies\" Why : Ensures reproducible builds across all environments.","title":"1. Always Commit Lock File"},{"location":"pytho-setup/uv/#2-use-specific-python-versions","text":"# Good: Explicit version python-version: '3.11' # Avoid: Version ranges or latest python-version: '3.x' # Too broad","title":"2. Use Specific Python Versions"},{"location":"pytho-setup/uv/#3-organize-dependency-groups-by-purpose","text":"# Good: Clear separation [dependency-groups] dev = [\"black\", \"mypy\", \"ruff\"] test = [\"pytest\", \"pytest-cov\"] docs = [\"mkdocs\"] # Avoid: Single \"dev\" group for everything [dependency-groups] dev = [\"black\", \"mypy\", \"pytest\", \"mkdocs\"] # Too broad","title":"3. Organize Dependency Groups by Purpose"},{"location":"pytho-setup/uv/#4-use-lock-verification-in-ci","text":"# Good: Catch dependency drift early - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 with: verify-lock: 'true' # Default, but explicit is clear","title":"4. Use Lock Verification in CI"},{"location":"pytho-setup/uv/#5-pin-action-versions","text":"# Good: Pin to major version (gets updates) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@v1 # Good: Pin to exact commit (maximum stability) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@abc1234 # Avoid: Using @main (unpredictable) - uses: Serapieum-of-alex/github-actions/actions/python-setup/uv@main","title":"5. Pin Action Versions"},{"location":"pytho-setup/uv/#6-separate-workflows-by-purpose","text":"# lint.yml - uses: .../actions/python-setup/uv@v1 with: install-groups: 'dev' - run: black --check . - run: mypy src/ # test.yml - uses: .../actions/python-setup/uv@v1 with: install-groups: 'test' - run: pytest # docs.yml - uses: .../actions/python-setup/uv@v1 with: install-groups: 'docs' - run: mkdocs build","title":"6. Separate Workflows by Purpose"},{"location":"pytho-setup/uv/#7-use-matrix-for-multi-version-testing","text":"strategy: matrix: python-version: ['3.10', '3.11', '3.12'] os: [ubuntu-latest, windows-latest, macos-latest] steps: - uses: .../actions/python-setup/uv@v1 with: python-version: ${{ matrix.python-version }}","title":"7. Use Matrix for Multi-Version Testing"},{"location":"pytho-setup/uv/#comparison-with-other-actions","text":"Feature This Action actions/setup-python astral-sh/setup-uv alone Python Installation \u2713 \u2713 \u2717 (requires setup-python) uv Installation \u2713 \u2717 \u2713 Dependency Installation \u2713 (automatic) \u2717 (manual) \u2717 (manual) Group Support \u2713 (built-in) \u2717 \u2713 (manual) Lock Verification \u2713 (built-in) \u2717 \u2717 (manual) Auto VEnv Activation \u2713 \u2717 \u2717 Dependency Caching \u2713 \u2713 (pip only) \u2713 Group Isolation \u2713 ( --no-default-groups ) N/A \u2717 (manual) When to use this action: - Modern Python projects using pyproject.toml - Need dependency group support - Want automatic environment activation - Prefer uv's speed over pip When to use alternatives: - actions/setup-python alone: Minimal setup, no uv needed - astral-sh/setup-uv alone: Need full control over uv commands","title":"Comparison with Other Actions"},{"location":"pytho-setup/uv/#additional-resources","text":"uv documentation PEP 735: Dependency Groups actions/setup-python astral-sh/setup-uv","title":"Additional Resources"},{"location":"pytho-setup/uv/#support","text":"For issues, questions, or contributions: - Repository: https://github.com/Serapieum-of-alex/github-actions - Issues: https://github.com/Serapieum-of-alex/github-actions/issues","title":"Support"}]}